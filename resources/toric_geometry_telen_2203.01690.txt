Introduction to Toric Geometry
arXiv:2203.01690v1 [math.AG] 3 Mar 2022

Simon Telen
Abstract
These notes are based on a series of lectures given by the author at the Max Planck
Institute for Mathematics in the Sciences in Leipzig. Addressed topics include affine
and projective toric varieties, abstract normal toric varieties from fans, divisors on toric
varieties and Cox’s construction of a toric variety as a GIT quotient. We emphasize
the role of toric varieties in solving systems of polynomial equations and provide many
computational examples using the Julia package Oscar.jl.

Contents
1 Introduction

2

2 Affine toric varieties
2.1 Tori and their lattices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 Definition of an affine toric variety . . . . . . . . . . . . . . . . . . . . . . .
2.3 Affine toric varieties from monomial maps . . . . . . . . . . . . . . . . . . .
2.4 Affine toric varieties from toric ideals . . . . . . . . . . . . . . . . . . . . . .
2.5 Affine toric varieties from affine semigroups . . . . . . . . . . . . . . . . . . .
2.6 Rational convex polyhedral cones . . . . . . . . . . . . . . . . . . . . . . . .
2.7 Affine toric varieties from cones . . . . . . . . . . . . . . . . . . . . . . . . .
2.8 Points on affine toric varieties . . . . . . . . . . . . . . . . . . . . . . . . . .
2.9 Normality and smoothness . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.10 Toric morphisms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6
6
7
8
9
11
12
14
16
18
20

3 Projective toric varieties
3.1 Definition of a projective toric variety . . . . . . . . . . . . . . . . . . . . . .
3.2 Projective toric varieties from monomial maps . . . . . . . . . . . . . . . . .
3.3 Convex lattice polytopes . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.4 Kushnirenko’s theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.5 Affine pieces of a projective toric variety . . . . . . . . . . . . . . . . . . . .
3.6 Very ample and normal polytopes . . . . . . . . . . . . . . . . . . . . . . . .
3.7 Normal fans . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.8 Projective toric varieties from polytopes . . . . . . . . . . . . . . . . . . . .

22
23
23
25
26
31
32
33
36

1

4 Abstract toric varieties
4.1 Gluing affine varieties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.2 Toric varieties from fans . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.3 Limits of one-parameter subgroups . . . . . . . . . . . . . . . . . . . . . . .
4.4 Orbit-cone correspondence . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.5 Orbit closures as toric varieties . . . . . . . . . . . . . . . . . . . . . . . . .
4.6 Toric morphisms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.6.1 Sublattices of finite index . . . . . . . . . . . . . . . . . . . . . . . .
4.6.2 Torus factors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.6.3 Refinements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

38
38
40
44
46
49
50
52
53
53

5 Divisors on toric varieties
5.1 Background on divisors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.2 Weil divisors on toric varieties . . . . . . . . . . . . . . . . . . . . . . . . . .
5.3 Cartier divisors on toric varieties . . . . . . . . . . . . . . . . . . . . . . . .
5.4 Sheaves of divisors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

54
54
57
59
63

6 Homogeneous coordinates on toric varieties
6.1 Toric varieties as GIT quotients . . . . . . . . . . . . . . . . . . . . . . . . .
6.2 The Cox ring of a toric variety . . . . . . . . . . . . . . . . . . . . . . . . . .
6.3 Homogenization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.4 Complete intersections on toric varieties . . . . . . . . . . . . . . . . . . . .

65
66
70
72
75

1

Introduction

Toric varieties form a well-understood subclass of algebraic varieties whose geometric properties are encoded by combinatorial objects. These objects include lattices, polyhedra, polyhedral cones and fans. Loosely speaking, toric varieties are those varieties that can be
parametrized by monomials. Though this might seem like a narrow class of varieties, many
familiar varieties are toric. Examples are (C∗ )n = (C \ {0})n , Cn , Pn and Pk × Pn−k . Other
toric varieties we will encounter are Hirzebruch surfaces and the cuspidal cubic {y 2 −x3 = 0},
which is parametrized by t 7→ (t2 , t3 ). Toric varieties often serve as test cases for conjectures,
or illustrative examples for theorems. Many general concepts from algebraic geometry have
a nice, concrete description in the toric setting. Examples are the gluing construction of
abstract varieties (Section 4.1) and groups of divisors (Section 5.1). Toric geometry provides nice connections between algebraic geometry, polyhedral geometry (Sections 2.6, 3.3),
tropical geometry (Example 5.36) and geometric invariant theory (Section 6.1).
Application areas of toric varieties include geometric modelling [9, Ch. 3], statistics,
chemistry and phylogenetics [23, Sec. 8.3], interior point methods for linear programming
[28] and mirror symmetry [2]. They also naturally pop up when solving systems of polynomial
equations. Toric varieties are the natural solution spaces for families of polynomial systems
with a fixed monomial support. This means that we fix the monomials that can occur in
the equations, while the coefficients can vary. An example is worked out below (Example

2

1.1). Exploiting this toric structure is crucial for the efficiency, but also for the accuracy
of numerical solution methods. Examples of such toric solution methods include polyhedral
homotopies [13, 18], toric resultants [6, 15] and toric normal form methods [3, 29].
These notes are based on a series of lectures given by the author at the Max Planck
Institute for Mathematics in the Sciences in Leipzig. They provide a first introduction to
the subject, with an emphasis on solving equations and effective computations with toric
varieties. In particular, we will highlight some of the functionalities of the Julia package
Oscar.jl [24]. We assume that the reader is familiar with basic concepts from algebraic
geometry, at the level of [11]. We mostly follow the presentation in the first four chapters of
the standard textbook [12]. Another classical reference is [16]. Our intention is not to be as
complete and self-contained as these books. Proofs are given when considered particularly
insightful for the rest of the material and we provide full references where proofs are skipped
or sketched. Apart from [12, 16], the reader can consult the lecture notes [26] by Frank
Sottile, and the paper [8] by David Cox for further reading. The discussion on Cox rings
and the toric interpretation of polynomial systems in Section 6 is mostly taken from [30].
We start out with affine toric varieties in Section 2. These are the building blocks
of the projective and abstract toric varieties discussed in Sections 3 and 4. Sections 24 feature the standard constructions of affine toric varieties from cones, projective toric
varieties from polytopes and abstract toric varieties from fans. A particularly interesting
result for polynomial system solving is Kushnirenko’s theorem (Theorem 3.16), which we
prove in Section 3.4. Section 5 discusses the theory of divisors on normal toric varieties,
which is the starting point for defining homogeneous coordinates in Section 6.
The text contains many examples, some of which are marked with an asterisk, e.g.,
Example* 2.24. The asterisk indicates that the computations were performed using software. All Julia code related to these ‘examples*’ can be found at the MathRepo page
https://mathrepo.mis.mpg.de/ToricGeometry. The reader is encouraged to try out these
computations on their own machine. For all computations and reported timings, we used
Oscar.jl (v0.8.1) in Julia (v1.7.1) on a macOS (v12.0.1) machine with a Quad-Core Intel
Core i7 processor working at 2,8 GHz. Some exercises are included in the text as well, and
many more can be found in [12]. The author is glad to receive any suggestions for further
computational examples or exercises for future editions of this course. We conclude the
introduction with an example of how toric varieties arise in the context of equation solving.
Example 1.1. Suppose we are interested in solving f1 = f2 = 0, where
f1 = a0 + a1 x + a2 y + a3 xy + a4 x2 + a5 y 2
f2 = b0 + b1 x + b2 y + b3 xy + b4 x2 + b5 y 2 .

(1.1)
(1.2)

If we view f1 , f2 as elements of the polynomial ring C[x, y], the solutions live naturally in
C2 . By Bézout’s Theorem, for a generic choice of the complex parameters ai , bi , there are
4 such solutions. In our toric context, we will view f1 and f2 as Laurent polynomials, i.e.,
as elements of the larger ring C[x±1 , y ±1 ]. Solutions are then points in the algebraic torus
(C∗ )2 ⊂ C2 , where C∗ = C \ {0}. Generically, all 4 affine solutions lie in (C∗ )2 .
Next, we re-interpret (1.1) as a system of linear equations on a projective variety. To
3

that end, we define the following map:
Φ4 : (C∗ )2 → P5

given by (x, y) 7→ (1 : x : y : xy : x2 : y 2 ).

(1.3)

We denote by X4 the Zariski closure of its image: X4 = im Φ4 ⊂ P5 . As we will see, X4 is
a projective toric variety. It is equal to the 2-uple Veronese embedding ν2 (P2 ) of P2 . Using
homogeneous coordinates (u0 : . . . : u5 ) on P5 , let us consider the linear space defined by
)
(
a0 u0 + a1 u1 + a2 u2 + a3 u3 + a4 u4 + a5 u5 = 0
⊂ P5 .
(1.4)
L4 =
b0 u0 + b1 u1 + b2 u2 + b3 u3 + b4 u4 + b5 u5 = 0
We observe that solutions (x, y) ∈ (C∗ )2 of (1.1) are one-to-one with points u such that
(u0 : · · · : u5 ) ∈ im Φ4 ∩ L4 ⊂ X4 ∩ L4 .

(1.5)

The right-hand-side of the inclusion counts the number of solutions of the homogenized
version of (1.1) in projective space. Its cardinality, for generic parameters, is |X4 ∩ L4 | =
deg X4 = deg ν2 (P2 ) = 4. As discussed above, the inclusion (1.5) is generically an equality.
Intuitively, by this procedure we moved from non-linear equations (1.1) on the flat space
(C∗ )2 to linear equations (1.4) on the curvy space X4 ⊂ P5 . We now force the coefficients
a4 , a5 , b4 , b5 to be zero. That is, we consider the polynomial system f1 = f2 = 0, where
f1 = a0 + a1 x + a2 y + a3 xy
f2 = b0 + b1 x + b2 y + b3 xy.

(1.6)
(1.7)

Again, the system is defined by quadratic equations. Bézout’s theorem predicts 4 solutions.
However, one easily checks that there are at most two solutions in (C∗ )2 (we leave this as an
exercise). To explain this discrepancy, we homogenize f1 and f2 to obtain the quadrics
F1 = a0 Z 2 + a1 XZ + a2 Y Z + a3 XY
F2 = b0 Z 2 + b1 XZ + b2 Y Z + b3 XY

(1.8)
(1.9)

with homogeneous coordinates (X : Y : Z) on P2 . This reveals the two ’missing’ solutions:
the points (0 : 1 : 0) and (1 : 0 : 0) are solutions to F1 = F2 = 0 for any choice of the
parameters ai and bi . Forcing some coefficients to be zero causes some solutions to lie on
the boundary of (C∗ )2 in P2 . The linear space L̃4 given by (1.4) with a4 = a5 = b4 = b5 = 0
is non-generic. In particular, there is a strict inclusion im Φ4 ∩ L̃4 ( X4 ∩ L̃4 . Indeed,
interpreting (1.6) as a system of equations on X4 , we introduce two spurious intersection
points in (X4 \ im Φ4 ) ∩ L̃4 , independently of the choice of a0 , . . . , a3 , b0 , . . . , b3 . To remedy
this, we define a new map
Φ : (C∗ )2 → P3

given by (x, y) 7→ (1 : x : y : xy)

(1.10)

and let X be the Zariski closure of its image. One checks that X = σ(P1 × P1 ) is the Segre
embedding of P1 × P1 in P3 . Our new linear space is the line
(
)
a0 u0 + a1 u1 + a2 u2 + a3 u3 = 0
L =
⊂ P3 .
(1.11)
b0 u0 + b1 u1 + b2 u2 + b3 u3 = 0
4

For general coefficients, |X ∩ L | = deg X = 2 and the inclusion im Φ ∩ L ⊂ X ∩ L
is an equality. The conclusion is that a natural compact space containing the solutions of
(1.6) is X ≃ P1 × P1 , rather than X4 ≃ P2 .
We point out that this example features several familiar toric varieties:
(C∗ )2 , C2 , P2 ≃ X4 , P5 , P1 × P1 ≃ X , P3 .
All of these are normal toric varieties (in particular, they are smooth). We will see that
such varieties have a very nice combinatorial description in terms of fans, and sometimes in
terms of polytopes. As a teaser, we justify the notation X4 , X . The Newton polytopes (see
Section 6.3) 4 and  of the equations in (1.1) and (1.6) are shown in Figure 1. Note that

Figure 1: The Newton polytopes associated to the polynomial system (1.1) on
the left and to (1.6) on the right.
from these polytopes P we can deduce the following geometric information on XP :
1. the dimension of P equals that of XP ,
2. the degree of XP is the normalized volume of P .
The second statement is an instance of Kushnirenko’s Theorem, see Section 3.4. The normalized volume of P ⊂ Rn equals its Euclidean volume divided by n!. It counts the number
of standard simplices that can fit in P , see Figure 1.

Acknowledgements. I would like to thank all course attendants for their active participation. Some exercises suggested by the author were worked out by students and included
as examples in the text. Special thanks to Chiara Meroni for helping with Examples* 2.24,
3.25, 3.29, 3.46, 3.50, 3.53, 5.20, 5.23, 5.27 and for setting up an accompanying MathRepo
page at https://mathrepo.mis.mpg.de/ToricGeometry. Examples* 2.40, 2.47 were contributed by Claudia Fevola, and Mara Belotti and Chiara Meroni worked on Example* 4.18.
Thanks to Michael Joswig for several useful suggestions, including Example* 3.53. The lectures were supported by Jupyter notebooks written in Julia. I want to thank Lars Kastner
and Martin Bies for implementing desired features and for several swift bug fixes. Their
help was indispensable in underpinning this course with computational examples. Thanks
to Claudia Fevola, Chiara Meroni and Pedro Tamaroff for their help with proofreading.

5

2

Affine toric varieties

Affine toric varieties are the building blocks of more general toric varieties. An affine variety
in Cs is the common zero set of finitely many polynomials in C[x1 , . . . , xs ]. For affine toric
varieties, we will see that all these polynomials can be taken of the simple form xa − xb ,
where xa = xa11 · · · xas s , a = (a1 , . . . , as ) ∈ Ns and similarly for xb . We will also see that
toric varieties come in the form of a simple parametrization given by monomials, and a more
intrinsic description involves semigroup algebras. The nicest affine toric varieties, i.e., those
that are normal, correspond to semigroups associated to rational polyhedral cones.
An affine variety V ⊂ Cs , has coordinate ring C[V ]. Its vanishing ideal in C[x1 , . . . , xs ]
is denoted I(V ), i.e. C[V ] ≃ C[x1 , . . . , xs ]/I(V ). To associate an affine variety to a nilpotent
free finitely generated C-algebra R, we use the notation R 7→ Specm(R). This stands for
maximal spectrum: Specm(R) is the set of all maximal ideals of R, endowed with the Zariski
topology. We have V ≃ Specm(C[V ]) = Specm(C[x1 , . . . , xs ]/I(V )) and C[Specm(R)] = R.

2.1

Tori and their lattices

Recall that (C∗ )n is a group under component-wise multiplication: for t, t0 ∈ (C∗ )n ,
t · t0 = (t1 , . . . , tn ) · (t01 , . . . , t0n ) = (t1 t01 , . . . , tn t0n ) ∈ (C∗ )n .
Definition 2.1 (Torus). A torus T is an affine variety which is isomorphic to (C∗ )n , where
T inherits a group structure from this isomorphism.
By definition, the coordinate ring C[T ] of an n-dimensional torus T is isomorphic to the
±1
Laurent polynomial ring C[t±1
1 , . . . , tn ]. These are the morphisms T → C. Among them,
characters are the non-vanishing morphisms on T which respect the group structure.
Definition 2.2 (Character). A character of a torus T is a morphism T → C∗ which is a
group homomorphism.
Proposition 2.3. The characters of (C∗ )n are the morphisms (C∗ )n → C∗ given by
(t1 , . . . , tn ) 7→ ta11 · · · tann

for (a1 , . . . an ) ∈ Zn .

Proof. The only morphisms from (C∗ )n → C∗ are those given by t → λta , for a ∈ Zn and
λ ∈ C∗ (see [22, Prop. 2.3]). Among those, the group homomorphisms have λ = 1.
Corollary 2.4. The characters of a torus T ≃ (C∗ )n form a lattice M ≃ Zn , called the
character lattice of T .
By a lattice we mean a free abelian group of finite rank. Conventionally, for a point
m ∈ M in the character lattice, we write χm : T → C∗ for the corresponding character. Note
that when T = (C∗ )n , Proposition 2.3 says that characters are Laurent monomials.
The dual lattice N = HomZ (M, Z) ≃ Zn of the character lattice M is called the cocharacter lattice or the lattice of one-parameter subgroups of T . More explicitly, N consists of
the morphisms C∗ → T that are group homomorphisms.
6

Proposition 2.5. The one-parameter subgroups of (C∗ )n are given by the morphisms
t 7→ (tu1 , . . . , tun )

for u = (u1 , . . . , un ) ∈ Zn .

We write λu : C∗ → T for the one-parameter subgroup corresponding to u ∈ Zn . When
T = (C∗ )n , a one-parameter subgroup is a monomial curve.
An isomorphism φ : T ≃ (C∗ )n determines a basis e1 , . . . , en of M and a dual basis
e0 1 , . . . , e0n of N . Explicitly, ei corresponds to the character χei (t) = φ(t)i , and e0i represents
0
the cocharacter λei (t) = φ−1 (1, . . . , t, . . . , 1), where t is in the i-th position. The bases {ei }
and {e0i } fix isomorphisms φM : M → Zn and φN : N → Zn . The natural pairing:
h·, ·i : M × N → HomZ (Z, Z) ≃ Z,

(m, n) 7→ χm ◦ λn

is given in coordinates by hm, ui = φM (m) · φN (u), where · is the usual dot product in Zn .
Example 2.6. We work out an explicit example. Let n = 2 and take m = 2e1 + 3e2 ∈
M, u = e01 − 4e02 ∈ N . We have φM (m) = (2, 3), φN (u) = (1, −4). From
0

0

0

0

(χm ◦ λu )(t) = χm (λe1 −4e2 (t)) = χm (λe1 (t)λe2 (t)−4 ) = χm (φ−1 (t, t−4 ))
= χ2e1 +3e2 (φ−1 (t, t−4 )) = χe1 (φ−1 (t, t−4 ))2 χe2 (φ−1 (t, t−4 ))3 = t2 t−12 = t−10 ,
we see that χm ◦ λu : Z → Z sends t 7→ t−10 . Hence hm, ui = −10 = (2, 3) · (1, −4).



Given a lattice N ≃ Zn , the torus TN = N ⊗Z C∗ ≃ (C∗ )n has cocharacter lattice N .
One-parameter subgroups are given explicitly by λu (t) = u ⊗ t. The torus TN is canonically
associated to N , which we emphasize with the subscript
N . A basis e01 , . . . , e0n of N fixes an
Pn
∗ n
isomorphism TN → (C ) which sends u ⊗ t = ( i=1 ui e0i ) ⊗ t to (tu1 , . . . , tun ).
Remark 2.7. One can often assume that dual bases for the lattices M , N are fixed. In such
cases, and in most statements below, one can set M = N = Zn and T = TN = (C∗ )n .
Characters are Laurent monomials and co-characters are monomial curves. The general
set-up presented here will be useful in contexts where several tori and lattices are involved.

2.2

Definition of an affine toric variety

Definition 2.8 (Affine toric variety). An affine toric variety is an irreducible affine variety
V containing a torus T ≃ (C∗ )n as a Zariski dense open subset such that the action of T on
itself extends to an algebraic action of T on V .
In this definition, an algebraic action is a morphism of varieties T × V → V .
Example 2.9. Here are some examples of affine toric varieties:
• A torus T is an affine toric variety. In particular, the action of T on itself is given by
a morphism T × T → T , as (C∗ )n × (C∗ )n → (C∗ )n is given by Laurent monomials.
• Affine n-space Cn is an affine toric variety. It has a dense torus T = (C∗ )n ,→ Cn whose
group operation T × T → T extends trivially to an algebraic action T × Cn → Cn .
7

• The curve C = {x3 − y 2 = 0} ⊆ C2 contains the torus T ≃ C∗ via t 7→ (t2 , t3 ). The
action of T on C is given by (t, (x, y)) 7→ (t2 x, t3 y);
• The threefold V = {xy − zw = 0} ⊂ C4 contains a torus T = (V ∩ (C∗ )4 ) ≃ (C∗ )3 via
(t1 , t2 , t3 ) 7→ (t1 , t2 , t3 , t1 t2 t−1
3 ). The action of T on itself extends to an algebraic action
of T on V as ((t1 , t2 , t3 ), (x, y, z, w)) 7→ (t1 x, t2 y, t3 z, t1 t2 t−1

3 w).
Definition 2.8 seems somewhat technical. Below, we will discuss three different, very
explicit ways of constructing affine toric varieties. The first construction uses monomial
maps, the second uses toric ideals, and the third involves affine semigroups.

2.3

Affine toric varieties from monomial maps

Let T ≃ (C∗ )n be a torus with character lattice M and fix a subset A = {m1 , . . . , ms } ⊂ M .
We consider the map
ΦA : T → Cs

given by t 7→ (χm1 (t), . . . , χms (t)).

We denote the Zariski closure of its image by YA = im ΦA ⊂ Cs .
Proposition
2.10. YA is an affine toric variety whose dense torus has character lattice
P
ZA = { si=1 ai mi | ai ∈ Z}.
For proving this proposition, we will need a few lemmas. We will sometimes think of ΦA
as a map of tori T → (C∗ )s .
Lemma 2.11. A morphism of tori φ : T1 → T2 that is also a group homomorphism induces
b
a map φb : M2 → M1 , where Mi is the character lattice of Ti . This map is such that χφ(m2 )
is the character χm2 ◦ φ. Moreover, if φ is injective, φb is surjective and vice versa.
s
b
Exercise 2.12. Prove
Ps Lemma 2.11 and check that the map ΦA : Z → M is given by
a = (a1 , . . . , as ) 7→ i=1 ai mi .

In the proof of Proposition 2.10, we will also use the following result from the theory of
linear algebraic groups [19, Sec. 16].
Lemma 2.13. Let φ : T1 → T2 be a morphism of tori that is a group homomorphism. The
image φ(T1 ) ⊂ T2 is a closed subtorus.
proof of Proposition 2.10. Let us denote T 0 = im ΦA . The lemma above implies that T 0 is a
closed subtorus of (C∗ )s . Hence we have T 0 = T 0 ∩ (C∗ )s = YA ∩ (C∗ )s where the closure is
taken in Cs . This shows that YA = T 0 is irreducible and contains a Zariski dense torus. We
need to prove that the action of T 0 on itself extends to YA . An element t ∈ T 0 ⊂ (C∗ )s acts
on Cs by coordinate-wise scaling. In particular, if V ⊂ Cs is a closed subvariety, then so is
t · V for t ∈ T 0 . Since T 0 = t · T 0 ⊂ t · YA and YA = T 0 , we find YA ⊂ t · YA by taking the
closure on both sides. Replacing t with its inverse t−1 , we see that YA ⊂ t−1 · YA and hence
t · YA ⊂ YA ⊂ t · YA . This shows that the action extends, and it is given by a morphism
obtained from restricting (C∗ )s × Cs → Cs to T 0 × YA → YA . In order to understand the
character lattice of YA , we let M 0 be the character lattice of T 0 and consider the diagrams
8

T

(C∗ )s

M

Zs
M0

T0

where the right diagram is induced by the left diagram via Lemma 2.11. Since the image of
Zs → M is ZA (Exercise 2.12), we see that M 0 ≃ ZA .
Corollary 2.14. The dimension of YA is the rank of the sublattice ZA ⊂ M .
If T = (C∗ )n , then mi ∈ Zn are integer vectors. Collecting these in the columns of a
matrix A ⊂ Zn×s , Corollary 2.14 implies that dim YA = rank A. Moreover, the character
lattice of the dense torus of YA is the image of A in Zn .
Example 2.15. Let n = 1, T = C∗ and A = {2, 4} ⊂ M = Z. The map ΦA is given by
ΦA (t) = (t2 , t4 ). The affine toric variety YA is the parabola {y − x2 = 0} ⊂ C2 . Its dense
torus is T 0 = YA \ {0}. The matrix A is [2 4] : Z2 → Z, which has rank 1. Its image is
2Z ⊂ Z, which is the character lattice of T 0 . The same affine toric variety is obtained from
A = {1, 2}, for which A : Z2 → Z is surjective and ΦA : T → T 0 is an isomorphism.

Exercise 2.16. Let n = 2, T = (C∗ )2 and A = {(1, 0), (0, 1), (1, 1)}. What is the dimension
of YA ? What are its defining equations? Describe YA \ T 0 and the character lattice M 0 of
T 0 . Answer the same questions for A = {(1, 1), (2, 2), (3, 3)}.
Exercise 2.17. Find an example where s ≥ 2 and the image of ΦA is closed in Cs .

2.4

Affine toric varieties from toric ideals

In this section our goal is to describe the vanishing ideal I(YA ) ⊂ C[x1 , . . . , xs ] of the affine
toric variety YA . A polynomial f P
∈ I(YA ) vanishes
of the monomial map
Ps on the image
s
a
x − xb hasQthis property.
ΦA . A key observation is that, if i=1 ai mi = i=1 bi mi , then
Q
s
Indeed,
plugging P
in x = (χm1 (t), . . . , χms (t)) ∈ im ΦA , we get i=1 χmi (t)ai − si=1 χmi (t)bi =
Ps
s
χ i=1 ai mi (t) − χ i=1 bi mi (t) = 0. By Exercise 2.12, this shows that for every a, b ∈ Ns such
b A , we find a binomial xa − xb ∈ I(YA ).
that a − b ∈ ker Φ
P
b A ⊂ Zs , we can write ` = `+ −`− where `+ = P
If ` ∈ ker Φ
`i >0 `i ei and `− = −
`i <0 `i ei ,
s
`+
`−
with ei the standard basis vectors of Z . By construction, we have that x − x ∈ I(YA ).
b A = A = [1 2 3] : Z3 → Z1 . The vectors
Example 2.18. Let n = 1, A = {1, 2, 3}, Φ
(1, −2, 1),

(1, 1, −1),

(2, −1, 0)

b A . This gives binomials x1 z 1 − y 2 , x1 y 1 − z 1 , x2 − y 1 ∈ I(YA ). Note that YA is
are in ker Φ
the twisted cubic curve.

It turns out that I(YA ) is generated by binomials that are found in this way.

9

Figure 2: Computing toric ideals in Oscar.jl.
Theorem 2.19. The vanishing ideal I(YA ) of the affine toric variety YA ⊂ Cs is given by
bA i
I(YA ) = hx`+ − x`− | ` ∈ ker Φ
b A i ⊂ C[x1 , . . . , xs ].
= hxa − xb | a − b ∈ ker Φ
We omit the proof of Theorem 2.19 and refer to [12, p. 15].
Exercise 2.20. Let n = 1, T = C∗ , A = {2, 3}. Show that YA is the cuspidal cubic, i.e.
I(YA ) = hx3 − y 2 i.
Exercise 2.21. Let n = 2, T = (C∗ )2 , A = {(1, 0), (0, 1), (1, 1)}. Show that YA is given by
I(YA ) = hxy − zi.
Exercise 2.22. Show that YA always contains (1, . . . , 1) ∈ Cs .
Definition 2.23 (Toric ideal). A toric ideal in C[x1 , . . . , xs ] is a prime ideal that is generated
by binomials.
As a corollary of Theorem 2.19, any affine toric variety coming from a monomial map ΦA
is defined by a toric ideal. Computing toric ideals is an important task from combinatorial
commutative algebra. See [27, Chapter 12] for algorithms. These algorithms are implemented
in software systems such as Macaulay2, Singular and Oscar.jl.
Example* 2.24. We illustrate how to compute I(YA ) in Oscar.jl. Consider the matrix


2 2 1 0 0 1 1
A = 1 0 0 1 2 2 1
(2.1)
0 1 2 2 1 0 1
from [23, Example 8.9]. The associated toric variety YA has dimension 3 and is embedded
in C7 . To compute the toric ideal I(YA ), we use the function toric ideal. An example
of in- and output in a Jupyter Notebook is shown in Figure 2. Note that, according to
Oscar conventions, toric ideal requires the transpose of A as an input. The result, as in
[23, Example 8.9], is an ideal generated by 9 binomials. We reiterate that the code of this
example, and all other examples marked by an asterisk, is available at https://mathrepo.
mis.mpg.de/ToricGeometry.


10

2.5

Affine toric varieties from affine semigroups

In the previous sections, we have described YA ⊂ Cs as the closure of the image of a monomial
map, and as the zero set of a toric ideal. In this section, we will describe its coordinate ring
in a more intrinsic way. In particular, we will see that a choice of embedding corresponds to
a choice of generators of an affine semigroup.
Definition 2.25 (Affine semigroup). An affine semigroup is a set S with a binary operation
+ such that
1. + is associative,
2. S has an identity element 0 ∈ S,
3. + is commutative,
4. S is finitely generated: there is a finite subset A ⊂ S such that
(
)
X
NA =
am m | am ∈ N = S,
m∈A

5. S can be embedded in a lattice M .
Note that only associativity is usually required for a semigroup. The adjective affine
adds all four other requirements to the list. By definition, all affine semigroups (up to
isomorphism) are of the form NA for some finite subset A of a lattice M .
Definition 2.26 (Semigroup algebra). Let M be the character lattice of a torus T . The
semigroup algebra associated to an affine semigroup S ⊂ M is the C-algebra
(
)
X
C[S] =
cm χm | cm ∈ C, finitely many cm nonzero ,
m∈S
0

0

with multiplication induced by the group operation in M : χm χm = χm+m .
Example 2.27. If A = {m1 , . . . , ms } ⊂ M , then C[NA ] = C[χm1 , . . . , χms ]. In particular,
±1
n
the Laurent polynomial ring C[t±1

1 , . . . , tn ] is the semigroup algebra C[Z ].
Here is how affine semigroups give rise to affine toric varieties.
Proposition 2.28. Let S ⊂ M be an affine semigroup. Then
1. C[S] is an integral domain and finitely generated as a C-algebra,
2. Specm(C[S]) is an affine toric variety whose dense torus has character lattice ZS.

11

Proof. For point 1, note that C[M ] is an integral domain. Indeed, it is isomorphic to the
Laurent polynomial ring (Example 2.27), which is the coordinate ring of an irreducible affine
variety. Since C[S] ⊂ C[M ], C[S] is an integral domain as well. It is finitely generated as a
C-algebra by definition (Example 2.27).
For point 2, let S = NA for a finite set A ⊂ M and let Φ∗A : C[x1 , . . . , xs ] → C[M ] be
the pullback map of ΦA , given by f 7→ f ◦ ΦA . There is a short exact sequence
Φ∗

A
0 → I(YA ) ,→ C[x1 , . . . , xs ] −→
C[S] → 0,

which shows C[S] ≃ C[x1 , . . . , xs ]/I(YA ). This proves that Specm(C[S]) is isomorphic to YA .
Since ZA = ZS, the torus of Specm(C[S]) has character lattice ZS by Proposition 2.10.
The following statement affirms that all affine toric varieties come from monomial maps,
toric ideals and affine semigroups.
Theorem 2.29. Let V be an affine variety. The following are equivalent:
1. V is an affine toric variety,
2. V ≃ YA for a finite subset A of a lattice M ,
3. V is defined by a toric ideal,
4. V = Specm(C[S]) for some affine semigroup S.
Proof. This is Theorem 1.1.17 in [12]. The equivalence of 2 - 4 can be seen as follows.
If V ≃ YA , then V ≃ Specm(C[x1 , . . . , xs ]/I(YA )), where I(YA ) is the toric ideal from
Theorem 2.19. This implies V ≃ Specm(C[NA ]) by the short exact sequence in the proof of
Proposition 2.28. The same sequence implies that V ≃ YA , which gives 2 ⇒ 3 ⇒ 4 ⇒ 2.

2.6

Rational convex polyhedral cones

We have seen that all affine toric varieties arise as Specm(C[S]) for some affine semigroup S.
We will see that the nicest affine toric varieties are those for which the semigroup algebra
C[S] is a normal domain. These are affine toric varieties coming from polyhedral cones.
Before introducing them, we present some notation and concepts related to such cones.
To a lattice N ≃ Zn we associate the real vector space NR = N ⊗Z R ≃ Rn . The dual
vector space MR comes from M = HomZ (N, Z): MR = HomR (NR , R) = M ⊗Z R ≃ Rn .
Definition 2.30 (Rational convex polyhedral cone). A rational convex polyhedral cone in
NR is a set of the form
(
)
X
σ = Cone(S) =
λu u | λu ∈ R≥0 ,
u∈S

for some finite set S ⊂ N . The set S is called a set of generators of σ.
12

σ

σ∨

m
τ

(0, 0)

(0, 0)
Figure 3: A rational cone σ and its dual.

More generally, a convex cone is a set of the form Cone(S) for S ⊂ NR . Requiring S
to be finite makes the cone polyhedral, and requiring S ⊂ N makes it rational. The cones
related to toric varieties are rational, convex and polyhedral. In what follows, we will omit
the adjectives ‘polyhedral’ and ‘convex’ and simply write ‘cone’ in the statements that hold
for any convex polyhedral cone. When we write ‘rational cone’, we mean ‘rational convex
polyhedral cone’. Given a cone σ ⊂ NR , its dual cone σ ∨ is
σ ∨ = {m ∈ MR | hu, mi ≥ 0 for all u ∈ σ}.
We have (σ ∨ )∨ = σ, and if σ is a rational cone then so is σ ∨ . For a point m ∈ MR , we set
+
Hm = {u ∈ NR | hu, mi = 0} and Hm
= {u ∈ NR | hu, mi ≥ 0}.

Definition 2.31 (Face). A face τ of a cone σ is a subset of the form τ = σ ∩ Hm for m ∈ σ ∨ .
Faces of (rational) cones are again (rational) cones. Note that σ is considered to be face
of itself, as 0 ∈ σ ∨ . If τ is a face of σ, we write τ  σ and τ ≺ σ if τ 6= σ.
Example 2.32. Let N = Z2 . The cone σ = Cone((0, 1), (1, 2), (2, 1)) and its dual are shown
in Figure 3. The point m = (−1, 2) ∈ σ ∨ gives the face τ = σ ∩ Hm = Cone((2, 1)).

A useful way of representing cones, dual to a representation in terms of generators, is by
a finite set of linear inequalities.
+
+
Proposition 2.33. The set {mi }si=1 ⊂ M generates σ ∨ if and only if σ = Hm
∩ · · · ∩ Hm
.
s
1

In the following, we summarize a list of properties of cones and their faces. For proofs,
we refer to [12, Sec. 1.2] and references therein.
Proposition 2.34. Let σ, τ, τ 0 be cones. Then we have
1. τ  σ and τ 0  σ implies τ ∩ τ 0  σ,
2. τ  σ and τ 0  τ implies τ 0  σ,
13

3. if τ  σ and v, w ∈ σ, then v + w ∈ τ implies v ∈ τ and w ∈ τ ,
4. faces of σ and faces of σ ∨ are in bijective, inclusion reversing correspondence.
Example 2.35. The bijection in item 4 of Proposition 2.34 works as follows. Let τ  σ ∨
be a face and let m ∈ τ be a generic point of τ . More precisely, we pick m such that m is
on none of the faces of τ except for τ itself. Then Hm ∩ σ is the corresponding face of σ. 
The dimension dim σ of a cone σ ⊂ NR is the dimension of the smallest linear subspace
of NR containing σ. Here are some further properties of cones we will need.
Definition 2.36 (Strong convexity). A cone σ ⊂ NR is called pointed or strongly convex if
σ ∩ (−σ) = {0}. This is equivalent to {0}  σ, and to dim σ ∨ = n.
The one-dimensional faces ρ  σ are called the rays of σ. If σ is strongly convex, for each
ray ρ there is a unique lattice point uρ such that ρ ∩ N = N·uρ . The set {uρ | ρ  σ, dim ρ =
1} generates σ. It is called the set of minimal generators of σ.
Definition 2.37 (Smoothness). A strongly convex rational cone σ ⊂ NR is smooth if its
minimal generators are a subset of a Z-basis of N .
Definition 2.38 (Simplicial). A strongly convex cone σ is simplicial if its minimal generators
are linearly independent over R.
Example 2.39. All two-dimensional cones are simplicial. The cone σ from Example 2.32 is
not smooth. Its minimal generators (0, 1) and (2, 1) span a sublattice of Z2 . The cone over
{(1, 0, 0), (0, 1, 0), (1, 0, 1), (0, 1, 1)} has 4 minimal generators. Hence it is not simplicial. 
Example* 2.40. Here is how to work with rational convex polyhedral cones in Oscar.jl.
We define the cone σ from Example 2.32 and its dual as follows:
σ = positive_hull([0 1;1 2;2 1]); σ_dual = polarize(σ);

1

The dimension of σ and its facet inequalities are obtained via
dimσ = dim(σ); facets_σ = facets(σ);

1

This shows that σ has dimension two and it is given by x1 ≥ 0 and x1 − 2x2 ≤ 0. Computations involving polyhedral geometry in Oscar.jl, and thus many computations related to
toric varieties, rely on the software Polymake [17].


2.7

Affine toric varieties from cones

Let σ be a rational cone (that is, a rational convex polyhedral cone) in NR . We associate an
affine toric variety to σ, by considering the semigroup
Sσ = σ ∨ ∩ M ⊂ M.
14

Lemma 2.41 (Gordan’s lemma). The semigroup Sσ is affine, in the sense of Definition 2.25.
We omit the proof of Gordan’s lemma and refer to [12, Prop. 1.2.17]. It entails that Sσ is
finitely generated, so that Sσ = NA for a finite subset A ⊂ M . Here is an obvious corollary.
Corollary 2.42. Let σ ⊂ NR be a rational cone with associated semigroup Sσ = σ ∨ ∩ M .
Then Uσ = Specm(C[Sσ ]) is an affine toric variety.
Proposition 2.43. Let Uσ = Specm(C[Sσ ]) be the affine toric variety corresponding to
σ ⊂ NR . We have that dim Uσ = n if and only if σ is pointed. In this case, the torus of Uσ
has character lattice M = HomZ (N, Z).
Proof. By Proposition 2.10, dim Uσ = rank ZSσ . By the proof of [12, Thm. 1.2.18], we have
rank ZSσ = n ⇐⇒ ZSσ = M ⇐⇒ σ is strongly convex.
Example 2.44. Let σ = Cone(e1 , . . . , er ) ⊂ Rn = (Zn )R , where r ≤ n and ei
is the i-th standard basis vector. Note that σ is pointed. One checks that σ ∨ =
conv(e01 , . . . , e0r , ±e0r+1 , . . . , ±e0n ), where e0i is the dual basis vector of (Rn )∨ . The associated
affine toric variety Uσ is
±1
r
∗ n−r
Specm(C[x1 , . . . , xr , x±1
.
r+1 , . . . , xn ]) ≃ C × (C )

By changing bases in the lattice Zn , we see that the affine toric variety corresponding to any
smooth cone σ is the product of an affine space with a torus.

Example 2.45. Let A = {(1, 0), (0, 1), (1, 1)} ⊂ M = Z2 . We’ve seen that I(YA ) = hxy−zi
(Exercise 2.21). The associated semigroup is S = NA = R2≥0 ∩ Z2 = Sσ , where σ = R2≥0
(check that this is self-dual: σ = σ ∨ ). Therefore YA ≃ Uσ = Specm(C[x, y]) = C2 .

We have seen that if an affine semigroup S ⊂ M is generated by a finite set A =
{m1 , . . . , ms } ⊂ S, then YA ⊂ Cs is an embedding of Specm(C[S]). To embed Uσ , we need to
find a set of generators of Sσ = σ ∨ ∩ M . Such a basis can be described in terms of irreducible
elements of Sσ . These are the elements m ∈ Sσ such that if m = m0 + m00 for m0 , m00 ∈ Sσ ,
then m0 = 0 or m00 = 0. The following is shown in [12, Prop. 1.2.23].
Proposition 2.46. Let H = {m ∈ Sσ | m is irreducible }. Then
1. H is finite and generates Sσ ,
2. H contains the minimal generators of σ ∨ ,
3. H is the minimal set of generators with respect to inclusion.
The set H from Proposition 2.46 is called the Hilbert basis of Sσ , or of σ ∨ . A consequence
of this proposition is that Uσ can be embedded via a monomial map in an affine space of
dimension |H |. We will see below that |H | is the smallest such dimension.

15

Example* 2.47. We will now use Oscar.jl to compute the embedding of Uσ , where σ is
the cone from Example 2.32. We generated this cone and its dual in Example 2.40. The first
step is to compute the Hilbert basis of σ ∨ :
H = hilbert_basis(σ_dual)

1

This gives H = {(1, 0), (−1, 2), (0, 1)}. From it, we can compute the toric ideal I(YH ) via
I = toric_ideal(H)

1

It is generated by x1 x2 − x23 , which is the equation for Uσ ≃ YH embedded in C3 .



2.8

Points on affine toric varieties

In this section, we characterize points on an affine toric variety V in terms of semigroup
homomorphisms. This will help to give an intrinsic, coordinate-free description of the torus
action T × V → V . By a semigroup homomorphism we mean a map between commutative
monoids which preserves the binary operation: γ : S1 → S2 is such that γ(m + cm0 ) =
γ(m) + cγ(m0 ). The image of the identity element in S1 is the identity element in S2 .
Proposition 2.48. Let V = Specm(C[S]) for an affine semigroup S ⊂ M . There are oneto-one correspondences between
1. points p ∈ V ,
2. maximal ideals mp ⊂ C[S],
3. semigroup homomorphisms S → C.
Proof. The correspondence between 1 and 2 is standard. To a point p ∈ V , we associate the
semigroup homomorphism m 7→ χm (p). Note that here C is considered as a multiplicative
monoid. We now associate a maximal ideal mp to a semigroup homomorphism γ : S → C.
Note that γ induces a surjective map of C-algebras γ 0 : C[S] → C. Indeed, the image of
1 ∈ C[S] is 1 ∈ C, as γ(0) = 1. The kernel of γ 0 is a maximal ideal, since 0 → ker γ 0 → C[S] →
C → 0 is exact and hence C[S]/(ker γ 0 ) ≃ C. We set mp = ker γ 0 . A more concrete way of
associating a point p ∈ V to γ is by working with an embedding of V . Let A = {m1 , . . . , ms }
s
be such that NA = S and let p = (γ(m1 ), . .P
. , γ(ms )) ∈ CP
. We show that p ∈ YA ≃ V . If
s
s
a, b ∈ N are such that a − b ∈ ker Φ̂A , then i=1 ai mi = si=1 bi mi . Hence
pa − pb =

s
Y
i=1

γ(mi )ai −

s
Y

s
s
X
X
γ(mi )bi = γ(
ai mi ) − γ(
bi mi ) = 0,

i=1

i=1

i=1

so that indeed p ∈ YA . Moreover, one checks that the semigroup homomorphism associated
to this point in the first step of the proof is γ, so the correspondence is indeed one-to-one.

16

This way of thinking about points on V = Specm(C[S]) gives the following nice description of the torus action T × V → V .
Proposition 2.49. Let V = Specm(C[S]) be an affine toric variety with dense torus T ⊂ V .
An element t ∈ T acts on V by (m 7→ γ(m)) 7→ (m 7→ χm (t)γ(m)).
Proof. The action T × V → V is algebraic, so it comes from a C-algebra homomorphism
C[V ] = C[S] → C[T × V ] = C[M ] ⊗C C[S]. Moreover, it is an extension of the action
T × T → T of T on itself, which comes from C[M ] → C[M ] ⊗C C[M ], χm 7→ χm ⊗ χm .
Commutativity of the following dual diagrams
T ×T

T

C[M ] ⊗C C[M ]

C[M ]

T ×V

V

C[M ] ⊗C C[S]

C[S]

implies that C[S] → C[M ] ⊗C C[S] is given by χm 7→ χm ⊗ χm , which implies the statement.
We leave the details as an exercise to the reader.
The following statement uses pointed semigroups, which are those affine semigroups S for
which S ∩ (−S) = {0} (it is the discrete version of strong convexity).
Proposition 2.50. Let V = Specm(C[S]) ≃ YA be an affine toric variety with dense torus
T , for S = NA ⊂ M an affine semigroup and A = {m1 , . . . , ms } ⊂ S a finite generating set.
We have that the torus action T × V → V has a fixed point if and only if S is pointed. In
this case, the fixed point is unique and it is given by
(
1 m=0
γ : m 7−→
.
0 otherwise
Proof. Note that the map γ in the proposition is a semigroup homomorphism if and only
if S is pointed. Moreover, if γ : S → C is a fixed point of the torus action, we must have
χm (t)γ(m) = γ(m) for all t ∈ T , which implies that γ(0) = 1 and γ(m) = 0 for m 6= 0.
Here are two immediate consequences.
Corollary 2.51. Let YA ⊂ Cs be an affine toric variety corresponding to A =
{m1 , . . . , ms } ⊂ M \ {0}. The torus action T × YA → YA has a fixed point if and only
if 0 ∈ YA , in which case 0 is the unique fixed point.
Exercise 2.52. Verify that your affine toric from Exercise 2.17 does not contain 0, and
explain.
Corollary 2.53. Let Uσ be the affine toric variety corresponding to a strongly convex
rational cone σ ⊂ NR ≃ Rn . The torus action on Uσ has a fixed point if and only if σ
has dimension n, in which case it is given by the maximal ideal hχm | m ∈ Sσ \ {0}i.

17

Proof. The cone σ ∨ has dimension n since σ is strongly convex. It is strongly convex itself
if and only if σ has dimension n. This is sufficient and necessary for Sσ = σ ∨ ∩ M to be
pointed, and hence for there to be a unique fixed point of the torus action (Proposition
2.50). The maximal ideal hχm | m ∈ Sσ \ {0}i is the kernel of the C-algebra homomorphism
γ 0 : C[Sσ ] → C induced by γ from Proposition 2.50. The statement follows from the proof
of Proposition 2.48.

2.9

Normality and smoothness

Recall that an integral domain R is normal if it is integrally closed in its field of fractions K.
This means that if x ∈ K satisfies a monic polynomial relation xd + rd−1 xd−1 + · · · + r1 x + r0
with coefficients ri ∈ R, then we must have x ∈ R. An irreducible affine variety V is called
normal if its coordinate ring C[V ] is normal. Normality of toric varieties will be important in
our discussion on divisors later. We will see in this section that normal affine toric varieties
are exactly those affine toric varieties corresponding to cones.
Definition 2.54 (Saturated semigroup). An affine semigroup S ⊂ M is saturated if km ∈ S
for k ∈ N>0 , m ∈ M implies that m ∈ S.
Theorem 2.55. Let V be an affine toric variety with dense torus T ≃ (C∗ )n , whose
(co)character lattice is M (N ). The following are equivalent.
1. V is normal,
2. V = Specm(C[S]) for a saturated affine semigroup S ⊂ M ,
3. V ≃ Uσ = Specm(C[Sσ ]) for some strongly convex rational cone σ ⊂ NR .
Proof. We prove 1 ⇒ 2 ⇒ 3 and refer to [12, Thm. 1.3.5] for the remaining implication
3 ⇒ 1. For 1 ⇒ 2, suppose that C[S] is normal and km ∈ S. Then χkm ∈ C[S]. Since
the character lattice of V is M , χm is a regular function on T ⊂ V , and thus a rational
function on V . That is, χm belongs to the field of fractions of C[V ] = C[S] and it satisfies
the monic relation (χm )k − χkm = 0, with coefficients in C[S]. By normality, m ∈ S and S
is indeed saturated. For 2 ⇒ 3, suppose that S is saturated and that S = NA for a finite
set A = {m1 , . . . , ms }. Let σ ∨ = Cone(A ). It is clear that S ⊂ σ ∨ ∩ M . For the other
inclusion, suppose m ∈ σ ∨ ∩ M . Since
( s
)
X
σ ∨ ∩ (M ⊗Z Q) =
λi mi | λi ∈ Q≥0 ,
(2.2)
i=1

P
we have that m = si=1 λi mi for some nonnegative rational coefficients λi . Clearing denominators, we can find k such that km ∈ NA = S. Since S is saturated, we conclude m ∈ S
and thus S = σ ∨ ∩ M . Note that σ is strongly convex since V has dimension n.
Example 2.56. The affine toric variety YA with A = {2, 3} ⊂ Z is a standard example of a
non-normal variety. Its semigroup NA = {0, 2, 3, 4, . . .} is strictly contained in Conv(A ) ∩
18

Z = N. The affine toric variety YA with A = {2, 4} ⊂ Z from Example 2.15 is normal,
although NA ( Z. The reason is that A is saturated in the lattice it generates, i.e., in the
character lattice 2Z ⊂ Z of the dense torus of YA .

Next, we discuss which affine toric varieties are smooth. Smoothness implies normality,
so by Theorem 2.55, the only candidates are the affine toric varieties coming from cones.
Theorem 2.57. An affine toric variety V is smooth if and only if V = Specm(C[Sσ ]) for
some smooth rational cone σ.
Proof. If σ is smooth, Specm(C[Sσ ]) is smooth by Example 2.44. Conversely, suppose V = Uσ
is smooth and dim σ = n. Then in particular, the fixed point of the torus action corresponding to the maximal ideal m = hχm | m ∈ Sσ \ {0}i (see Corollary 2.53) is a smooth point p
of V . Therefore, the tangent space at p has dimension n: dimC m/m2 = n. Observe that
M
M
M
C · χm
C · χm ⊕
m=
C · χm =
m∈Sσ \{0}

m irreducible

=

M

m reducible

C · χm ⊕ m2 ,

m∈H

where H is the Hilbert basis of Sσ (Proposition 2.46). Hence |H | = n, which implies that
σ ∨ ∩ M is generated by n elements. The Hilbert basis contains the minimal generators,
and σ has dimension n by assumption, so that σ has n rays. Moreover, ZSσ = ZH = M ,
which means that H is a Z-basis for M . We conclude that σ ∨ is smooth, and smoothness
is preserved by duality (exercise). For the case dim σ < n we refer to [12, Thm. 1.3.12].
The proof of Theorem 2.57 implies that in general, when σ is a strongly convex rational
cone of dimension n, the tangent space at the torus fixed point of Uσ has dimension |H |.
For any affine embedding of Uσ , the tangent space is at most the dimension of the ambient
affine space. Therefore |H | is the smallest s for which Uσ can be embedded in Cs .
Example* 2.58. Consider the rational cone
σ = Cone((1, 2, 3), (2, 1, 3), (1, 3, 2), (3, 1, 2), (2, 3, 1), (3, 2, 1)) ⊂ R3 .
This is the cone over the two-dimensional permutohedron, see Example* 3.53. Since σ ⊂ R3≥0 ,
σ is strongly convex and hence dim Uσ = 3 (Proposition 2.43). We check this in Julia by
constructing an affine normal toric variety from σ:
U_σ = AffineNormalToricVariety(σ); dim(U_σ)

1

For any embedding Uσ ≃ YA ⊂ Cs , s is at least 15, since this is the number of elements in
the Hilbert basis of σ ∨ , computed as in Example 2.40. The function toric ideal can be
used on the object returned by AffineNormalToricVariety:
I = toric_ideal(U_σ)

1

This computes 77 binomial generators for I(YA ) within 0.0028 seconds.



19

2.10

Toric morphisms

Let Vi = Specm C[Si ], i = 1, 2 be affine toric varieties. In this section we study morphisms
φ : V1 → V2 which preserve the toric structure.
Definition 2.59 (Toric morphism). A morphism φ : V1 → V2 is toric if the pullback φ∗ :
b
C[S2 ] → C[S1 ] is induced by a semigroup homomorphism φb : S2 → S1 , i.e. φ∗ (χm ) = χφ(m) .
Example 2.60. The map ΦA : T → (C∗ )s of tori from previous sections is a toric morphism.
b A : Zs → M .
The pullback map is induced by our map Φ

The following result tells us that to check whether a morphism φ is toric, it suffices to
know its restriction to the torus of V1 . Let Ti be the dense torus of the affine toric variety
Vi for i = 1, 2. The (co)character lattice of Ti is denoted by Mi (Ni ).
Proposition 2.61. A morphism φ : V1 → V2 is toric if and only if φ(T1 ) ⊂ T2 and the
restriction φ|T1 : T1 → T2 is a group homomorphism.
Proof. By point 2 in Proposition 2.28, we have Mi = ZSi . If φ is toric, φb : S2 → S1 extends
to a group homomorphism φb : M2 → M1 . We obtain the diagrams
S2

C[S2 ]

S1

C[S1 ]

−→
M2

M1

V2

V1

T2

T1

Specm

−→

C[M2 ]

C[M1 ]

which shows that φ(T1 ) ⊂ T2 . The map V1 → V2 is φ and T1 → T2 is φ|T1 . This is indeed
a group homomorphism, obtained by taking HomZ (−, C∗ ) of φb : M2 → M1 . The reader
is encouraged to verify this last statement. Conversely, if φ(T1 ) ⊂ T2 and φ|T1 is a group
homomorphism, the diagram on the right of the above display induces the diagram in the
middle, in which C[M2 ] → C[M1 ] comes from a group homomorphism M2 → M1 which
restricts to a semigroup homomorphism S2 → S1 , hence φ is toric.
Proposition 2.62. A toric morphism φ : V1 → V2 is equivariant, meaning that φ(t · p) =
φ(t) · φ(p) for t ∈ T1 , p ∈ V1 .
Proof. The statement comes down to the fact that the diagram
T1 × V1
φ|T1 ×φ

T2 × V2

T1 × T1

V1
φ

, which restricts to

φ|T1 ×φ|T1

T2 × T2

V2

T1
φ|T1 ,

T2

commutes. The commutation of the right diagram follows from the fact that φ|T1 is a group
homomorphism. Then the left diagram gives two maps T1 × V1 → V2 . Since they agree on a
nonempty Zariski open subset, they agree on T1 × V1 , so also the left diagram commutes.

20

We now show how to construct toric morphisms φ : V1 → V2 between normal affine toric
varieties from maps of lattices. Let φ : N1 → N2 be a group homomorphism, with N1 ≃
Zn1 , N2 ≃ Zn2 . The Ni are the cocharacter lattices of the tori Ti = Ni ⊗Z C∗ ≃ (C∗ )ni . The
map φ naturally induces a group homomorphism φ|T1 : T1 → T2 , which takes u⊗t 7→ φ(u)⊗t.
Example 2.63. Here’s how this works in coordinates. Let Ni = Zni , Ti = (C∗ )ni . Then
φ : Zn1 → Zn2 is given by a matrix F ∈ Zn2 ×n1 . We write Fi,: ∈ Zn1 for the i-th row of F .

The map φ|(C∗ )n1 : (C∗ )n1 → (C∗ )n2 is given by φ|(C∗ )n1 (t) = (tF1,: , . . . , tFn2 ,: ).
Let σi ⊂ (Ni )R , i = 1, 2 be strongly convex rational cones. Our next goal is to characterize
when φ induces a map of tori φ|T1 which extends to a toric morphism φ : Uσ1 → Uσ2 . Note
that this makes sense since Ti is the dense torus of Uσi by Proposition 2.28. We denote
φR = φ ⊗Z R : (N1 )R → (N2 )R . In the notation of Example 2.63, this is the linear map
Rn1 → Rn2 represented by F .
Proposition 2.64. Let φ : N1 → N2 be a group homomorphism. The induced map of tori
φ|T1 : T1 → T2 extends to a toric morphism φ : Uσ1 → Uσ2 if and only if φR (σ1 ) ⊂ σ2 .
Proof. We identify Ni = Zni and Ti = (C∗ )ni as in Example 2.63, so that φ is represented
by F ∈ Zn2 ×n1 . The map of tori φ|T1 : T1 → T2 gives a map of character lattices φb : M2 =
Zn2 → M1 = Zn1 which is given by the transpose F > . For this to induce a map of C-algebras
b 2 ) ∈ Sσ = σ ∨ ∩ Zn1 for all m2 ∈ Sσ = σ ∨ ∩ Zn2 , or
φ∗ : C[Sσ2 ] → C[Sσ1 ] we need that φ(m
1
2
1
2
hF > m2 , u1 i ≥ 0,
⇐⇒ hm2 , F u1 i ≥ 0,
⇐⇒ F u1 ∈ (σ2∨ )∨ = σ2 ,

for all u1 ∈ σ1 , m2 ∈ σ2∨
for all u1 ∈ σ1 , m2 ∈ σ2∨
for all u1 ∈ σ1 .

If φR : (N1 )R → (N2 )R satisfies φ(σ1 ) ⊂ σ2 , we say that φ is compatible with σ1 and σ2 .
Example 2.65 (Affine open subsets from faces). Let σ ⊂ NR be a strongly convex rational
cone and let τ  σ be one of its faces. The identity map φ : N → N is compatible with τ and
σ. It induces the inclusion φ : Uτ ,→ Uσ . The pullback map is the inclusion of C-algebras
φ∗ : C[Sσ ] ,→ C[Sτ ] induced by σ ∨ ∩ M ⊂ τ ∨ ∩ M . It is shown in [12, Prop. 1.3.16] that
C[Sτ ] = C[Sσ ]χm = C[Sσ ][χ−m ] is the localization of C[Sσ ] at χm . That is, Uτ is the affine
open subset {p ∈ Uσ | χm (p) 6= 0} of Uσ . This is illustrated in Figure 4.

Example 2.66. Let σ be the cone R2≥0 ⊂ R2 with affine toric variety Uσ = C2 . The dual
cone of the face τ = R≥ · e1 is τ ∨ = R≥0 × R ⊂ (R2 )∨ , which contains σ ∨ = R2≥0 ⊂ (R2 )∨ .
The coordinate ring of Uτ is given by C[Uτ ] = C[Sτ ] = C[x1 , x2 , x−1
2 ] = C[Uσ ]x2 . Here the
m
monomial x2 corresponds to the character χ with m = (0, 1), for which Hm ∩ σ = τ .

Example 2.67 (Sublattices of finite index). Let N1 = Z2 and N2 = {(a/2, b/2) ∈ Z2 | a+b =
0 mod 2} . We consider the cone σ = R2≥0 ⊂ R2 = (N1 )R = (N2 )R . The identity map
φ : R2 → R2 is trivially compatible with σ and σ. The dual lattices are M1 = {(a, b) ∈
Z2 | a − b = 0 mod 2} and M2 = Z2 . Considering σ as a rational cone in (N2 )R , we obtain
the affine toric variety Uσ,N1 = C2 . On the other hand, Uσ,N2 is not smooth, as the Hilbert
21

σ∨
σ

m
τ

(0, 0)

τ∨

(0, 0)

−m

Figure 4: The semigroup algebra C[Sτ ] = C[τ ∨ ∩ Z2 ] is the localization C[σ]χm .
basis of σ ∨ ⊂ (M2 )R has three elements (2, 0), (1, 1) and (0, 2). The map φ induces a toric
morphism φ : Uσ,N1 → Uσ,N2 given by
φ∗ : C[x, y, z]/hxz − y 2 i ,→ C[s, t],

where x 7→ s2 , y 7→ st, z 7→ t2 .

The map φ is generically 2-to-1, and the multiplicative group {−1, 1} acts on its fibers. The
ring of invariants of this action is im φ∗ . See [12, Ex. 1.3.19] for a nice discussion.

Exercise 2.68. Consider the map φ : Z4 → Z2 given by the matrix


1 0 −1 0
F =
.
0 1 2 −1
This is compatible with the cones σ1 = Cone(e3 , e4 ) ⊂ R4 and σ2 = Cone((−1, 2), (0, −1)) ⊂
R2 .
Show that the corresponding toric morphism from Uσ1 ≃ C2 × (C∗ )2 =
−2 −1
Specm(C[X1±1 , X2±1 , X3 , X4 ]) to Uσ2 ≃ C2 = Specm(C[t−1
1 , t1 t2 ]) = Specm(C[x, y]) is
C[x, y] −→ C[X1±1 , X2±1 , X3 , X4 ],

3

where x 7→

X3
X1

and y 7→

X4
.
X12 X2

Projective toric varieties

We proceed by studying projective toric varieties. These often arise as the closure of the
image of a monomial map to projective space, in which case they are covered by affine toric
varieties. The polyhedral cones in this setting come from a convex lattice polytope, which
combinatorially encodes how the affine pieces are glued together. We start with identifying
Pn as a projective toric variety. Next, we define projective toric varieties embedded via
monomial maps and derive their dimension and degree. Next, we discuss affine covers,
connections with polytopes, normality and smoothness.
22

3.1

Definition of a projective toric variety

Definition 3.1 (Projective toric variety). A projective toric variety is an irreducible projective variety X containing a torus T ≃ (C∗ )n as a Zariski open subset, such that the action
of T on itself extends to an algebraic action T × X → X of T on X.
Example 3.2. Pn is a projective toric variety with torus
TPn = {(x0 : · · · : xn ) ∈ Pn | xi 6= 0, for all i}
= {(1 : t1 : · · · : tn ) ∈ Pn | t ∈ (C∗ )n } ≃ (C∗ )n ,
where t ∈ (C∗ )n acts by t · (x0 : x1 : · · · : xn ) = (x0 : t1 x1 : · · · : tn xn ). Recall that
TPn ≃ (C∗ )n+1 /C∗ , where the quotient is realized by the surjective map
π : (C∗ )n+1 → TPn ,

(t0 , . . . , tn ) 7→ (t0 : · · · : tn ).

This is a group homomorphism, and it induces an inclusion of character lattices Mn ,→ Zn+1 ,
where Mn is the character lattice of TPn . This is made explicit by reversing the arrows in
the short exact sequence
π

1 −→ C∗ −→ (C∗ )n+1 −→ TPn −→ 1
which shows that Mn = ker((a0 , . . . , an ) 7→ a0 + · · · + an ) = {a ∈ Zn+1 |

3.2

Pn

i=0 ai = 0}.



Projective toric varieties from monomial maps

Recall that a finite subset A = {m1 , . . . , ms } ⊂ M gives a map ΦA : T → (C∗ )s given by
t 7→ (χm1 (t), . . . , χms (t)) . In Section 2.3 we used this map to construct affine toric varieties.
In this section, we compose this map with the quotient map π : (C∗ )s → TPs−1 introduced
above in order to obtain a projective toric variety. We set
XA = (π ◦ ΦA )(T ) ⊂ Ps−1 .
Example 3.3. When T = (C∗ )n and M = Zn , XA is the Zariski closure of the image of the
monomial map t 7→ (tm1 : · · · : tms ).

The proof of the following proposition is similar to that of Proposition 2.10.
Proposition 3.4. With the notation introduced above, XA ⊂ Ps−1 is a projective toric
variety. Its dense torus is (π ◦ ΦA )(T ) = XA ∩ TPs−1 .
In the case where the image of ΦA is invariant under coordinate-wise scaling
(x1 , . . . , xs ) 7→ (λx1 , . . . , λxs ), the affine toric variety YA is clearly the affine cone over the
projective toric variety XA . This happens in the following example.
Example 3.5. Let M = Z2 and A = {(1, 0), (1, 1), (1, 2)}. This gives the affine toric variety
YA = {xz − y 2 = 0}, which is the affine cone over the projective toric curve XA , given by
the same equation in the homogeneous coordinates (x : y : z) on P2 .

23

The following proposition characterizes the subsets A ⊂ M for which YA is the affine
cone over XA .
Proposition 3.6. The toric ideal I(YA ) is homogeneous if and only if there exists u ∈ N
and c ∈ Z \ {0} such that hu, mi i = c for all i.
If M = Zn , we can collect the mi in the columns of a matrix A ∈ Zn×s . The condition
in Proposition 3.6 is equivalent to (1, . . . , 1) being in the row space of A, viewed as a matrix
over Q, and to m1 , . . . , ms lying on an affine hyperplane in MR .
Proof. Without loss of generality, we assume M = Zn . Note that I(YA ) cannot contain
a monomial, as we have (1, . . . , 1) ∈ YA ⊂ Cs (Exercise 2.22). Therefore, if I(YA ) is
homogeneous, each binomial generator in Theorem 2.19 must be homogeneous:
s
s
s
X
X
X
(`+ )i −
(`− )i =
`i = 0,
i=1

i=1

bA .
for all ` ∈ ker Φ

(3.1)

i=1

This is equivalent to (1, . . . , 1) ∈ Qs being in the row space of A, so that hû, mi i = 1 for
some û ∈ Qn and for all mi ∈ A . Clearing denominators gives hu, mi i = c. Conversely, if
(1, . . . , 1) is in the row space of A, then (3.1) holds. By Theorem 2.19, I(YA ) is generated
by homogeneous polynomials.
We use Proposition 3.6 to show that for any finite subset A = {m1 , . . . , ms } ⊂ M = Zn ,
there is Ac ⊂ Zn × Z such that XA = XAb and YAb is the affine cone over XAb. This set
Ac⊂ Zn ⊕ Z can be obtained by appending a“1”-entry to each element of A . This way
(π ◦ ΦA ) : t 7→ (tm1 : · · · : tms ) and (π ◦ ΦAb) : (t, tn+1 ) 7→ (tn+1 tm1 : · · · : tn+1 tms )
have the same image in TPs−1 . Moreover, setting u = en+1 , Proposition 3.6 guarantees that
I(YAb) is homogeneous, so we arrive at the following result.
Proposition 3.7. With the notation above, XA = XAb and YAb is the affine cone over XAb.
We are now ready to discuss the character lattice of the dense torus of XA .
Definition 3.8 (Affine lattice). The lattice affinely generated by A = {m1 , . . . , ms } ⊂ M is
( s
)
s
X
X
Z0 A =
ai mi | a ∈ Zs ,
ai = 0 ⊂ M.
i=1

i=1

Exercise 3.9. Writing A − mi = {mj − mi , . . . , ms − mi }, show that Z0 A = Z(A − mi ),
for i = 1, . . . , s.
Proposition 3.10. The character lattice of the dense torus TXA ⊂ XA is Z0 A .
Proof. Writing M 0 for the character lattice of TXA , the statement follows as in the proof of
Proposition 2.10 from
24

T

(P∗ )s−1

M

Ms−1
.
M0

TXA

Corollary 3.11. The dimension of XA is the rank of Z0 A , which is rank ZA − 1 if the
condition of Proposition 3.6 is satisfied, and rank ZA otherwise.
Proof. For details, see [12, Prop. 2.1.6].
Exercise 3.12. Let M = Z2 and A = {(1, 0), (0, 1), (1, 2), (2, 1)}. Show that Z0 A has the
same rank as ZA , but it has index 2 as a sublattice. Geometrically, this translates into
(π ◦ ΦA ) being two-to-one (see Example 2.67).

3.3

Convex lattice polytopes

We will see that the projective toric varieties from the previous section are in many ways
related to convex polytopes. In this section, we introduce some definitions and basic facts
related to these objects. Much of this is taken from [30, App. D].
Definition 3.13 (Polytope). A polytope P in MR is the convex hull of a finite set of points
A = {m1 , . . . , mk } in MR :
( k
)
k
X
X
P = Conv(A ) =
ci mi ∈ MR | ci ∈ R,
ci = 1, ci ≥ 0 ⊂ MR .
i=1

i=1

If A ⊂ M , P is called a lattice polytope.
Note that we define a polytope to be convex. The reason is that we will not encounter
non-convex polytopes in this text. The dimension dim P of a polytope P ⊂ MR is defined
as the dimension of the smallest affine subspace of MR containing P . A polytope in MR is
said to be full-dimensional if dim P = n. A point u ∈ NR \{0} and a scalar a ∈ R give
+
Hu,a = {m ∈ MR | hu, mi + a = 0} and Hu,a
= {m ∈ MR | hu, mi + a ≥ 0}.

Definition 3.14 (Faces of a polytope). Take u ∈ NR \{0}, a ∈ R and let P ⊂ MR be a
+
convex polytope. The set Hu,a ∩ P is a face of P if P ⊂ Hu,a
and a = − minm∈P hu, mi. We
say that P is a face of P by convention. We write Q  P if Q is a face of P .
A hyperplane Hu,a for which Hu,a ∩ P is a face of P is called a supporting hyperplane. A
face Q of a polytope is again a polytope. The codimension of a face Q ⊂ P is dim P − dim Q.
A face of codimension 1 in P is called a facet, a face of dimension 1 is an edge and a face of
dimension 0 is a vertex. One way of representing a polytope P in terms of faces uses vertices:
P = Conv(v ∈ MR | v is a vertex of P ).
25

This is called a vertex representation or V-representation. Alternatively, any polytope can be
+
expressed as the intersection of finitely many closed half-spaces Hu,a
associated to supporting
hyperplanes. That is, any polytope P ⊂ MR can be written as
P = Hu+1 ,a1 ∩ · · · ∩ Hu+k ,ak = {m ∈ MR | hui , mi + ai ≥ 0, i = 1, . . . , k}

(3.2)

for some u1 , . . . , uk ∈ NR , a1 , . . . , ak ∈ R. The representation in (3.2) is called a half-space
representation or H-representation of the polytope P . There exist infinitely many different Hrepresentations for any polytope. However, if P is full-dimensional, there exists an essentially
unique, minimal H-representation of P , in the sense that it consists of a minimal number k of
inequalities where the inequalities are uniquely defined up to multiplication with a nonzero
scalar. Suppose that P is full-dimensional. For a supporting hyperplane Hu,a corresponding
to a facet Q of P , the vector u is uniquely determined up to a nonzero scalar factor. For every
facet Q, let uQ , aQ be such that P ⊂ Hu+Q ,aQ , HuQ ,aQ ∩ P = Q. The minimal H-representation
of P is given by
\
Hu+Q ,aQ .
P =
Q facet of P

If P is a full-dimensional lattice polytope, then for any facet Q ⊂ P , uQ can be chosen in a
unique way as the generator of the sublattice
{u ∈ N | hu, mi = 0 for all m ∈ Q},
for which P ∈ Hu+Q ,aQ . This is called the primitive, inward pointing facet normal of Q. It is
the inward pointing integer vector perpendicular to Q of the smallest length. Below, by ‘the
facet normal’ associated to Q we mean the primitive, inward pointing facet normal.
Example 3.15. Figure 5 shows a full-dimensional polytope in R2 (a 2-dimensional polytope
is also called a polygon) together with its interior lattice points and primitive inward pointing
facet normals. The minimal H-representation is given by
u1 = (−2, −1),

u2 = (1, 2) and u3 = (1, −1).

The supporting hyperplane Hu2 ,a2 is also shown in Figure 5, and its corresponding half-space
Hu+2 ,a2 (shaded in green) contains the polytope. We note that, strictly speaking, the orange
arrows do not belong in the same picture: they live in the dual plane (R2 )∨ .

For any polytope P ⊂ MR and any λ ∈ R, λ ≥ 0, we define the polytope λ · P as
λ · P = {λp | p ∈ P }. This is called a dilation of the polytope P and all dilations are
obtained by restricting scalar multiplication in MR to P .

3.4

Kushnirenko’s theorem

In this section we relate the degree of XA ⊂ Ps−1 to the volume of a convex lattice polytope.
When M R= Zn and A ⊂ Zn is finite, P = Conv(A ) is a polytope in Rn with volume
Vol(P ) = P dx1 · · · dxn . To simplify some of the statements in this section, we will often
assume that
A = {m1 , . . . , ms } ⊂ Zn is such that Z0 A = Zn .
(3.3)
Here is this section’s main result, due to Kushnirenko [20].
26

Hu+2 ,a2
u3
Hu2 ,a2

u1

u2

Figure 5: Illustration of a lattice polytope of dimension 2 and its primitive inward
pointing facet normals.
Theorem 3.16 (Kushnirenko’s theorem). Consider A ⊂ Zn satisfying (3.3). The degree of
XA ⊂ Ps−1 is the normalized volume n! Vol(P ) of the convex lattice polytope P = Conv(A ).
Remark 3.17. The degree of a projective variety X ⊂ Ps−1 can be thought of as the generic
number of intersection points of X with a generic linear space of dimension s − 1 − dim(X).
A more precise definition can be given via the Hilbert polynomial of X, see below.
Remark 3.18. The term normalized volume in Theorem 3.16 indicates that the volume measure is normalized such that a standard simplex ∆n = Conv(0, e1 , . . . , en ) in the lattice Zn
has volume 1: n! Vol(∆n ) = 1. If A does not satisfy (3.3), one needs to replace the number
n! Vol(P ) in Theorem 3.16 with the normalized volume of Conv(A ) in the lattice Z0 A .
Before proving Theorem 3.16, we state an important consequence for the study of systems
of polynomial equations, alluded to in Example 1.1.
Corollary 3.19. For A ⊂ Zn satisfying (3.3), consider
the system of Laurent polynomial
Ps
±1
equations f1 (t) = · · · = fn (t) = 0 where fi (t) = j=1 cij tmj ∈ C[t±1
1 , . . . , tn ], i = 1, . . . , n.
∗ n
This system has at most n! Vol(P ) isolated solutions in (C ) , with P = Conv(A ). Moreover,
for generic coefficients cij , the number of solutions is precisely n! Vol(P ).
Proof. Let L = {C · x = 0} be the linear space in Ps−1 defined by the matrix of coefficients
C = (cij ) ∈ Cn×s . By Proposition 3.10 and the assumption (3.3), the solutions of f1 (t) =
· · · = fn (t) = 0 are in one to one correspondence with the points in L ∩ XA ∩ TXA . The set
L ∩ XA contains at most deg(XA ) isolated points, and for generic C, |L ∩ XA | = deg(XA )
and L ∩ XA ⊂ TXA , see [20, Thm. III’ (ii)]. The statement follows from Theorem 3.16.
We present a proof of Theorem 3.16 based on the lecture notes [26] by Frank Sottile. It
uses the following result by Hilbert, see [30, Thm. 2.2.5] and references therein.
Theorem 3.20. Let X ⊂ Ps−1 be a projective variety with coordinate ring C[X] =
C[x1 , . . . , xs ]/I(X). For d  0, the Hilbert function
HFX : Z → N,

d 7→ dimC C[X]d

is given by a polynomial HPX (d), called the Hilbert polynomial of X, with leading term
deg(X) dim(X)
d
.
dim(X)!
27

In order to use Theorem 3.20 to prove Theorem 3.16, we must understand the coordinate
ring C[XA ] of XA and its graded pieces. We use the notation Acfrom Proposition 3.7.
Lemma 3.21. Let A = {m1 , . . . , ms } ⊂ M be a finite subset. The coordinate ring C[XA ]
of XA ⊂ Ps−1 is the semigroup algebra C[NAc] ⊂ C[M ⊕ Z], with grading
M
M
C[NAc] =
C[NAc]d , C[NAc]d =
C · χ(m,d) .
d∈Z

Here dA = {

m∈dA

1≤i1 ≤···≤id ≤s mid } and C[NA ]d = 0 for d < 0.

P

c

Proof. By Propositions 2.28 and 3.7, C[XA ] = C[YAb] = C[x1 , . . . , xs ]/I(YAb) ≃ C[NAc]. The
last isomorphism is given by [xi ] 7→ χ(mi ,1) , which induces the grading.
Example 3.22. Let A = {0, 2, 3} ⊂ Z, such that Ac= {(0, 1), (2, 1), (3, 1)}. The semigroup
NAcis shown in [26, Fig. 5]. The number of characters χ(m,d) ∈ C[NAc]d is 1, 3, 6, 9, 12, . . .
for d = 0, 1, 2, 3, 4, . . .. These are the values of the Hilbert function HFXA of XA ⊂ P2 . The
Hilbert polynomial is HPXA = 3d, and it agrees with HFXA for d ≥ 1. The vanishing ideal

I(XA ) = I(YAb) is hxz 2 − y 3 i.
The previous example illustrates the following corollary.
Corollary 3.23. The Hilbert function of XA is given by HFXA (d) = |dA |.
To link the leading coefficient of the Hilbert function to the volume of Conv(A ), we need
some results from polyhedral geometry. Here is a famous result by Ehrhart [14].
Theorem 3.24. Let P ⊂ Rn be a convex lattice polytope of dimension n. The function
EP : N → N given by d 7→ |d · P ∩ Zn | is a polynomial with leading term Vol(P ) dn .
Example* 3.25. The Ehrhart polynomial of a polytope P can be computed using
Oscar.jl. We illustrate this and some more functionalities for the polytope P =
Conv((0, 0), (1, 0), (0, 1), (2, 1), (1, 2)) in Figure 6.

Note that we have the obvious inequality HFXA (d) ≤ EP (d), for d ≥ 0 and P =
Conv(A ). If equality holds, we are done, since combining Theorems 3.20 and 3.24 would
give deg(XA ) = n!Vol(P ). In general, the inequality may be strict for all d, see Example
3.22. However, the Hilbert and Ehrhart polynomials do have the same leading term, which
is our strategy for proving Theorem 3.16.
Let A be as in (3.3) and σ ∨ = Cone(Ac) ⊂ Rn+1 . This gives a semigroup Sσ = σ ∨ ∩ Zn+1 .
Remark 3.26. Note that HFXA (d) = EP (d), d ≥ 0 if and only if Sσ is saturated in M ⊕ Z.
In this case XA is projectively normal, see Exercise 3.37.
Lemma 3.27. If A satisfies (3.3), there exists m ∈ NAcsuch that m + Sσ ⊂ NAc.

28

Figure 6: The polygon P has dimension 2. It has 5 vertices and 5 edges, and its
Ehrhart polynomial is 25 x2 + 52 x + 1.
P
Proof. Let B = { si=1 λi (mi , 1) ∈ Zn+1 | λi ∈ [0, 1) ∩ Q}. ForPa geometric interpretation,
see Example 3.28. For each b ∈ B, fix ai (b) ∈ Z such that b = si=1 ai (b)(mi , 1). Note that
this is possible by the assumption Z0 A = Zn . Fix ν ∈ N such that −ν ≤ ai (b) for all b ∈ B
P
c
and i = 1, . . . , s. We define m = ν si=1 (mi , 1) and show that
Psm + Sσ ⊂ NA .
0
0
(mi , 1). Set αi = λi + γi
If m ∈ m + Sσ , there exist αi ∈ Q≥0 such that m
m = i=1 αiP
P−
s
0
where λi ∈ [0, 1) ∩ Q and γi ∈ N. Then m − m = i=1 λi (mi , 1) + si=1 γi (mi , 1), so that
0

m =m+

s
X
i=1

where b =

λi (mi , 1) +

s
X

γi (mi , 1) =

i=1

s
X

(ν + ai (b))(mi , 1) +

i=1

s
X

γi (mi , 1),

i=1

i=1 λi (mi , 1) ∈ B, and both sums are in NA

Ps

cby construction.

Proof of Theorem 3.16. By the proof of Lemma 3.27, there exist m̃ ∈ Zn , e ∈ N such that
m = (m̃, e) ∈ Sσ satisfies m + Sσ ⊂ NAc. Therefore, for d ≥ e we have
|(d − e) · P ∩ Zn | ≤ |dA | ≤ |d · P ∩ Zn |.
In terms of Ehrhart polynomials and Hilbert functions, by Corollary 3.23 this reads
EP (d − e) ≤ HFXA (d) ≤ EP (d)
and for d  0 we may replace HFXA (d) by HPXA (d). This implies that HPXA (d) and EP (d)
have the same leading term, which implies Theorem 3.16 by Theorems 3.20 and 3.24.
Example 3.28. The set B from the proof of Lemma 3.27 contains the origin in Zn+1 , and the
interior lattice points of a zonotope obtained by taking the Minkowski sum (see Definition
6.27) of the line segments connecting 0 with (mi , 1). This is shown in [26, Fig. 5].

Example* 3.29. Let A = {(0, 0), (1, 0), (0, 1), (2, 1), (1, 2)}. The polytope P = Conv(A )
was computed in Oscar.jl in Example* 3.25. It is the pentagon shown in Figure 7.
By Kushnirenko’s theorem, the surface XA ⊂ P5 has degree 5. This can be computed
in Oscar.jl using the command 2*volume(P). We verify this using Corollary 3.19 and
HomotopyContinuation.jl (v2.6.4) [5]. We construct random polynomials f1 , f2 as follows:
29

Figure 7: The polygons P = Conv(A ) and P 0 = Conv(A 0 ) from Example* 3.29.

using HomotopyContinuation, LinearAlgebra
@var t[1:2]
A = [0 0; 1 0; 0 1; 2 1; 1 2]
monomials = [prod(t.^A[:,i]) for i = 1:5]; coeffs = [randn(5) for i = 1:2];
f = [dot(coeffs[i], monomials) for i = 1:2]

1
2
3
4
5

The command solve(f) returns five solutions. Alternatively, we can count the number of
points in L ∩ XA ∩ TA as in the proof of Corollary 3.19. We compute the toric ideal
associated to Acusing Oscar.jl; we get the ideal of C[x1 , x2 , x3 , x4 , x5 ] generated by
x3 x4 − x2 x5 , x2 x23 − x21 x5 , x22 x3 − x21 x4 , x21 x24 − x32 x5 .
These are the equations of XA ⊂ P4 . The degree of XA counts the number of intersection
points with a generic linear space of codimension 2. This is obtained as follows:
@var x[1:5]
systemA = [x[3]*x[4]-x[2]*x[5]; x[2]*x[3]^2-x[1]^2*x[5];
x[2]^2*x[3]-x[1]^2*x[4]; x[1]^2*x[4]^2 - x[2]^3*x[5];
dot(coeffs[1],x); dot(coeffs[2],x); x[1]-1]

1
2
3
4

Note the dehomogenization x1 = 1. Entering solve(systemA) gives 5 solutions. They are
the images of the previously computed solutions in (C∗ )2 under π ◦ ΦA from Section 3.2.
We now remove the point (0, 0) from A to obtain A 0 , so that the assumption (3.3) is no
longer satisfied. The degree of XA 0 ⊂ P4 is 2, while the normalized volume of P 0 = Conv(A 0 )
in R2 is 4. The number of solutions to a new set of equations with support in A 0 is 4. This
discrepancy is due to the fact that the map (π ◦ ΦA 0 ) : (C∗ )2 → TXA 0 is two-to-one, since
Z0 A has index 2 in Z2 . See Exercise 3.12.

Remark 3.30. Another geometric invariant of XA that is encoded by P = Conv(A ) is its
dimension. By Proposition 3.10 and the fact that the rank of Z0 A is equal to the dimension
of P , we have dim XA = dim P . This holds regardless of the assumption (3.3).
30

3.5

Affine pieces of a projective toric variety

Let Ui = Ps−1 \ V (xi ) for i = 1, . . . , s be the standard affine charts of Ps−1 . Recall that
Ui ≃ Cs−1 via


xi−1 xi+1
xs
x1
(x1 : · · · : xs ) 7→
,...,
,
,...,
.
(3.4)
xi
xi
xi
xi
T
Note that TPs−1 = si=1 Ui . Since TXA = TPs−1 ∩ XA ⊂ Ui and XA is the Zariski closure
in Ps−1 of TXA , the affine piece XA ∩ Ui is the Zariski closure in Ui of TXA . Composing
Φ

A
T −→
Ui with (3.4) we obtain the map

t 7→ (χm1 −mi (t), . . . , χmi−1 −mi (t), χmi+1 −mi (t), . . . , χms −mi (t))
from which we immediately see the following.
Proposition 3.31. The i-th affine piece XA ∩Ui of XA is isomorphic to the affine toric variety YAi ≃ Specm(C[Si ]) where Ai = A − mi = {m1 − mi , . . . , mi−1 − mi , mi+1 − mi , . . . , ms }
and Si = NAi .
Remark 3.32. Note that the character lattice Z0 A of TXA is the same as the character lattice
ZAi of the dense torus of XA ∩ Ui ≃ C[Si ], as expected. See Exercise 3.9.
For an affine variety V with coordinate ring C[V ] we write Vf for the affine variety
Specm(C[V ]f ), f ∈ C[V ]. The inclusions
XA ∩ Ui ⊃ XA ∩ Ui ∩ Uj ⊂ XA ∩ Uj
can be described nicely in terms of the semigroup algebras C[Si ], C[Sj ] as follows. For the
inclusion XA ∩ Ui ⊃ XA ∩ Ui ∩ Uj , note that
XA ∩ Ui ∩ Uj = {x ∈ Ui | xj /xi 6= 0} = (XA ∩ Ui )[xj /xi ] ≃ Specm(C[Si ]χmj −mi ).
Hence XA ∩Ui ⊃ XA ∩Ui ∩Uj is given by the inclusion of C[Si ] in its localization C[Si ]χmj −mi .
Arguing analogously for XA ∩ Uj , we obtain
C[Si ] ⊂ C[Si ]χmj −mi ≃ C[Sj ]χmi −mj ⊃ C[Sj ].
This will help us prove another nice connection between P = Conv(A ) ⊂ MR and our
projective toric variety XA .
Proposition 3.33. Let A = {m1 , . . . , ms } ⊂ M , P = Conv(A ) ⊂ MR and V = {i | mi ∈
A is a vertex of P }. We have
XA =

s
[

XA ∩ Uj =

j=1

[
i∈V

31

XA ∩ Ui .

S
Proof. The first equality is the standard covering of XA induced by Ps−1 = si=1 Ui . For
the second equality, we show that XA ∩ Uj ⊂ Ui∗ for some i∗ P
∈ V. Let MQ P
= M ⊗Z Q.
Since mj ∈ P ∩ MQ , there exist ri ∈ Q≥0 , i ∈ V such that mj = i∈V ri mi and i∈V ri = 1.
Clearing denominators gives
X
X
kmj =
ki mi , with k, ki ∈ N,
ki = k.
i∈V

This gives

P

i∈V

i∈V ki (mj − mi ) = 0. We now choose i

mj − mi∗ =

X

∗

such that ki∗ > 0 and rewrite

ki (mi − mj ) + (ki∗ − 1)(mi∗ − mj ),

i∈V\{i∗ }

which shows that mj −mi∗ ∈ Sj . Therefore χmi∗ −mj is invertible in C[Sj ], and C[Sj ]χmi∗ −mj =
C[Sj ]. The statement follows from Proposition 3.31 and
XA ∩ Ui∗ ∩ Uj ≃ Specm(C[Sj ]χmi∗ −mj ) = Specm(C[Sj ]) ≃ XA ∩ Uj .

3.6

Very ample and normal polytopes

In previous sections we constructed a projective toric variety XA from a set of lattice points
A , and showed that the polytope Conv(A ) encodes many of its properties. In this section,
we start from a convex lattice polytope P and associate a projective toric variety to it by
using all lattice points contained in it: A = P ∩ M . We will see that the nicest such varieties
come from very ample convex lattice polytopes.
Definition 3.34 (Very ample). A convex lattice polytope P ⊂ MR is very ample if for every
vertex v ∈ P ∩ M , the semigroup N(P ∩ M − v) is saturated in the lattice M .
To each vertex v of a polytope P we associate the cone σv∨ = Cone(P − v) ⊂ MR . By
Theorem 2.55, a very ample polytope has the property that for each vertex v ∈ P ∩ M , the
lattice points in (P ∩ M − v) suffice to generate the semigroup σv∨ ∩ M .
Consider a full-dimensional, very ample lattice polytope P ⊂ MR . Let P ∩ M =
{m1 , . . . , ms } and let V = {i | mi ∈ P ∩ M is a vertex of P }. By Proposition 3.33, the
∨ ∨
toric variety XP ∩M ⊂ Ps−1 is covered by XP ∩M ∩ Ui , i ∈ V. We will write σi = σmi = (σm
)
i
for i ∈ V and Si = N(P ∩ M − mi ).
Theorem 3.35. With the above set-up, for every vertex mi , i ∈ V, XP ∩M ∩ Ui is isomorphic to the normal affine toric variety Uσi = Specm(C[σi∨ ∩ M ]) corresponding to the
n-dimensional, strongly convex rational cone σi . The dense torus of XP ∩M has character
lattice M .
Proof. The cone σi∨ = Cone(P ∩ M − mi ) is strongly convex of dimension dim P = n.
Hence, by Definition 2.36, σi is strongly convex of dimension n too. By very ampleness,
Si is saturated in M . Therefore XP ∩M ∩ Ui ≃ Specm(C[Si ]) = Specm(C[σi∨ ∩ M ]) = Uσi .
By Proposition 2.43, the torus of Uσi has character lattice M . Hence, so does TXP ∩M , see
Remark 3.32.
32

σ3∨

σ3

σ1∨

σ1

σ2∨

σ2

Figure 8: A fan from a triangle.
A projective variety is called normal if it is covered by normal affine varieties. Theorem
3.35 ensures that when P is very ample, the projective toric variety XP ∩M is normal. Here
is another property of convex lattice polytopes which is stronger than very ampleness.
Definition 3.36 (Normal polytopes). A convex lattice polytope P is normal if (k · P ) ∩
M + (` · P ) ∩ M = ((k + `) · P ) ∩ M for all k, ` ∈ N.
Exercise 3.37. Show that if P is normal, the affine cone YP\
over XP ∩M is a normal affine
∩M
toric variety. Projective varieties whose affine cone is normal are called projectively normal.
The following properties will be useful, see [12, Thm. 2.2.12, Prop. 2.2.18].
Proposition 3.38. Let P ⊂ MR be a full dimensional convex lattice polytope. Then k · P
is normal for all k ≥ n − 1.
Proposition 3.39. Every normal polytope P is very ample.
Remark 3.40. The converse of Proposition 3.39 is not true, see [12, Ex. 2.2.20].

3.7

Normal fans

In this section, we explain the main reason for defining Uσi from the cone σi dual to the cone
σi∨ , even though the latter seems more closely related to its coordinate ring. The cones σv ,
where v is a vertex of a full dimensional lattice polytope P , fit together very nicely.
Example 3.41. Consider the standard simplex Conv((0, 0), (1, 0), (0, 1)) ⊂ R2 . The cones
σ1 , σ2 , σ3 and their duals are shown in Figure 8.

Definition 3.42 (Fan). A fan in NR is a finite collection Σ of strongly convex rational
polyhedral cones such that
• if σ ∈ Σ and τ  σ is a face, then τ ∈ Σ,
• if τ = σ ∩ σ 0 for σ, σ 0 ∈ Σ, then τ  σ and τ  σ 0 .
33

Exercise 3.43. Show that the right part of Figure 8 represents a fan with three twodimensional cones, three one-dimensional cones and one zero-dimensional cone. Do you
see a correspondence with the faces of the standard simplex from Example 3.41?
Definition
3.44 (Normal fan). Let P ⊂ MR be full dimensional and let P
T
+
H
uF ,aF be the minimal H-representation of P . The normal fan of P is
F facet of P
ΣP = {σQ | Q  P },

=

where σQ = Cone({uF | Q ⊂ F }).

The fact that ΣP is a fan is [12, Thm. 2.3.2]. Here are some properties of normal fans.
Proposition 3.45. Let P ⊂ MR be a full-dimensional lattice polytope and for each face
Q  P , let σQ be as in Definition 3.44. We have
1. dim Q + dim σQ = n for all Q  P ,
S
S
2. NR = v vertex of P σv = QP σQ ,
3. for any m ∈ M , k ∈ N \ {0}, Σk·P +m = ΣP .
For a proof of Proposition 3.45, see [12, Prop. 2.3.8 and 2.3.9].
Example* 3.46. Here is how normal fans can be computed in Oscar.jl. We consider the

pentagon P from Example* 3.25 and execute normal fan(P). The result is Figure 9.

Figure 9: The normal fan from Example* 3.46.
Proposition 3.47. Let P ⊂ MR be a full-dimensional, very ample convex lattice polytope.
Let P ∩ M = {m1 , . . . , ms } and V = {i | mi is a vertex of P }. Let i, j ∈ V, i 6= j and let Q
be the smallest face of P containing mi and mj . Then
∨
XP ∩M ∩ Ui ∩ Uj ≃ UσQ = Specm(C[σQ
∩ M ])

and the inclusions
XP ∩M ∩ Ui ⊃ XP ∩M ∩ Ui ∩ Uj ⊂ XP ∩M ∩ Uj
are given by
C[Si ] ⊂ C[Si ]χmj −mi ≃ C[Sj ]χmi −mj ⊃ C[Sj ].
34

mi
mj
Sj
Si
mi − mj
mj − mi
Figure 10: An illustration of Proposition 3.47.
Proof. The statement about the inclusions follows from the discussion preceding Proposition
∨
∩ M ]. We refer to [12, Prop. 2.3.13].
3.33. It suffices to show that C[Si ]χmj −mi = C[σQ
Example 3.48. Proposition 3.47 is illustrated in Figure 10, taken from [30, App. E].



It follows from Proposition 3.47 that when P is full-dimensional and very ample, the affine
pieces of XP ∩M and the way they patch together to form XP ∩M are completely determined
by the normal fan ΣP . Consequently, if P, P 0 are both very ample with the same normal fan,
we have XP ∩M ≃ XP 0 ∩M . That is, XP ∩M and XP 0 ∩M are the same projective toric variety,
embedded in a different way.
Example 3.49. The standard simplex in Example 3.41 gives the toric variety XP ∩M = P2 .
Its dilation k · P is very ample for all k, and has the same normal fan by Proposition 3.45.
k+2
The toric surface X(k·P )∩M ⊂ P( 2 )−1 is the k-th Veronese embedding of P2 .

Example* 3.50. The projective toric variety XP ∩M where P is the polygon from Example
3.48 can be defined in Oscar.jl as follows:
P = convex_hull([0 0; 3 -1; 2 2; 1 2])
X = NormalToricVariety(P)

1
2

Recall that all polygons are normal by Proposition 3.38. Therefore, we can embed XP ∩M ⊂
P7 via the toric morphism induced by the map of tori (C∗ )3 → (C∗ )8 associated to the matrix


0 1 1 1 2 2 2 3
A = 0 0 1 2 0 1 2 −1 .
1 1 1 1 1 1 1 1
35

Its columns are the points in Acobtained from lattice points(P). The toric ideal IAb is
h−x5 x7 + x26 , −x4 x8 + x5 x6 , −x3 x7 + x4 x6 , −x2 x7 + x3 x6 , −x3 x8 + x25 ,
−x2 x7 + x4 x5 , −x2 x6 + x3 x5 , −x1 x7 + x2 x4 , −x1 x7 + x23 , −x1 x6 + x2 x3 ,
−x1 x5 + x22 , x2 x6 x7 − x24 x8 , x2 x5 x7 − x3 x4 x8 , x1 x6 x27 − x34 x8 ,
x1 x5 x27 − x3 x24 x8 , x1 x3 x37 − x44 x8 , x1 x2 x37 − x3 x34 x8 , x21 x47 − x3 x44 x8 i
and it can be obtained using the command toric ideal which takes as input the matrix A.
The affine charts XP ∩M ∩ Ui and XP ∩M ∩ Uj corresponding to the cones in Figure 10 are
computed via affine open covering(X). They can be obtained by dehomogenizing with
respect to the variable associated to the vertices mi and mj , which in our notation are x3
and x4 respectively: the vertices mi , mj correspond to columns 1 and 8 of A. Their overlaps
(XP ∩M ∩ Ui ) ∩ Uj and (XP ∩M ∩ Uj ) ∩ Ui are isomorphic via the usual map
 x 


x1 x2 x3 x4 x5 x6 x7
x2 x3 x4 x5 x6 x7 x8 · x18
7−→
, , , , , , ,1 .

1, , , , , , ,
x1 x1 x1 x 1 x1 x1 x1
x8 x8 x8 x8 x8 x8 x8

3.8

Projective toric varieties from polytopes

To a (not necessarily very ample) full dimensional polytope P ⊂ MR , we would like to
associate the normal projective toric variety coming from its normal fan. If P is not very
ample, the first guess XP ∩M for its projective toric variety is not normal. In order to fix this,
by Proposition 3.38 we can dilate P such that it becomes normal. By Proposition 3.45, this
does not change the normal fan.
Definition 3.51 (The toric variety of a polytope). To a full dimensional convex lattice
polytope P ⊂ MR we associate the projective toric variety XP ≃ X(k·P )∩M for any k such
that k · P is very ample.
As pointed out in the previous section, different choices of k in Definition 3.51 correspond
to different embeddings of the same projective variety XP = Xk·P .
We conclude with a result on normality and smoothness. The proof is easy and left as
an exercise. A fan Σ is called smooth if all of its cones σ ∈ Σ are smooth. A polytope P is
smooth if its normal fan is smooth.
Proposition 3.52. Let P be a full dimensional lattice polytope in MR . The projective toric
variety XP is normal. It is smooth if and only if P is smooth, and it is projectively normal
if and only if P is normal.
Example* 3.53. The permutohedron Πn is a lattice polytope of dimension n − 1 in Rn
whose vertices are given by the permutations of the first n natural numbers. Note that it is
contained in the affine hyperplane


n(n + 1)
n
.
(x1 , . . . , xn ) ∈ R | x1 + . . . + xn = 1 + 2 + . . . + n =
2
The toric variety XΠn associated to Πn is sometimes called a permutohedral variety. For
instance, the permutohedral curve is P1 and the permutohedral surface is a toric surface of
36

(1, 3, 2)

(1, 2, 3)

(2, 3, 1)

(2, 1, 3)
(2, 2, 2)

(3, 2, 1)

(3, 1, 2)

Figure 11: Left: the hexagon Π3 ⊂ {(x1 , x2 , x3 ) ∈ R3 | x1 + x2 + x3 = 6}. The
7 blue dots are the lattice points contained in Π3 . Right: the polytope Π4 ⊂
{(x1 , x2 , x3 , x4 ) ∈ R4 | x1 + x2 + x3 + x4 = 10}. It has 38 lattice points, 24 = 4! of
which are vertices.
degree 6. For all n, Πn is a smooth, normal polytope, so that XΠn is smooth and projectively
normal. We check these properties using Oscar.jl for n = 4:
PP = Polyhedron(polytope.permutahedron(3))
P = project_full(PP)
X = NormalToricVariety(P)
isnormal(P)
issmooth(P)

1
2
3
4
5

We compute the Hilbert function of XΠn ∩Zn . Because the variety is projectively normal,
the Hilbert polynomial coincides with the Ehrhart polynomial of Πn . We get
EΠ3 (x) = 3x2 + 3x + 1,
EΠ4 (x) = 16x3 + 15x2 + 6x + 1,
EΠ5 (x) = 125x4 + 110x3 + 45x2 + 10x + 1,
EΠ6 (x) = 1296x5 + 1080x4 + 435x3 + 105x2 + 15x + 1,
EΠ7 (x) = 16807x6 + 13377x5 + 5250x4 + 1295x3 + 210x2 + 21x + 1.
Oscar.jl can compute this on a MacBook Pro within one minute for n ≤ 7. The leading
coefficient of EΠn , which equals the Euclidean volume Vol(EΠn ) by Theorem 3.24, is nn−2 .
This is the number of trees on n labeled nodes [25, Prop. 2.4].

Example 3.54. Let P = Conv({(0, 0), (1, 2), (2, 1)}) be the triangle shown in Figure 12.
Since all polygons are very ample, its toric variety XP can be embedded in P3 . The defining
equation, up to reordering the variables, is x31 − x0 x2 x3 = 0. This surface, in the chart
x0 + x1 + x2 + x3 6= 0 is shown on the left side of Figure 12. Its three singular points
correspond to the vertices of P . They are the torus fixed points from Proposition 2.50. 
37

Figure 12: The surface x31 − x0 x2 x3 = 0 is the toric variety of a singular triangle.

4

Abstract toric varieties

In previous sections, we have defined normal toric varieties from cones and polytopes. A
more general class of toric varieties comes from fans. To a fan Σ we will associate an abstract
toric variety XΣ . The construction generalizes σ 7→ Uσ and P 7→ ΣP 7→ XP , where the fans
are σ and all its faces, and the normal fan of P respectively. We recall how abstract varieties
are obtained from gluing affine varieties before explaining the construction. Next, we discuss
the orbit-cone correspondence, which tells us that XΣ is stratified by torus orbits in a way
that is nicely encoded by Σ. Finally, we study toric morphisms in this general setting.

4.1

Gluing affine varieties

Much of the material in this section is taken from [30, Sec. 2.3]. Consider a set {Yi }i∈J of
affine varieties for some index set J , such that for all i, j ∈ J , we have isomorphic Zariski
open subsets Yij ⊂ Yi , Yji ⊂ Yj . Let {φij }i,j∈J be isomorphisms such that for all i, j, k ∈ J ,
1. φij : Yij → Yji and φji : Yji → Yij satisfy φij ◦ φji = idYji , φji ◦ φij = idYij ,
2. φij (Yij ∩ Yik ) = Yji ∩ Yjk ,
3. φik = φjk ◦ φij on Yik ∩ Yij .
F
The disjoint union i∈J Yi is the set
X̂ =

G

Yi = {(x, Yi ) | i ∈ J , x ∈ Yi }.

i∈J

It is a topological space with the disjoint union topology, which is such that the open subsets
of X̂ are disjoint unions of open subsets in the Yi . We define an equivalence relation ∼ on X̂
by setting (x, Yi ) ∼ (y, Yj ) if x ∈ Yij , y ∈ Yji and φij (x) = y. The first condition on the φij
38

makes ∼ reflexive and symmetric, the second and third conditions make it transitive. We
consider the quotient space X = X̂/ ∼ with its quotient topology, called the Zariski topology
on X. In this topological space,
Ui = {[(x, Yi )] | x ∈ Yi } ⊂ X
are open subsets isomorphic to Yi (here we write [·] for an equivalence class in the quotient).
The space X is called an abstract variety. The affine varieties {Yi }i∈J and the isomorphisms
{φij }i,j∈J are called the gluing data for the construction of X.
Example 4.1 (Gluing of P1 ). The projective line P1 is covered by P1 = Ux ∪ Uy where
Ux = {(x : y) ∈ P1 | x 6= 0},

Uy = {(x : y) ∈ P1 | y 6= 0}.

Consider the isomorphisms
hx : Ux → Ct

and hy : Uy → Cu ,

where Ct is C with coordinate t and analogously for u, given by hx (x : y) = y/x and
hy (x : y) = x/y. For a point (x : y) ∈ Ux ∩ Uy , we have hx (x : y) = hy (x : y)−1 . Let
Ctu = C∗t = Ct \ {0},

Cut = C∗u = Cu \ {0}

and φtu : Ctu → Cut given by φtu (t) = t−1 , φut = φ−1
tu . This gives a commutative diagram
hx

Ux ∩ Uy

Ctu

φut
hy

φtu

Cut
The projective line P1 is a gluing of two copies of C with gluing data {Ct , Cu } and {φtu , φut }.
The two affine lines Ct and Cu are glued together along the open subsets C∗t and C∗u , which
give the open subset Ux ∩ Uy ⊂ P1 . The missing points P1 \ (Ux ∩ Uy ) = {(1 : 0), (0 : 1)}
correspond to the origin in Ct and Cu . If we consider P1 as the compactification of Ct , the
point at infinity corresponds to the origin in Cu . This is illustrated in Figure 13.

Example 4.2 (A non-separated variant). We replace the isomorphisms in the glueing data
from Example 4.1 by φtu (t) = t and φut (u) = u. This way, we obtain an abstract variety X
that, like P1 , is a union of C∗ and two points. This is illustrated in Figure 14. However, this
variety is not separated, meaning that the classical topology on X is not Hausdorff. We will
see that such situations never occur in our gluing construction for toric varieties.

Example 4.3 (Gluing of P2 ). We glue P2 from three copies of C2 . Consider the isomorphisms
hx : Ux → C2t , hy : Uy → C2u , and hz : Uz → C2v
39

−→

Figure 13: Illustration of the construction of P1 as the gluing of two affine lines.
The affine lines are represented as circles with a missing point (‘at infinity’). The
origin in each line is indicated with a black dot and the gluing isomorphism is
illustrated by black line segments.
−→
Figure 14: A non-separated variety obtained from gluing two affine lines.
where C2t is the affine plane with coordinates t1 , t2 (analogously for u, v) and
hx (x : y : z) = (y/x, z/x), hy (x : y : z) = (x/y, z/y), hz (x : y : z) = (x/z, y/z).
The gluing morphisms φtv = φ−1
vt come from identifying the images of points in Ux ∩ Uz under
2
2
hx and hz , e.g. on Ctv = Ct \ V (t2 )
 x y   z −1  y   z −1 
−1
−1
,
=
φtv (t1 , t2 ) = (t2 , t1 t2 ) comes from
,
. 
z z
x
x
x
Let X1 = ∪i∈J Ui and X2 = ∪j∈J 0 Uj0 be abstract varieties. A morphism Φ : X1 → X2 is
a Zariski continuous map such that
Φ|Ui ∩Φ−1 (Uj0 ) : Ui ∩ Φ−1 (Uj0 ) → Uj0
is a morphism of Zariski open subsets of affine varieties. We note that the product X1 ×X2 is
an abstract variety as well, obtained by glueing Ui × Uj0 in the appropriate way. An abstract
variety X is irreducible if it cannot be written as a union of two proper closed subvarieties.
It is called normal if each of the affine varieties Yi is normal.

4.2

Toric varieties from fans

We are now ready to state our third, last and most general definition of a toric variety.

40

Definition 4.4 (Toric variety). A toric variety is an irreducible abstract variety X containing a torus T ≃ (C∗ )n as a Zariski open subset, such that the action of T on itself extends
to an algebraic action T × X → X on X.
Here, by an algebraic action we mean that T ×X → X is a morphism of abstract varieties.
Note that affine toric varieties and projective toric varieties are toric varieties in this sense.
Recall that a fan Σ in NR is a collection of cones that fit together in a nice way (Definition
3.42). We fix such a fan Σ in NR . We now explain how this encodes the gluing data for
constructing a toric variety XΣ . Recall that each m ∈ MR gives a hyperplane Hm = {u ∈
NR | hu, mi = 0}. Here are two facts we will need in the construction:
(i) Faces of σ give affine open subsets of Uσ . If τ  σ, Uτ ≃ (Uσ )χm ⊂ Uσ , where m ∈ M
is such that τ = Hm ∩ σ. See Example 2.65.
(ii) Common faces give common affine open subsets. Let τ = σ1 ∩ σ2 . There exists
m ∈ σ1∨ ∩ (−σ2∨ ) ∩ M such that σ1 ∩ Hm = τ = σ2 ∩ Hm . It follows that
Uσ1 ⊇ (Uσ1 )χm ≃ Uτ ≃ (Uσ2 )χ−m ⊂ Uσ2 .
The second item is [12, Lem. 1.2.13]. The gluing data for XΣ are
1. the collection of normal affine toric varieties {Uσ }σ∈Σ and
2. for each pair of cones σ1 , σ2 ∈ Σ, an isomorphism
φσ1 ,σ2 : Uσ1 ,σ2 = (Uσ1 )χm → Uσ2 ,σ1 = (Uσ2 )χ−m

given by (Uσ1 )χm ≃ Uτ ≃ (Uσ2 )χ−m .

Here τ = σ1 ∩ σ2 and m is as in item (ii) above.
Theorem 4.5. Let Σ be a fan in NR . The abstract variety XΣ obtained from the above
gluing data is a normal toric variety.
Proof. By Definition 3.42, each σ ∈ Σ is strongly convex. Therefore, {0} is a face of each
cone, and hence T ≃ (C∗ )n = Specm(C[M ]) = U{0} ⊂ Uσ for each σ ∈ Σ. These tori
are identified by the gluing, so that XΣ is irreducible and T ⊂ XΣ a Zariski open subset.
The actions T × Uσ → Uσ are compatible on overlaps (this is easily seen from the intrinsic
description of the torus action from Proposition 2.49), and therefore glue to a morphism
T × XΣ → XΣ . Normality follows from Theorem 2.55.
S
S
Remark 4.6. Since Uτ ⊂ Uσ when τ  σ, we have that XΣ = σ∈Σ Uσ = σ maximal Uσ is
covered by the maximal cones in Σ (with respect to inclusion).
We state, without proof, that this construction never leads to non-separated abstract
varieties, such as X from Example 4.2. See [12, Exer. 3.1.2]. Moreover, it turns out every
normal, separated toric variety arises in this way [12, Cor. 3.1.8].
Theorem 4.7. Let X be a normal, separated toric variety with torus T = N ⊗Z C∗ . There
exists a fan Σ in NR such that X ≃ XΣ .
41

Example 4.8. If σ ⊂ NR is a strongly convex rational polyhedral cone and Σ is the fan
consisting of σ and all its faces, we have XΣ = Uσ .

Example 4.9. Let P be a full-dimensional polytope in MR and let ΣP be its normal fan.
Then XP ≃ XΣP .

Example 4.10. If N = Z, there are only three cones in NR : τ = {0}, σ1 = R≤0 , σ2 = R≥0 .
By Theorem 4.7, there are only three one-dimensional normal separated toric varieties:
1. Σ = {τ }, XΣ = C∗ ,
2. Σ = {σi , τ }, i = 1 or 2, XΣ = C.
3. Σ = {τ, σ1 , σ2 }, XΣ = P1 .
In the latter case, Σ is the normal fan of a line segment P = Conv(0, 1), and P1 ≃ XP .



Example 4.11. We revisit the gluing of P2 from a toric point of view. Consider the fan
shown in Figure 15. Let σ1 , σ2 , σ3 be the 2-dimensional cones of Σ. We have

σ3
σ1

σ2

Figure 15: The fan of P2 .
Uσ3 = Specm(C[t1 , t2 ]),

−1
Uσ1 = Specm(C[t−1
1 , t1 t2 ]),

−1
Uσ2 = Specm(C[t−1
2 , t1 t2 ]).

This is most easily seen from the dual cones in Figure 8. Each of these is isomorphic
to C2 . Let τ = σ3 ∩ σ2 . We have Uτ = Specm(C[t1 , t2 , t−1
2 ]) ≃ Specm(C[t1 , t2 ]t2 ) ≃
−1
−1
−1
−1
with C[v1 , v2 ]v1 , induces an isomorphism
Specm(C[t2 , t1 t2 ]t−1
). Identifying C[t2 , t1 t2 ]t−1
2
2
−1
of C-algebras C[v1 , v2 ]v1 → C[t1 , t2 ]t2 sending v1 7→ t−1
2 and v2 7→ t1 t2 . This is the pullback
of φtv in Example 4.3. The gluing of the other charts is similar. We conclude that XΣ = P2 .
Note that Σ is the normal fan of the standard simplex ∆2 = Conv(0, e1 , e2 ) ⊂ R2 . Hence
X∆2 ≃ P2 , which is obvious from X∆2 ≃ X∆2 ∩Z2 (Definition 3.51).

Example 4.12. We consider the fan Σ from Figure 16. Note that it is not the normal fan of
a polytope. By Remark 4.6, XΣ is covered by Uσ1 ≃ {w − uv = 0} ⊂ C3 , Uσ2 ≃ {z − xy =
0} ⊂ C3 These overlap in XΣ on (Uσ1 )v and (Uσ2 )x . The isomorphism comes from
(C[x, y, z]/hz − xyi)[x] → (C[u, v, w]/hw − uvi)[v]
42

σ2
σ1

Figure 16: The fan of Bl0 (C2 ).
given by x 7→ v −1 , y 7→ w, z 7→ u. To see to compute this morphism in coordinates, see
Example 4.18 below. We conclude that XΣ = {x0 z − x1 y = 0} = Bl0 (C2 ) ⊂ P1 × C2 .

Exercise 4.13. Show that P1 × P1 is the toric surface XΣ where Σ is the normal fan of the
square [0, 1] × [0, 1] ⊂ R2 , shown in Figure 18..
The following result says that the construction of a toric variety from a fan behaves well
under taking products. Here is the precise statement [12, Prop. 3.1.14].
Proposition 4.14. Let Σi be a fan in (Ni )R , i = 1, 2. The set of cones
Σ1 × Σ2 = {σ1 × σ2 | σi ∈ Σi }
is a fan in (N1 )R × (N2 )R = (N1 × N2 )R and XΣ1 ×Σ2 ≃ XΣ1 × XΣ2 .
Corollary 4.15. Let P1 ⊂ (M1 )R and P2 ⊂ (M2 )R be full-dimensional polytopes and let
P1 × P2 be the product in (M1 × M2 )R . We have XP1 ×P2 ≃ XP1 × XP2 .
Proof. This follows from Proposition 4.14 and the observation that the normal fans satisfy
ΣP1 ×P2 = ΣP1 × ΣP2 .
Example 4.16. We have seen that P1 is the toric variety of a line segment (Example 4.10)
and P1 × P1 comes from a square (Exercise 4.13), i.e. the product of two line segments. 
We now discuss some properties of XΣ that can be read off the fan Σ. We repeat that a
fan Σ in NR is called smooth if all of its cones are smooth. S
It is called simplicial if all of its
cones are simplicial, and Σ is complete if its support |Σ| = σ∈Σ σ equals NR .
Theorem 4.17. Let Σ be a fan in NR . The toric variety XΣ is
1. smooth if and only if Σ is smooth,
2. compact in the classical topology if and only if Σ is complete,
3. an orbifold (i.e. it has only finite quotient singularities) if and only if Σ is simplicial.
43

Proof. This is Theorem 3.1.19 in [12]. We point out that item 1 is easy to prove, since
smoothness is defined locally. As a hint for point 3, let σ ⊂ NR be a simplicial, fulldimensional cone with minimal ray generators u1 , . . . , un . The lattice N1 = Z · {u1 , . . . , un }
has finite index in N . As in Example 2.67, it follows that Uσ,N is the quotient of the smooth
affine toric variety Uσ,N1 by the action of a finite group. Hence, if Σ is simplicial, XΣ locally
looks like the quotient of a smooth variety by the action of a finite group. This means that
it has only finite quotient singularities, so it is an orbifold.
A toric variety satisfying condition 3 in Theorem 4.17 is called simplicial. This will be
important in our discussion of quotient constructions later.
Example* 4.18. Consider the fan Σ in R2 whose rays have generators u1 = (1, 2), u2 =
(1, 0), u3 = (−3, −2), u4 = (0, 1). The surface XΣ can be embedded in P88 via the 89 lattice
points of the polygon P = Conv((0, 15), (0, 1), (2, 0), (10, 0)) with normal fan Σ.
P = convex_hull([0 15; 0 1; 2 0; 10 0]); Σ = normal_fan(P);
X_Σ = NormalToricVariety(Σ)

1
2

It is covered by 4 normal affine toric surfaces Uσ12 , Uσ23 , Uσ34 , Uσ14 where σij = Cone(ui , uj ).
Out of these, only U14 is smooth. Here is how to check this in Oscar.jl.
cover = affine_open_covering(X_Σ);
[issmooth(U) for U in cover]

1
2

This returns a boolean vector [0;0;1;0]. We embed Uσ12 and Uσ23 in affine space and
determine φσ12 ,σ23 in coordinates. With Oscar.jl we compute the hilbert basis of the
∨
∨
. These provide the embeddings
, σ23
two cones σ12
Uσ12 ≃ Y12 = {xz − y 2 = 0} ⊂ C3 ,

Uσ23 ≃ Y23 = {uw − v 2 = 0} ⊂ C3 .

The coordinates x, y, z correspond to the blue marked lattice points in Figure 17, ordered
from left to right. Similarly, u, v, w correspond to the green squares. The overlap U12 ∩ U23 ⊂
XΣ is given by points on Y12 with x 6= 0, and points on Y23 with u 6= 0. On these open sets,
 


1 y y2
1 y z
φσ12 ,σ23 (x, y, z) =
, ,
=
, ,
.
x x2 x3
x x2 x2
∨
∨
This map can be obtained from the cones σ12
, σ23
, writing the green lattice points in Figure
17 as Z-linear combinations of the blue ones.


4.3

Limits of one-parameter subgroups

If X is a separated, normal abstract toric variety with torus T = N ⊗Z C∗ , Theorem 4.7
implies that X ≃ XΣ for some polyhedral fan Σ in NR . In this section we will see that this
fan can be recovered from limits of monomial curves limt→0 λu (t). We start with an example.
44

∨
σ12

∨
σ23
∨
∨
Figure 17: The Hilbert bases of σ12
and σ23
give the isomorphism φσ12 ,σ23 .

Example 4.19. Let X = P1 × P1 . We have seen that X = XΣ where Σ is the fan in Figure
18 (Exercise 4.13). Its torus is T = {(1 : t1 ) × (1 : t2 ) | (t1 , t2 ) ∈ (C∗ )2 } ≃ (C∗ )2 , with
cocharacter lattice N = Z2 . We fix u = (a, b) ∈ N and consider the curves λu (t) = (1 :
ta ) × (1 : tb ) ∈ P1 × P1 . The limit limt→0 λu (t) depends on u. There are nine possibilities:
1. limt→0 λu (t) = (1 : 1) × (1 : 1) when a = 0, b = 0,
2. limt→0 λu (t) = (1 : 0) × (1 : 1) when a > 0, b = 0,
3. limt→0 λu (t) = (1 : 1) × (1 : 0) when a = 0, b > 0,
4. limt→0 λu (t) = (0 : 1) × (1 : 1) when a < 0, b = 0,
5. limt→0 λu (t) = (1 : 1) × (0 : 1) when a = 0, b < 0,
6. limt→0 λu (t) = (1 : 0) × (1 : 0) when a > 0, b > 0,
7. limt→0 λu (t) = (0 : 1) × (1 : 0) when a < 0, b > 0,
8. limt→0 λu (t) = (0 : 1) × (0 : 1) when a < 0, b < 0,
9. limt→0 λu (t) = (1 : 0) × (0 : 1) when a > 0, b < 0.
These correspond to the relative interiors of the 9 cones of Σ. For instance, if u lies on the
positive a-axis, which is the relative interior of the one-dimensional cone σ = Cone((1, 0)) ∈
Σ, then limt→0 λu (t) = (1 : 0) × (1 : 1). Below, we will call this limit point γσ , and in the
orbit-cone correspondence, we will associate the torus orbit T · γσ to σ.

Let σ be a strongly convex rational cone in NR ≃ Rn . Recall that points of Uσ are
semigroup homomorphisms γ : Sσ → C.
Definition 4.20 (Distinguished point). The distinguished point of the affine toric variety
Uσ is the semigroup homomorphism
(
1 m ∈ Sσ ∩ σ ⊥
γσ : m ∈ Sσ 7−→
0 otherwise.
45

Figure 18: The fan of P1 × P1 .
One can check that γσ is indeed a semigroup homomorphism. By Proposition 2.50, γσ
is fixed under the torus action if and only if dim σ = n, in which case σ ⊥ = {0}. Note
that when τ  σ is a face of σ, γτ ∈ Uσ since Uτ ⊂ Uσ . The point γτ is a semigroup
homomorphism Sτ → C. Viewed as a point in Uσ , it is the restriction of γτ to Sσ ⊂ Sτ .
Proposition 4.21. Let σ be a strongly convex rational cone in NR and u ∈ N . We have
that u ∈ σ if and only if the limit limt→0 λu (t) exists in Uσ . Moreover, if u lies in the relative
interior of σ, we have limt→0 λu (t) = γσ .
Proof. The limit limt→0 λu (t) exists in Uσ if and only if
lim χm (λu (t)) exists in C for all m ∈ σ ∨ ∩ M ⇐⇒ lim thu,mi exists in C for all m ∈ σ ∨ ∩ M
t→0

t→0

⇐⇒hu, mi ≥ 0 for all m ∈ σ ∨
⇐⇒u ∈ (σ ∨ )∨ = σ.
If u ∈ σ lies in the relative interior of σ, limt→0 λu (t) is the semigroup homomorphism that
sends m 7→ limt→0 thu,mi . This coincides with γσ , since hu, mi ≥ 0 and equality holds if and
only if m ∈ σ ⊥ ∩ M ⊂ σ ∨ ∩ M = Sσ .
Proposition 4.21 justifies our claim that Σ can be recovered from limits of one-parameter
subgroups in XΣ .
Exercise 4.22. Repeat Example 4.19 for X = P2 . Write down the distinguished points in
their homogeneous coordinates and associate them to the cones of the fan Σ in Figure 15.

4.4

Orbit-cone correspondence

Let Σ be a fan in NR . In this section, our goal is to show that the cones σ in Σ correspond
to orbits O(σ) of the torus action T × XΣ → XΣ . These orbits stratify XΣ , and inclusion
relations O(σ) ⊂ O(τ ) of closed strata correspond to the reversed face relations τ  σ.

46

For a cone σ ∈ Σ, we define O(σ) = T · γσ ⊂ Uσ ⊂ XΣ . These orbits are themselves
tori. We first identify their lattices. Let Nσ = Z · (σ ∩ N ) and N (σ) = N/Nσ . The dual
N (σ)∨ = HomZ (N (σ), Z) is the group σ ⊥ ∩ M . Therefore
HomZ (σ ⊥ ∩ M, C∗ ) ≃ TN (σ) ,
where TN (σ) = N (σ) ⊗Z C∗ is the torus with cocharacter lattice N (σ). Explicitly, if [u] is
the class of u ∈ N in N (σ), a point [u] ⊗ t ∈ TN (σ) gives the homomorphism of groups
σ ⊥ ∩ M → C∗ given by m 7→ χm (λu (t)) = thu,mi .
Lemma 4.23. Let σ ⊂ NR be a strongly convex rational cone. We have
O(σ) = {γ : Sσ → C | γ(m) 6= 0 ⇔ m ∈ σ ⊥ ∩ M } ≃ HomZ (σ ⊥ ∩ M, C∗ ) ≃ TN (σ) .
Proof. Let O0 = {γ : Sσ → C | γ(m) 6= 0 ⇔ m ∈ σ ⊥ ∩ M }. We establish the isomorphism O0 ≃ HomZ (σ ⊥ ∩ M, C∗ ). If γ ∈ O0 , then γ̂ = γ|σ⊥ ∩M : σ ⊥ ∩ M → C∗ is a group
homomorphism. Conversely, if γ̂ : σ ⊥ → C∗ is a group homomorphism, then
(
γ̂(m) m ∈ σ ⊥ ∩ M
γ : Sσ → C given by γ(m) =
0
otherwise
is an element of O(σ). This defines the inverse of γ 7→ γ̂, which establishes the isomorphism.
It remains to show that O0 = O(σ). Clearly γσ ∈ O0 . Also, by (t · γ)(m) = χm (t)γ(m)
we see that O0 is T -invariant. We conclude O(σ) ⊂ O0 . It remains to show that T acts
transitively on O0 . This follows from tensoring the exact sequence N → N (σ) → 0 with C∗ ,
which gives T → TN (σ) → 1. Hence T acts transitively on TN (σ) . This action is compatible
with TN (σ) ≃ HomZ (σ ⊥ ∩ M, C∗ ) ≃ O0 . We encourage the reader to check this.
We are now ready to state the main result of this section.
Theorem 4.24 (The orbit-cone correspondence). Let XΣ be the toric variety of a fan Σ in
NR ≃ Rn , with dense torus T .
1. The map σ 7→ O(σ) is a bijection of { cones σ ∈ Σ } and { T -orbits in XΣ }.
2. For each σ ∈ Σ, dim σ + dim O(σ) = n.
3. The affine open subset Uσ is the disjoint union of orbits Uσ =

F

τ σ O(τ ).

F
4. We have τ  σ if and only if O(σ) ⊂ O(τ ) and O(τ ) = τ σ O(σ). This holds for the
closure in XΣ in both the Zariski topology and the classical topology.
Proof. 1. Let O ⊂ XΣ be a T -orbit. Since XΣ is covered by the T -invariant affine toric
varieties Uσ , σ ∈ Σ, there is a minimal cone σ (with respect to inclusion) such that O ⊂ Uσ .
Point 1 will follow from O = O(σ). For γ ∈ O, there is a face τ  σ for which
{m ∈ Sσ | γ(m) 6= 0} = σ ∨ ∩ τ ⊥ ∩ M.
47

This means that γ extends to a semigroup homomorphism Sτ → C, and hence O ⊂ Uτ ,
which implies τ = σ by minimality of σ. Then O = O(σ) by Lemma 4.23.
2. This is a straightforward consequence of Lemma 4.23.
3. Since Uσ is T -invariant, it is a disjoint union of orbits. If τ  σ, we have O(τ ) ⊂ Uτ ⊂
Uσ . The proof of part 1 implies that any orbit O ⊂ Uσ is O(τ ) for some face τ  σ.
4. We show that τ  σ if and only if O(σ) ⊂ O(τ ) in the classical topology. For the
‘only if’ direction, note that O(τ ) is T -invariant by continuity of T × O(τ ) → O(τ ). Hence,
it suffices to show that O(τ ) ∩ O(σ) 6= ∅. We prove this using limits of one-parameter
subgroups. Pick u ∈ σ in the relative interior of σ and define γ(t) = λu (t) · γτ . For t ∈ C∗ ,
this semigroup homomorphism in O(τ ) ⊂ Uσ sends m ∈ Sσ to thu,mi γτ (m). Therefore,
limt→0 γ(t) sends m ∈ (σ ∨ \ σ ⊥ ) ∩ M to 0, and m ∈ σ ⊥ ∩ M to γτ (m) = 1, since σ ⊥ ⊂ τ ⊥ .
Hence γ(0) = limt→0 γ(t) = γσ ∈ O(σ) and by construction γ(0) ∈ O(τ ).
For the ‘if’ direction, suppose that O(σ) ⊂ O(τ ). This implies O(τ ) ⊂ Uσ . Indeed,
otherwise Uσ ∩ O(τ ) = ∅ (Uσ is T -invariant), but then Uσ ∩ O(τ ) = ∅ (XΣ \ Uσ is closed and
contains O(τ ), so it must contain O(τ )). By part 1, O(τ ) ⊂ Uσ implies τ  σ. For the proof
of point 4 in the Zariski topology, see [12, Thm. 3.2.6].
Note that, as a particular case of part 4 of Theorem 4.24, for τ = {0} we have
G
XΣ =
O(σ).
σ∈Σ

We reiterate that the cones σ ∈ Σ give an affine open covering, as well as a stratification of
XΣ . A cone σ ∈ Σ corresponds to
1. an affine open subset Uσ of dimension n and
2. a torus orbit O(σ) ⊂ Uσ of dimension n − dim(σ).
In case XΣ ≃ XP is the toric variety of the full-dimensional polytope P ⊂ Rn , cones of
σ also correspond to faces of P . By Theorem 4.24, this means that torus orbits correspond
to faces of P . Moreover, the face Fσ of an orbit O(σ) has the same dimension dim O(σ) =
n − dim(σ), and Fσ ⊂ Fτ ⇐⇒ τ  σ ⇐⇒ O(σ) ⊂ O(τ ).
Example 4.25. The surface P1 × P1 is XP , where P = [0, 1]2 ⊂ R2 is the square. Figure
19 illustrates the orbit-cone(-face) correspondence. The vertices of P correspond to the fulldimensional cones (blue), and to the torus fixed points. Two such points are connected by
a one-dimensional orbit if they lie on an edge of P (orange). All orbits lie in the closure of
the dense orbit corresponding σ = {0}, and therefore to the ‘dense’ face of P (purple).

Exercise 4.26. Repeat Example 4.25 for XP = P2 . Note that, because our convention is
to use inward pointing facet normals, we usually get a rotated version of P in pictures like
Figure 19. This is not seen in Figure 19 because of symmetry.
Example 4.27. By Theorem 4.24, if we remove cones from the fan Σ to obtain a new fan Σ0 ,
we obtain XΣ0 by removing the corresponding torus orbits from XΣ . For instance, C2 = XΣ
where Σ is the nonnegative quadrant and all its faces. Removing the 2-dimensional cone, we
see that C2 \ {0} is the toric variety of the fan Σ0 = {{0}, Cone((1, 0)), Cone((0, 1))}.

48

Figure 19: Faces of P correspond to torus orbits of XP : an illustration for P1 ×P1 .

4.5

Orbit closures as toric varieties

Following [12], we introduce the notation V (τ ) = O(τ ) for the orbit closures. We now
characterize V (τ ) as a normal toric variety. We have seen in the previous section that the
dense open subset O(τ ) ≃ TN (τ ) of V (τ ) is a torus. Moreover, The T -orbits in
G
V (τ ) =
O(σ)
τ σ

can be viewed as TN (τ ) -orbits via the commuting diagram
T × O(σ)

O(σ)
.
TN (τ ) × O(σ)

Here the diagonal arrow sends (u ⊗ t) × p ∈ (N ⊗Z C∗ ) × O(σ) ≃ T × O(σ) to ([u] ⊗ t) × p,
where [u] is the class of u in N (τ ) = N/Nτ . The following is [12, Exer. 3.2.7, Prop. 3.2.7].
Proposition 4.28. Let σ be the image of σ ∈ Σ under NR → N (τ )R . Consider the collection
of cones Star(τ ) = {σ ⊂ N (τ )R | τ  σ ∈ Σ}. The set Star(τ ) is a fan in N (τ )R and
V (τ ) = O(τ ) = XStar(τ ) .
Example 4.29. Let τ be the ray R≥0 · (1, 1) of the fan from Example 4.12. The closure
V (τ ) of the corresponding one-dimensional torus orbit has cocharacter lattice N (τ ) ≃ Z,
and its fan in N (τ )R ≃ R is complete. This is illustrated in Figure 20. By Example 4.10
and Proposition 4.28, V (τ ) ≃ P1 . This is the exceptional divisor of Bl0 (C2 ).

Proposition 4.28 has the following corollary in the case where XΣ ≃ XP .
Proposition 4.30. If Σ = ΣP is the normal fan of a full-dimensional polytope P ⊂ MR ,
then torus orbits correspond to faces Q  P and V (σQ ) ≃ XQ , where Q is considered as a
full-dimensional polytope in its affine span.
49

τ

Figure 20: The exceptional divisor in Bl0 (C2 ) is the toric variety V (τ ).

Exercise 4.31. Consider the triangular prism P shown
on the left. Show that XP ≃ P2 × P1 . Check that XP
has five two-dimensional torus orbits, whose closures
are isomorphic to either P2 or P1 × P1 . Describe these
orbits in homogeneous coordinates.

4.6

Toric morphisms

In this section, we study toric morphisms between abstract toric varieties.
Definition 4.32 (Toric morphism). Let XΣ1 , XΣ2 be normal toric varieties, with dense tori
T1 , T2 respectively. A morphism φ : XΣ1 → XΣ2 is called toric if φ(T1 ) ⊂ T2 and φ|T1 is a
group homomorphism.
A morphism φ : XΣ1 → XΣ2 is called equivariant if φ(t·p) = φ(t)·φ(p) for t ∈ T1 , p ∈ XΣ1 .
Proposition 4.33. Toric morphisms φ : XΣ1 → XΣ2 are equivariant.
Proof. The proof is identical to that of Proposition 2.62.
Similar to what we saw in Proposition 2.64, it turns out that all toric morphisms between
toric varieties correspond to linear maps that respect their fans. We now make this precise.
Definition 4.34 (Compatible). Let Σi be a fan in (Ni )R for i = 1, 2. A Z-linear map
φ : N1 → N2 is compatible with Σ1 , Σ2 if for each σ1 ∈ Σ1 , there is σ2 ∈ Σ2 such that
φR (σ1 ) ⊂ σ2 . Here, we used some notation from Section 2.10.
Example 4.35. Consider the fan Σ1 in R2 shown in Figure 21 and the complete fan Σ2 in
R. The varieties XΣ1 and XΣ2 are a Hirzebruch surface and P1 respectively. The coordinate
projection φ(x, y) = x is compatible with Σ1 , Σ2 . The orange and the yellow cone of Σ1 , as
well as all their faces, are mapped into σ1 . The blue and purple cones are mapped into σ2 .
The other coordinate projection φ(x, y) = y is not compatible with Σ1 , Σ2 , as the image of
the yellow cone is not contained in any of the cones of Σ2 .

50

σ1

σ2

Figure 21: A compatible and a non-compatible projection of the fan of a Hirzebruch surface.
S
Definition 4.36 (Glued morphisms). Let X = i Ui and Y be varieties, and let φi : Ui → Y
be morphisms. A morphism φ : X → Y is said to be glued from the φi if φ|Ui = φi for all i.
Lemma 4.37. Let X, Y, Ui , φi be as in Definition 4.36. A morphism φ : X → Y glued from
φi exists if and only if (φi )|Ui ∩Uj = (φj )|Ui ∩Uj for all i, j.
The proof of Lemma 4.37 is left as an exercise [12, Exer. 3.3.1]. We are now ready to
state the main result of this section.
Theorem 4.38. Let Σi be a fan in (Ni )R , i = 1, 2 and let XΣ1 , XΣ2 be the corresponding
toric varieties with dense tori T1 and T2 respectively.
1. If φ : N1 → N2 is a Z-linear map that is compatible with Σ1 , Σ2 , then there is a toric
morphism φ : XΣ1 → XΣ2 satisfying φ|T1 = φ ⊗ id : u ⊗ t 7−→ φ(u) ⊗ t ∈ T2 .
2. If φ : XΣ1 → XΣ2 is a toric morphism, then φ induces a Z-linear map φ : N1 → N2 ,
compatible with Σ1 , Σ2 , such that φ|T1 = φ ⊗ id.
Proof. 1. Fix σ1 ∈ Σ1 . By compatibility, there is a cone σ2 ∈ Σ2 such that φ(σ1 ) ⊂ σ2 .
By Proposition 2.64, φ induces a morphism φσ1 : Uσ1 → Uσ2 . If φ is given by a n2 × n1
integer matrix F , φσ1 comes from φb : m 7→ F > m. The maps {φσ1 }σ1 ∈Σ1 agree on overlaps,
so by Lemma 4.37, they glue to φ : XΣ1 → XΣ2 . The glued morphism φ is toric since
φ{0} : T1 → T2 is the group homomorphism φ ⊗ id : N1 ⊗Z C∗ → N2 ⊗Z C∗ . In coordinates,
this is given by t 7→ (tFi,: )i=1,...,n2 , see Example 2.63.
2. By definition, φ|T1 is a group homomorphism. It induces φ : N1 → N2 by sending
u ∈ N1 to the cocharacter φ|T1 ◦ λu : C∗ → T2 . Since φ is equivariant, it sends the orbit O(σ1 )
into an orbit O(σ2 ), where σi ∈ Σi . By Proposition 2.64, to show that φR (σ1 ) ⊂ σ2 , it suffices
to
F show that φ(Uσ1 ) ⊂ Uσ2 . By the orbit-cone correspondence (Theorem 4.24), we have Uσi =
τi σi O(τi ), i = 1, 2. We need to show that for each τ1  σ1 , φ(O(τ1 )) ⊂ O(τ2 ) for some
face τ2  σ2 . Let τ2 be such that φ(O(τ1 )) ⊂ O(τ2 ). By Theorem 4.24, O(σ1 ) ⊂ O(τ1 ). Since
φ is continuous, we have φ(O(τ1 )) ⊂ O(τ2 ). We conclude that φ(O(σ1 )) ⊂ O(σ2 ) ∩ O(τ2 ),
and since O(τ2 ) is torus invariant, we must have O(σ2 ) ⊂ O(τ2 ), which implies τ2  σ2 by
the orbit-cone correspondence.
51

Example 4.39. Let Ni = Z2 , i = 1, 2 and φ : u 7→ ` · u. This is compatible
with Σ1 =

` 0
, so that φ|(C∗ )2 is
Σ2 = ΣP2 (the fan in Figure 15). The matrix representing φ is F =
0 `
(t1 , t2 ) 7→ (t`1 , t`2 ). Globally, φ is given by φ((x0 : x1 : x2 )) = (x`0 : x`1 : x`2 ).

Exercise 4.40. Let φ : XΣ1 → P1 be the toric morphism corresonding to the compatible
coordinate projection from Example 4.35. Embed XΣ1 in projective space and compute the
map φ in homogeneous coordinates.
The correspondence between cones of Σ1 and Σ2 induced by the compatible map φ : N1 →
N2 mirrors a correspondence of torus orbits of XΣ1 and XΣ2 induced by φ : XΣ1 → XΣ2 .
Here is the precise statement, which uses some notation from Definition 4.20.
Lemma 4.41. Let φ : XΣ1 → XΣ2 be the toric morphism coming from φ : N1 → N2 . Given
σ1 ∈ Σ1 , let σ2 ∈ Σ2 be the minimal cone such that φR (σ1 ) ⊂ σ2 . We have
(a) φ(γσ1 ) = γσ2 ,
(b) φ(O(σ1 )) ⊂ O(σ2 ) and φ(V (σ1 )) ⊂ V (σ2 ),
(c) φ|V (σ1 ) : V (σ1 ) → V (σ2 ) is a toric morphism.
Proof. (a) If u is in the relative interior of σ1 , φ(u) is in the relative interior of σ2 . This
follows from minimality of σ2 . Therefore, using Proposition 4.21,


u
φ(γσ1 ) = φ lim λ (t) = lim φ(λu (t)) = lim λφ(u) (t) = γσ2 .
t→0

t→0

t→0

Point (b) follows directly from (a), as φ is equivariant (Proposition 4.33) and continuous.
By equivariance, φ|O(σ1 ) : O(σ1 ) → O(σ2 ) is a group homomorphism, which implies (c).
As applications of toric morphisms, we discuss quotients arising from sublattices of finite
index, torus factors, and blow-ups from refinements.
4.6.1

Sublattices of finite index

The observation in Example 2.67 is an instance of the following statement [12, Prop. 3.3.7].
Proposition 4.42. Let N 0 ⊂ N be a sublattice of finite index. Let Σ be a fan in (N 0 )R = NR
and G = N/N 0 . Then φ : N 0 ,→ N is compatible with Σ, Σ and induces the toric morphism
φ : XΣ,N 0 → XΣ,N . The finite group G ≃ HomZ (G, C∗ ) ⊂ TN 0 acts on XΣ,N 0 . The morphism
φ is constant on G-orbits and presents XΣ,N as the quotient XΣ,N 0 /G.
The inclusion HomZ (G, C∗ ) ⊂ TN 0 ⊂ TN 0 can be seen from taking HomZ (−, C∗ ) of
0 −→ N 0 −→ N −→ N/N 0 −→ 0.

52

4.6.2

Torus factors

A variety X is said to have a torus factor if X ≃ X 0 × (C∗ )r for some r > 0. For toric
varieties, this happens when the rays of the fan span a lower dimensional space. The proof
is a nice application of Theorem 4.38.
Theorem 4.43. Let Σ be a fan in NR . The following are equivalent:
(a) XΣ has a torus factor.
(b) There is a non-constant morphism XΣ → C∗ .
(c) The rays ρ ∈ Σ(1) do not span NR .
Proof. (a) ⇒ (b). A non-constant morphism is obtained from composing the projection
XΣ → (C∗ )r with a non-constant character χm of (C∗ )r .
(b) ⇒ (c). If φ : XΣ → C∗ is a non-constant morphism, then φ|T : T → C∗ is nonconstant. Therefore, φ|T = c · χm for some c ∈ C∗ , m 6= 0. Multiplying by c−1 , we may
assume that φ|T = χm , and thus that φ is toric. The corresponding map φ is given by
φ(u) = hu, mi. Since φ is compatible with Σ and {0}, we have uρ ∈ ker φ, for all ρ ∈ Σ(1).
Therefore, the ray generators uρ are R-linearly dependent.
(c) ⇒ (a). See [12, Prop. 3.3.9].
4.6.3

Refinements

A fan Σ0 in NR is said to refine the fan Σ in NR if every cone of Σ0 is contained in a cone of
Σ, and the supports of Σ0 and Σ coincide: |Σ0 | = |Σ|. If Σ0 refines Σ, then the identity map
φ = id is compatible with Σ0 , Σ. This leads to toric morphisms that are blow-downs.
Example 4.44. The fan in Figure 16 refines the fan of C2 , i.e. the nonnegative quadrant
R2≥0 and all its faces. The corresponding toric morphism is the blow-down Bl0 (C2 ) → C2 . 
We now discuss how this generalizes. Let σ be an n-dimensional smooth cone of Σ. The
star subdivision Σ∗ (σ) of Σ along σ is given by Σ \ σ ∪ Σ0 (σ), where Σ0 (σ) is constructed
as follows. Let σ = Cone(u1 , . . . , un ), where the ui are primitive ray generators. Set u0 =
u1 + · · · + un . The fan Σ0 (σ) consists of all cones Cone(u0 , . . . , ûi , . . . , un ), i = 1, . . . , n, where
ûi indicates that ui is omitted, and their faces.
Proposition 4.45. The star subdivision Σ∗ (σ) of Σ along σ refines Σ, and the induced toric
morphism φ : XΣ∗ (σ) → XΣ makes XΣ∗ (σ) the blow-up of XΣ at the distinguished point γσ
(Definition 4.20).
Proof. We sketch the proof. For details, see [12, Prop. 3.3.15]. It is clear that Σ∗ (σ) refines
Σ. By restricting φ, we may assume that XΣ = Uσ . By Example 2.44, Uσ ≃ Cn . As in
Example 4.12, the gluing construction of XΣ∗ (σ) shows that XΣ∗ (σ) ≃ Bl0 (Cn ).

53

5

Divisors on toric varieties

In this section, we develop the theory of divisors on normal toric varieties. The discussion
features the groups of Weil divisors, Cartier divisors, principal divisors, the class group
and the Picard group of a toric variety. We will see how these groups have a very explicit
description in terms of the fan. We also discuss sheaves associated to divisors. Their global
sections will correspond to graded pieces of the Cox rings discussed in Section 6.

5.1

Background on divisors

Let X be an irreducible (abstract) variety. A prime divisor D ⊂ X is an irreducible subvariety of codimension 1. To a rationalP
function f ∈ C(X)∗ = C(X) \ {0}, we want to associate
a Z-linear combination of divisors
ai Di encoding the ‘order of vanishing of f along Di ’.
We will see that this works best when X is normal, which is one of the main reasons for our
emphasis on normal toric varieties.
For a prime divisor D ⊂ X, we define
OX,D = {f ∈ C(X) | f is defined on U, with U ∩ D 6= ∅}.
These are the rational functions defined somewhere on D, and therefore almost everywhere
on D. Since X is irreducible, if U ⊂ X is open and nonempty, we have C(X) = C(U ).
Moreover, if U ∩ D 6= ∅, OX,D = OU,U ∩D . Therefore, to describe OX,D we may assume that
X = Specm(R) is affine. In this case, we have
1:1

{ prime divisors of X } ←→ { codimension 1 prime ideals of R }.
If a prime divisor D ⊂ X corresponds to the prime ideal p ⊂ R, the ring OX,D is
o
ng
∈ K | g, h ∈ R, h ∈
/ p = Rp ,
OX,D =
h
where K is the field of fractions of R. This is a local ring with maximal ideal pRp . We state
the following commutative algebra result without proof. See [12, Sec. 4.0] for details.
Proposition 5.1. Let R be a normal domain and p ⊂ R a codimension one prime ideal
with prime divisor D = V (p) ⊂ X. There is a group homomorphism νD : K ∗ → Z such that
(i) νD (f + g) ≥ min(νD (f ), νD (g)), whenever f, g, f + g ∈ K ∗ ,
(ii) Rp = {f ∈ K ∗ | νD (f ) ≥ 0} ∪ {0}.
A homomorphism νD : K ∗ → Z satisfying (i) in Proposition 5.1 is called a discrete
valuation. The ring {f ∈ K ∗ | νD (f ) ≥ 0} ∪ {0} is the corresponding discrete valuation ring.
We now describe the map νD from Proposition 5.1 explicitly. If R, p, D are as in Proposition 5.1, Rp is a principal ideal domain and all its ideals are of the form hπ k i, where π is
a generator of the maximal ideal pRp . For f ∈ Rp \ {0} we have νD (f ) = k where k is the
largest integer for which f ∈ hπ k i. In particular, we indeed have
pRp = hπi = {f ∈ Rp | νD (f ) > 0} ∪ {0}.
54

If f ∈ K ∗ \ Rp , then νD (f ) = −k where k is the largest integer for which f −1 ∈ hπ k i.
We now formulate Proposition 5.1 in the general case where X is not necessarily affine.
Corollary 5.2. Let X be a normal variety and D ⊂ X a prime divisor. There is a discrete
valuation νD : C(X)∗ → Z with discrete valuation ring OX,D .
Proof. Choose an affine chart Specm(R) ⊂ X such that U ∩ D 6= ∅. Then C(X) = K is the
field of fractions of R, and OX,D = Rp for a prime ideal p. Now apply Proposition 5.1.
For a nonzero rational function f ∈ C(X)∗ , we say that f vanishes with order νD (f )
along D if νD (f ) > 0, or that f has a pole of order −νD (f ) along D if νD (f ) < 0.
Let Div(X) be the free
Pabelian group generated by the prime divisors on X. A Weil
divisor is an element E = D⊂X aD D of Div(X), where the sum is over all prime divisors D
on X. Only finitely many integer coefficients aD are allowed to be nonzero. A Weil divisor
E is effective if all coefficients are nonnegative. In this case we write E ≥ 0. The support
of E is the subvariety Supp(E) = ∪aD 6=0 D ⊂ X. Prime
P divisors are Weil divisors with only
one non-zero coefficient, and we often write D =
ai Di for a Weil divisor D ∈ Div(X),
where it is understood that the sum is over a finite index set and the Di are prime.
If X is normal, the map νD from Corollary 5.2 gives a way of associating a Weil divisor
to a rational function f ∈ C(X)∗ . We define
X
div(f ) =
νD (f ) · D.
D⊂X

This is a Weil divisor since only finitely many coefficients are nonzero [12, Lem. 4.0.9]. Weil
divisors arising in this way are called principal divisors. From the observations
div(f g) = div(f ) + div(g),

div(f −1 ) = −div(f ),

it is clear that they form a subgroup. We denote this group by Div0 (X) ⊂ Div(X).
Example 5.3. Let f = (x − a1 )m1 · · · (x − ar )mr ∈ C[x], where ai are distinct
complex
Pr
m
numbers. Viewed as a rational function on C, f gives P
a divisor div(f ) =
Pr i=1 i · {ai } ∈
r
1
Div0 (C). Viewed as a rational function on P , div(f ) = i=1 mi · {ai } − ( i=1 mi ) · {∞}. 
Example 5.4. On X = Pn , let Di be the zero locus of the i-th homogeneous coordinate
function xi , i = 1, . . . , n + 1. Rational functions on X are fractions of homogeneous polynomials of the same degree. One checks that Di − Dj = div(xi /xj ) is a principal divisor, but
Di ∈ Div(X) \ Div0 (X) for any i, j ∈ {1, . . . , n + 1}.

P
For an open subset U ⊂ X and a Weil divisor D =
ai Di ∈ Div(X), we define the
restriction of D to U as
X

X
D|U =
ai D i
=
ai · (Di ∩ U ) ∈ Div(U ).
|U

Di ∩U 6=∅

The divisor D ∈ Div(X)
is called Cartier if it is locally principal, meaning that there is an
S
open covering X = i Ui such that D|Ui ∈ Div0 (Ui ) is the divisor of a rational function on
55

Ui . The Cartier divisors form a subgroup of Div(X), denoted CDiv(X) ⊂ Div(X), and all
principal divisors are Cartier:
Div0 (X) ⊂ CDiv(X) ⊂ Div(X).
The last inclusion is an equality if X is smooth, see [12, Thm. 4.0.22(b)].
Theorem 5.5. If X is smooth, all Weil divisors are Cartier. That is, CDiv(X) = Div(X).
Example 5.6. Let X = P1 = Ux ∪ Uy , where Ux = P1 \ {x = 0}, Uy = P1 \ {y = 0} are as
in Example 4.1. We have seen that Dx = {x = 0} is not principal (Example 5.4). However,
it is locally principal. Indeed, this is implied by Theorem 5.5, and seen from
x
(Dx )|Ux = div(1), (Dx )|Uy = div
.

y
In what follows, we will use the terminology divisor for Weil divisors. Two divisors
D, E ∈ Div(X) are said to be linearly equivalent if D − E ∈ Div0 (X). This equivalence
relation gives two important quotient groups.
Definition 5.7 (Class and Picard group). The divisor class group of a normal variety X is
Cl(X) = Div(X)/Div0 (X). The Picard group of X is Pic(X) = CDiv(X)/Div0 (X).
Here is an important result on the class group of certain affine varieties which will help
us deal with more complicated cases later.
Theorem 5.8. Let R be a unique factorization domain and X = Specm(R). We have
(a) R is normal and every codimension 1 prime ideal is principal.
(b) Cl(X) = 0.
Proof. (a) It is a standard exercise in commutative algebra to show that every unique factorization
is normal. Let p be a codimension 1 prime ideal and f ∈ p \ {0}. Then
Qs domain
ai
f = c i=1 fi , where the fi are prime and c is a unit. Since p is prime, fi ∈ p for some i.
This means that hfi i ⊂ p, and since p is codimension 1, p = hfi i.
(b) Let Di be a prime divisor.
is principal by part (a).
PsIts prime ideal pi ⊂ R Q
QsWe write
s
ai
ai
p
i = hfi i. It follows that if D =
i=1 ai Di , then D = div( i=1 fi ). Indeed, div( i=1 fi ) =
P
s
i=1 ai νDi (fi )Di and νDi (fi ) = 1 since fi generates pi Rpi .
Example 5.9. The class group of the affine space Cn is 0, and so is that of a torus (C∗ )n . 
In what follows, we will write [D] for the residue class of D ∈ Div(X) in Cl(X). Our
next theorem uses the exercise below.
Exercise 5.10. Check that the restriction Div(X) → Div(U ) : D 7→ D|U induces a welldefined map Cl(X) → Cl(U ) : [D] 7→ [D|U ].

56

Theorem 5.11. Let X be a normal variety and U ⊂ X a nonempty open subset. Let
D1 , . . . , Ds be the irreducible components of X \ U that are prime divisors. Then
s
M

Z · Di −→ Cl(X) −→ Cl(U ) −→ 0

i=1

is exact. The maps are

Ps

Ps

i=1 ai Di 7→ [

i=1 ai Di ] and [D] 7→ [D|U ] (Exercise 5.10).

P
Proof. We sketch the proof. Exactness
at Cl(U ) follows from the fact that D0 =
ai Di0 ∈
P
0
Div(U ) is the restriction of D = ai Di ∈ Div(X), where Di = Di is the Zariski closure of Di0
in X. It remains to show exactness at Cl(X). Clearly the composition is zero. Suppose [D]
restricts to zero in Cl(U ). Then D|U is the divisor of some f ∈ C(U )∗ . Since C(X) = C(U ),
f defines a divisor div(f ) ∈ Div(X) which restricts to D|U . Hence (D − div(f ))|U = D|U −
div(f )|U = 0, and
is supported in ∪si=1 Di . This
that D is linearly equivalent
Pmeans
Ps D−div(f )L
s
s
to an element i=1 ai Di ∈ i=1 Z · Di , so that [D] = [ i=1 ai Di ].
Here is a first example of how Theorems 5.8 and 5.11 can help us compute class groups.
Example 5.12. Let X = P1 and U = Uy = P1 \ Dy ≃ C is the open set from Example 5.6.
By Theorem 5.11, we have the exact sequence
Z · Dy −→ Cl(P1 ) −→ Cl(C) −→ 0.
In this case, the first map is injective, since k · Dy is principal if and only if k = 0. By
Theorem 5.8, Cl(C) = 0, so that Cl(P1 ) ≃ Z.

We conclude with a lemma that will be useful later. For a proof, see [12, Prop. 4.0.16].
Lemma 5.13. Let X be a normal variety and f ∈ C(X)∗ .
(a) The divisor div(f ) is effective if and only if f : X → C is a morphism.
(b) We have div(f ) = 0 if and only if f : X → C∗ is a morphism.

5.2

Weil divisors on toric varieties

We turn back to the case where X = XΣ is a normal toric variety coming from a fan Σ in
NR ≃ Rn . Let Σ(1) be the set of rays of Σ. By the orbit-cone correspondence (Theorem
4.24), this gives torus invariant prime divisors V (ρ) = O(ρ), ρ ∈ Σ(1). To emphasize that we
think of these as divisors, we write Dρ = V (ρ). Our first result gives the order of vanishing
of a character along the boundary of the torus T ⊂ XΣ . That is, we compute the valuation
map νρ = νDρ : C(XΣ )∗ → Z from Proposition 5.1 on characters. This makes sense because
characters are rational functions on XΣ . They are defined on an open subset containing T .
Proposition 5.14. Let uρ be the primitive ray generator of ρ ∈ Σ(1). For any m ∈ M , we
have νρ (χm ) = huρ , mi.

57

Proof. Let e1 = uρ , e2 , . . . , en be a basis of the cocharacter lattice N . Note that uρ can be
extended to such a basis because uρ is primitive. The affine toric variety Uρ is isomorphic to
±1
C × (C∗ )n−1 = Specm(C[x1 , x±1
2 , . . . , xn ])

(5.1)

(see Example 2.44) and Uρ ∩ Dρ is defined by x1 = 0. Therefore OXΣ ,Dρ = OUρ ,Uρ ∩Dρ =
C[x1 , . . . , xn ]hx1 i and νρ (f ) = k where k is such that f = xk1 hg for g, h ∈ C[x1 , . . . , xn ] \ hx1 i.
Let m1 , . . . , mn be the dual basis of M with respect to e1 , . . . , en . The variables
xi in (5.1)
Pn
mi
correspond to the characters χ . APcharacter Q
m ∈ M can be written as i=1 ai mi , so that
n
hei , mi = ai . The character χm = χ i=1 ai mi = ni=1 (χmi )ai is the restriction of xa11 · · · xann to
the torus, so that νρ (χm ) = a1 = he1 , mi = huρ , mi.
As a consequence, we get the following elegant formula for the divisor of a character.
P
Corollary 5.15. For m ∈ M , the divisor div(χm ) is given by ρ∈Σ(1) huρ , mi Dρ .
m
This uses the fact that div(χ
)|T = 0, since χm : T → C∗ is a morphism (Lemma
S
5.13). Divisors supported on ρ∈Σ(1) Dρ are called torus invariant divisors. They form a free
L
subgroup DivT (XΣ ) = ρ∈Σ(1) Z · Dρ ⊂ Div(XΣ ) of finite rank k = |Σ(1)|.

Theorem 5.16. Let M → DivT (X) be the map that sends m 7→ div(χm ) and DivT (XΣ ) →
Cl(XΣ ) sends a divisor to its class. There is an exact sequence
M −→ DivT (XΣ ) −→ Cl(XΣ ) −→ 0.

(5.2)

Furthermore, this extends to a short exact sequence
0 −→ M −→ DivT (XΣ ) −→ Cl(XΣ ) −→ 0.

(5.3)

if and only if the rays of Σ span NR , i.e. XΣ has no torus factor (Theorem 4.43).
Proof. Theorem 5.11 gives an exact sequence
DivT (XΣ ) −→ Cl(XΣ ) −→ Cl(T ) −→ 0.
By Theorem 5.8, Cl(T ) = 0, which proves exactness at Cl(XΣ ) in (5.2). We now show
exactness at DivT (XΣ ). The composition is clearly zero, since divisors of characters are
principal. Suppose [D] = 0 for some D ∈ DivT (XΣ ). Then D = div(f ) and div(f )|T = 0.
By Lemma 5.13, f : T → C∗ is a morphism, and hence f = c χm for some m ∈ M and
some c ∈ C∗ (we used this in the proof of Proposition 2.3). We conclude that D = div(f ) =
div(c χm ) = div(χm ). Exactness of (5.3) at M if {uρ }ρ∈Σ(1) span NR is an easy exercise.
An important consequence of Theorem 5.16 is that, when XΣ has no torus factors, Cl(XΣ )
can be computed using elementary linear algebra over Z. After fixing coordinates, we may
assume M = N = Zn . Let F = [u1 · · · uk ] ∈ Zn×k be the matrix whose columns are the
primitive ray generators of the rays in Σ(1). By Corollary 5.15, the map M → DivT (XΣ ) is
F > : Zn → Zk . By Theorem 5.16 the class group is given by Cl(XΣ ) ≃ Zk / im F > .
58

Figure 22: Computing class groups in Oscar.jl.
Example 5.17. If XΣ = P2 , the matrix F containing the rays in the fan of Figure 15 is


1 0 −1
F =
.
0 1 −1
The class group is Z · [D1 ] + Z · [D2 ] + Z · [D3 ] with relations [D1 ] − [D3 ] = 0 (first row of
F ) and [D2 ] − [D3 ] = 0 (second row of F ). It is generated by [D3 ], as [aD1 + bD2 + cD3 ] =
(a + b + c)[D3 ]. We conclude Cl(P2 ) ≃ Z.

Example 5.18. If XΣ = P1 × P1 , i.e. Σ is the fan of Figure 18, we obtain


1 0 −1 0
F =
.
0 1 0 −1
The class group Cl(P1 × P1 ) is isomorphic to Z2 , and it is generated by [D1 ] and [D3 ], as
[aD1 + bD2 + cD3 + dD4 ] = (a + c)[D1 ] + (b + d)[D3 ].

Exercise 5.19. Consider the complete fan Σ in R2 with ray generators given by


1 −1 −1 1
F =
.
1 1 −1 −1
This is the normal fan of a diamond. Show that Cl(XΣ ) is isomorphic to Z2 ⊕ Z/2Z.
Example* 5.20. The class group Cl(XΣ ) can be computed in Oscar.jl using the command

class group. For XΣ from Example* 4.18 we find Cl(XΣ ) = Z2 , see Figure 22.

5.3

Cartier divisors on toric varieties

We now study Cartier divisors on XΣ . We start with the analog of Theorem 5.16. Among
the torus invariant divisors in DivT (XΣ ), those that are Cartier form a subgroup denoted
CDivT (XΣ ) = DivT (XΣ )∩CDiv(XΣ ). Clearly, CDivT (XΣ ) contains all divisors of characters.
Theorem 5.21. Let M → CDivT (XΣ ) be the map that sends m 7→ div(χm ) and
CDivT (XΣ ) → Pic(XΣ ) sends a divisor to its class. There is an exact sequence
M −→ CDivT (XΣ ) −→ Pic(XΣ ) −→ 0.

(5.4)

Furthermore, this extends to a short exact sequence
0 −→ M −→ CDivT (XΣ ) −→ Pic(XΣ ) −→ 0.
if and only if the rays of Σ span NR , i.e. XΣ has no torus factor (Theorem 4.43).
59

(5.5)

Figure 23: The fans Σ and Σ0 from Example* 5.23.
Proof. By Theorem
P 5.16, every divisor D ∈ CDiv(XΣ ) is linearly equivalent to a torus
invariant divisor ρ∈Σ(1) aρ Dρ ∈ CDivT (XΣ ), which shows exactness at Pic(XΣ ). Also, by
Theorem 5.16 those elements of CDivT (XΣ ) whose class is [0] are precisely the ones coming
from characters, which shows exactness at CDivT (XΣ ). Injectivity of M → CDivT (XΣ )
under the extra assumption on the rays is an easy exercise.
Our next goal is to describe the groups CDivT (XΣ ) and Pic(XΣ ) explicitly. It turns out
this is quite easy if XΣ = Uσ is affine, see [12, Prop. 4.2.2].
Proposition 5.22. Let σ ⊂ NR be a strongly convex rational cone. We have Pic(Uσ ) = 0,
i.e., M → CDivT (XΣ ) is surjective.
Example* 5.23. Let Σ be the fan consisting of the 2-dimensional cone σ =
Cone((−1, −2), (1, 0)) ⊂ R2 and all its faces, illustrated in Figure 23. The corresponding
toric variety XΣ = Uσ is affine. By Proposition 5.22, its Picard group is trivial: Pic(X
 Σ ) = 0.
−1 1
The map M → DivT (XΣ ) is represented by the matrix of ray generators F > =
,
−2 0
whose image has index 2 in Z2 . By Theorem 5.16, this implies that Cl(XΣ ) ≃ Z/2Z. We
now remove the full-dimensional cone σ from Σ, to obtain the fan Σ0 on the right side of
Figure 23. All cones in Σ0 are smooth, so that by Theorem 5.5 we have Cl(XΣ0 ) = Pic(XΣ0 ).
The class group only depends on the rays of the fan, so that Pic(XΣ0 ) ≃ Z/2Z.
We verify this using Oscar.jl with the following commands.
Σ = positive_hull([-1 -2; 1 0]);
ΣΣ = PolyhedralFan([-1 -2; 1 0], IncidenceMatrix([[1],[2]]));
X_Σ = NormalToricVariety(Σ); X_ΣΣ = NormalToricVariety(ΣΣ);
Pic1 = picard_group(X_Σ); Pic2 = picard_group(X_ΣΣ);

Note that XΣ0 is obtained from XΣ by removing the torus fixed point (Example 4.27).

1
2
3
4



Example* 5.23 shows that the Picard group of a normal toric variety may have torsion.
The following proposition provides an easy criterion to exclude such a scenario.
Proposition 5.24. If Σ is a fan in NR ≃ Rn containing a cone of dimension n, then Pic(XΣ )
is a free abelian group.
Proof. By (5.5), it suffices to show that if kD = div(χm ) for some D ∈ CDivT (XΣ ), k ∈ Z>0 ,
0
then there exists m0 ∈ M such that D = div(χm ).
60

Let D =

P

ρ∈Σ(1) aρ Dρ and σ ∈ Σ(n). We have D|Uσ ∈ CDivT (Uσ ), so that

D|Uσ =

X

0

aρ Dρ = div(χm )|Uσ

ρ∈σ(1)

for some m0 ∈ M , by Proposition 5.22. Therefore, by Corollary 5.15, aρ = huρ , m0 i for
ρ ∈ σ(1). On the other hand, kD = div(χm ) implies kaρ = huρ , mi for ρ ∈ Σ(1). Since σ
has dimension n, the map m 7→ (huρ , mi)ρ∈σ(1) is injective, so that
huρ , km0 i = huρ , mi for ρ ∈ σ(1)
P
P
0
implies km0 = m and div(χm ) = ρ∈Σ(1) huρ , m0 iDρ = ρ∈Σ(1) k −1 huρ , miDρ = D.
If the fan Σ is smooth, Theorem 5.5 implies that Cl(XΣ ) = Pic(XΣ ). This is an ‘if and
only if’ in our setting.
Proposition 5.25. The toric variety XΣ is smooth if and only if CDiv(XΣ ) = Div(XΣ ).
Proof. We show the ‘if’ direction. Suppose CDiv(XΣ ) = Div(XΣ ) and let σ be any cone
of Σ. The restriction Cl(XΣ ) → Cl(Uσ ) is surjective by Theorem 5.11, hence CDiv(Uσ ) =
Div(Uσ ). We also have Pic(Uσ ) = 0 (Proposition 5.22), so that M 7→ DivT (Uσ ) is surjective.
Choosing coordinates, this map is represented by a matrix F > whose rows are the primitive
ray generators uρ for ρ ∈ σ(1). Surjectivity of F > means that {uρ }ρ∈σ(1) can be extended to
a Z-basis of N , which means that σ is smooth.
The proof of Proposition 5.25 is easily adapted to show the following [12, Prop. 4.2.7].
Proposition 5.26. Pic(XΣ ) ⊂ Cl(XΣ ) has finite index if and only if Σ is simplicial.
Example* 5.27. Let Σ be the fan from Example* 4.18. We check using Oscar.jl that D3
is not Cartier as follows.
X_Σ = NormalToricVariety(Σ)
D3 = ToricDivisor(X_Σ, [0,0,1,0])
iscartier(D3)

1
2
3

Since Σ is simplicial, Proposition 5.26 guarantees that there exists ` ∈ Z>0 such that ` · D3
is Cartier. We compute ` using Oscar.jl. The output of the following code
i = 0; l = 1;
while i < 1
DD = iscartier(ToricDivisor(X_Σ, [0,0,l,0]))
if DD == false
global l += 1
else
print("l = ", l)
i = 1
end
end

61

1
2
3
4
5
6
7
8
9
10

is ` = 6, hence 6 · D3 is Cartier.



Let D ∈ CDivT (XΣ ) be a torus invariant Cartier divisor. On each affine toric open subset
Uσ ⊂ XΣ , D|Uσ is a principal divisor corresponding to a character (Proposition 5.22). We
now investigate which characters mσ ∈ M are such that D|Uσ = div(χmσ )|Uσ .
P
Theorem 5.28. Let D = ρ∈Σ(1) aρ Dρ ∈ DivT (XΣ ) be a Weil divisor. The following are
equivalent:
(a) D is Cartier,
(b) D is principal on Uσ for all σ ∈ Σ,
(c) For each σ ∈ Σ, there is mσ ∈ M such that huρ , mσ i + aρ = 0, ρ ∈ σ(1),
(d) For each σ ∈ Σmax , there is mσ ∈ M such that huρ , mσ i + aρ = 0, ρ ∈ σ(1).
Here Σmax is the set of maximal cones of σ with respect to inclusion. Moreover, if D ∈
CDivT (XΣ ) and the lattice points {mσ }σ∈Σ are as in (c), then
(1) mσ is unique modulo M (σ) = σ ⊥ ∩ M , and
(2) if τ  σ is a face, then mσ = mτ modulo M (τ ).
Proof. The implications (a) ⇔ (b) ⇔ (c) ⇒ (d) follow from Proposition 5.22. To show (d)
⇒ (c), observe that if σ is maximal and mσ is as in (d), then for τ  σ one chooses mτ = mσ .
For (1), suppose huρ , mσ i = huρ , mσ0 i = −aρ for all ρ ∈ σ(1). Then huρ , mσ − mσ0 i = 0
for all ρ ∈ σ(1) means that mσ − mσ0 ∈ σ ⊥ ∩ M = M (σ). Point (1) and our observation in
part (d) imply that, when τ  σ, mσ = mτ modulo M (τ ), which is (2).
In the notation of Theorem 5.28, the torus invariant Cartier divisor D is locally given by
D|Uσ = div(χ−mσ ). The minus sign comes from our notation (3.2) for facet inequalities of
polytopes. The tuples {(Uσ , mσ )}σ∈Σ form the Cartier data for D, as they encode how D is
locally principal. Note also that part (1) of the theorem implies that mσ ∈ M is uniquely
determined if and only if dim σ = n.
We can regard mσ as a unique element of M/M (σ). If τ  σ, the canonical map
M/M (σ) → M/M (τ ) sends mσ to mτ . This gives an explicit descripition of CDivT (XΣ ) as
follows (see [12, Prop. 4.2.9]). Let Σmax = {σ1 , . . . , σr } and define the map
φ:

r
M
i=1

M/M (σi ) →

M

M/M (σi ∩ σj ),

given by (mi )i 7→ (mi − mj )i,j .

1≤i<j≤r

Proposition 5.29. With the notation introduced above, we have CDivT (XΣ ) ≃ ker φ.
Example 5.30 (The divisor of a polytope). Let P = {m ∈ MR | huQ , mi + aQ ≥ 0, Q ∈ Q}
be a full-dimensional polytope in Rn whose set of facets is Q and uQ is the primitive inward
pointing normal vector to Q ∈ Q. The toric variety associated to P is XP ≃ XΣP , where ΣP
62

Figure 24: A triangle in R2 whose normal fan is shown in Figure 15.
is the normal fan of P . The maximal cones σv ∈ (ΣP )max correspond to the vertices v ∈ P ,
and a vertex v ∈ P satisfies
huQ , vi + aQ = 0,

for all Q 3 v.
(5.6)
P
Hence {(Uσv , v)}v vertex of P are the Cartier data for DP = Q∈Q aQ DQ ∈ DivT (XΣP ).
Translating our polytope P by a lattice point m does not change its normal fan.
Therefore, as pointed out in Section 3.7, P and P + m give the same toric variety
XP ≃ XP +m ≃ XΣP . However, they give different divisors on it. In fact, one checks
easily that DP +m = DP + div(χm ), so that [DP ] = [DP +m ]. By Theorem 5.16, the divisor
class [DP ] corresponds to such translates of P .
As an explicit example, we consider the triangle in Figure 24, whose normal fan is shown
in Figure 15. The three blue vertices correspond to the three blue maximal cones. If the
lower left corner of the triangle is (0, 0), we see that




 
1
0  
0


m1
1
P = m ∈ R2  0
+ 0 ≥ 0 .
m2


−1 −1
2
This means DP = 2D3 , where D3 is as in Example 5.17. The vertex v = (2, 0) of P
corresponds to the cone σ1 ∈ Σ. This cone contains the rays spanned by rows 1 and 3 in
F > . We have

   
0
1
v1
0
+
= 0,
−1 −1 v2
2
which is (5.6) for this vertex. For the ray ρ = R≥0 · (−1, −1), one can choose mρ to be any
of the lattice points on the affine line containing the edge Conv((2, 0), (0, 2)) of ρ.

Exercise 5.31. Compute the coefficients of DP = a1 D1 + · · · + a4 D4 , where the Di are as
in Example 5.18 and P is the rectangle [0, 2] × [0, 7] ⊂ R2 .

5.4

Sheaves of divisors

The structure sheaf of a normal variety X is the sheaf of OX -modules given by
U 7−→ OX (U ) = {f ∈ C(X)∗ | div(f )|U ≥ 0}.
63

A Weil divisor D on X defines a twisted version OX (D) of this sheaf, such that
U 7−→ OX (D)(U ) = {f ∈ C(X)∗ | (div(f ) + D)|U ≥ 0}.
To avoid double parentheses, we will use the notation Γ(U, OX (D)) = OX (D)(U ). These
rational functions are called sections of the sheaf OX (D) on U , and Γ(X, OX (D)) consists of
the global sections of OX (D). For normal toric varieties, they have a nice, explicit description.
Here is a lemma that we need to prove the main result of this section, see [12, Lem. 1.1.16].
It involves a torus T and its character lattice M .
Lemma 5.32. Consider the action of T on C[M ] given by t · f = (p 7→ f (t−1 · p)). If
V ⊂ C[M ] is a C-subspace which is stable under this action, then
M
V =
C · χm .
χm ∈V

Proposition 5.33. Let Σ be a fan in NR ≃ Rn and let D ∈ DivT (XΣ ). We have
M
Γ(XΣ , OXΣ (D)) =
C · χm .
div(χm )+D≥0

Proof. A rational function f belongs to Γ(XΣ , OXΣ (D)) if and only if div(f )+D ≥ 0. Then in
particular (div(f )+D)|T ≥ 0, and f ∈ C[M ] by Lemma 5.13. Hence Γ(XΣ , OXΣ (D)) ⊂ C[M ]
is a subspace. It is stable under the action of T on C[M ] since the divisor D is torus invariant.
The statement now follows from Lemma 5.32.
P
Let D = ρ∈Σ(1) aρ Dρ ∈ DivT (XΣ ). The direct sum in Proposition 5.33 is over all lattice
points m ∈ M such that div(χm ) + D is effective. By Corollary 5.15, these are the lattice
points in the polyhedron
PD = {m ∈ MR | huρ , mi + a ≥ 0}.
In Example 5.30 we saw how to associate a divisor DP to a polytope P . This section shows
how to associate a polyhedron PD (i.e., a finite intersection of half spaces which is not
necessarily bounded) to a torus invariant divisor D. The vertices of this polyhedron are not
necessarily lattice points, see Exercise 5.38. The following example and Exercise 5.39 show
how the constructions D 7→ PD and P 7→ DP are, to some extent, inverse to each other.
Example 5.34. Let XΣ = P2 and D = 2D3 , where D3 is as in Example 5.17. One checks
easily that the polyhedron PD is the triangle from Figure 24. By Proposition 5.33, the global
sections of OP2 (D) are Laurent polynomials supported in this triangle. These correspond to
rational functions on P2 with poles of order up to 2 along D3 , and no poles elsewhere. If D3
is given by the vanishing of the homogeneous coordinate x3 , these are of the form
a0 x23 + a1 x1 x3 + a2 x2 x3 + a3 x1 x2 + a4 x21 + a5 x22
∼ a0 + a1 t1 + a2 t2 + a3 t1 t2 + a4 t21 + a5 t22 .
2
x3
Note that here XΣ = XPD and DPD = D. See Exercise 5.39 for a general statement.
64



If, in Example 5.34, we use D0 = 2D1 instead of D = 2D3 , PD0 is a translated version
of the triangle in Figure 24. The vector space Γ(X, OX (D0 )) is isomorphic to Γ(X, OX (D)),
via multiplication with χ(2,0) . This is an instance of the following fact [12, Prop. 4.0.29].
Proposition 5.35. If D, D0 ∈ DivT (XΣ ) are linearly equivalent, i.e. [D − D0 ] = 0, we have
Γ(XΣ , OXΣ (D)) ≃ Γ(XΣ , OXΣ (D0 )).
We end the section by hinting at a nice connection with tropical geometry [21].
Example 5.36 (Tropical hypersurfaces). Let P ⊂ Rn be a full-dimensional convex lattice
polytope and let DP be the corresponding divisor on XP , see Example 5.30. The vector
space Γ(XP , OXP (DP )) consists of all Laurent polynomials whose exponents are contained
in P . Let f ∈ Γ(XP , OXP (DP )) be such a Laurent polynomial. We write f as
X
f=
cm tm , with A ⊂ P ∩ M and cm ∈ C∗ .
m∈A

This defines a hypersurface V (f ) ∈ (C∗ )n given by V (f ) = {t ∈ (C∗ )n | f (t) = 0}. The
initial form of f with respect to a weight vector w ∈ Rn is
X
inw (f ) =
cm tm , with Aw = {m ∈ A | hw, mi = min
hw, m0 i}.
0
m ∈A

m∈Aw

In tropical geometry, f defines a tropical hypersurface in Rn given by
Trop(V (f )) = {w ∈ Rn | inw (f ) has ≥ 2 terms}.
One easily checks that if all vertices of P belong to A , Trop(V (f )) is the support of the
(n − 1)-skeleton ΣP,n−1 = {σ ∈ ΣP | dim σ ≤ n − 1} of the normal fan ΣP . In this case, the
tropical compactification of the hypersurface V (f ) is its closure in XΣP,n−1 . Fore more details
on such compactifications and their desirable properties, see [21, Sec. 1.8 and 6.4].

Exercise 5.37. With the notation of Example 5.18, describe Γ(P1 × P1 , OP1 ×P1 (2D1 + 5D3 )).
Exercise 5.38. Show that D = D1 + D2 ∈ DivT (XΣ ) \ CDivT (XΣ ), where XΣ is the toric
surface from Exercise 5.19. Describe PD and Γ(XΣ , OXΣ (D)).
Exercise 5.39. Show that if XΣ ≃ XPD for some divisor D ∈ DivT (XΣ ) such that PD is
full-dimensional, then DPD = D. Conversely, if P is a full-dimensional lattice polytope and
DP ∈ CDivT (XP ) is the corresponding divisor, then PDP = P .

6

Homogeneous coordinates on toric varieties

Fix a fan Σ in NR and let XΣ be the corresponding normal toric variety. We will sometimes
drop the index Σ and write X = XΣ to simplify the notation where there is no danger for
confusion. In this section we describe X as the quotient of a quasi-affine space by the action
of a reductive group. This allows us to define global coordinates on X, which are useful
65

for describing its subvarieties. The construction generalizes the well-known homogeneous
coordinates on Pn . Homogeneous coordinates correspond to the variables of the homogeneous
coordinate ring or Cox ring of X, which is a polynomial ring endowed with a particular
grading and a distinguished ideal called the irrelevant ideal. The discussion follows [30,
Sec. 5.4-5.5]. For more details, the reader can consult [12, Ch. 5]. We start with an example
which identifies the relevant geometric and algebraic objects for the projective plane X = P2 .
Example 6.1. The projective plane P2 is defined as
C3 \ {0}
,
(6.1)
C∗
where the quotient is by the action C∗ × (C3 \ {0}) → (C3 \ {0}) given by (λ, (x1 , x2 , x3 )) 7→
(λx1 , λx2 , λx3 ). This action extends trivially to an action on C3 . Subvarieties of P2 are given
by homogeneous ideals in the polynomial ring S = C[x1 , x2 , x3 ]. Here ‘homogeneous’ is with
respect to the Z-grading
M
Sα ,
S=
P2 =

α∈Z

which is such that for f ∈ S homogeneous, VC3 (f ) is stable under the C∗ -action. Equivalently,
VC3 (f ) is a union of C∗ -orbits. In the ring S, the ideal B = hx1 , x2 , x3 i plays a special role:
its variety in P2 is the empty set. The interplay between algebra and geometry in this
construction is summarized in the following table.
Algebra
S
B
Z

Geometry
Specm(·)

−→

VC3 (·)

−→

HomZ (·,C∗ )

−→

C3
{0}
C∗

For the purpose of generalizing this construction, we make the following observation. The
quotient (6.1) comes from a toric morphism π : C3 \{0} → P2 which is constant on C∗ -orbits.
A toric morphism comes from a lattice homomorphism N 0 → N that is compatible with fans
Σ0 and Σ in NR0 and NR respectively (see Section 4.6). In our case Σ0 is the fan of C3 \{0} and
Σ is the fan of P2 . The lattices are N 0 = Z3 and N = Z2 , and the morphism π comes from
F : N 0 → N where F is a 2×3 integer matrix whose columns are the primitive ray generators
of Σ(1). The fans and the matrix F are shown in Figure 25. The compatibility of the map
F with the fans Σ0 and Σ comes down to the fact that each cone of Σ0 is mapped (under
the R-map FR = F ⊗Z R associated to F ) into a cone of Σ. In Figure 25 the 2-dimensional
cones have matching colors according to this association. Note that the three dimensional
cone σ = Cone(e1 , e2 , e3 ) of the positive orthant in R3 is not mapped to a cone of Σ under
FR . Therefore, this cone does not belong to Σ0 . Taking this three dimensional cone out of
Σ0 corresponds to taking the origin out of C3 (Example 4.27). Hence C3 \ {0} = XΣ0 .


6.1

Toric varieties as GIT quotients

In this subsection we describe the construction of a toric variety X as the image of a map
π : Ck \ Z → X,
66



1 0 −1
F=
0 1 −1

−−−−−−−−−−−→

Figure 25: An illustration of the Z-linear map F : N 0 → N from Example
6.1. The ray generators of Σ0 (1), Σ(1) are depicted as red arrows and the two
dimensional cones are colored in blue, orange and yellow.
where Z ⊂ Ck is a subvariety and π is invariant under an algebraic group action G × (Ck \
Z) → (Ck \ Z). This construction is due to Cox [7]. It generalizes Example 6.1 to toric
varieties X = XΣ without torus factors. In the case of X = Pn , we have k = n + 1, Z = {0}
and G = C∗ . More generally, we will see that
• k = |Σ(1)| is the number of rays in Σ,
• Z is a union of coordinate subspaces,
• G is a quasi-torus acting algebraically on Ck \ Z.
We should mention that the result had been described in the analytic category by Audin,
Delzant and Kirwan, see [1, Chapter 6] and references therein.
In what follows, it is instructive to keep Example 6.1 in mind as a reference. Let Σ(1) =
{ρ1 , . . . , ρk } and let ui ∈ N be the primitive ray generator of ρi . We collect the ui in a matrix
F = [u1 · · · uk ] ∈ Zn×k .
This gives a lattice homomorphism F : N 0 → N where N 0 = Zk . Consider the fan given by
the positive orthant in Rk and all its faces. We let Σ0 be the subfan of all the cones whose
image under FR is contained in a cone of Σ. By construction, the lattice homomorphism
F is compatible with the fans Σ0 and Σ in NR0 and NR respectively. It follows that F gives
a toric morphism π : XΣ0 → XΣ , where XΣ0 = Ck \ Z and Z is a union of coordinate
subspaces. We now give a description of Z as the affine variety of a radical monomial ideal.
Let S = C[x1 , . . . , xk ] be the coordinate ring of Ck and for each σ ∈ Σ, consider the monomial
Y
xσ̂ =
xi ,
(6.2)
ρi 6⊂σ

where the product ranges over all i ∈ {1, . . . , k} such that ρi 6⊂ σ.
Proposition 6.2. The subvariety Z ⊂ Ck for which XΣ0 = Ck \ Z is Z = VCk (B) with
B = xσ̂ | σ ∈ Σ = xσ̂ | σ ∈ Σmax .
67

(6.3)

Proof. See [12, Prop. 5.1.9]. Note that xσ̂ | σ ∈ Σ = xσ̂ | σ ∈ Σmax simply follows from
the fact that xσ̂ for σ ∈ Σmax are the minimal generators.
A geometric description of Z as a union of coordinate subspaces uses primitive collections.
Definition 6.3 (Primitive collection). A subset C ⊂ Σ(1) of rays is a primitive collection if
1. C 6⊂ σ(1) for all σ ∈ Σ and
2. for every proper subset C 0 ( C, there is σ ∈ Σ for which C 0 ⊂ σ(1).
Proposition 6.4. The subvariety Z ⊂ Ck for which XΣ0 = Ck \ Z is
[
Z=
VCk ( xi | ρi ∈ C ).
C primitive collection

Proof. See [12, Prop. 5.1.6].
Example 6.5. Let X = P2 and let F be as in Example 6.1. With σi as in Figure 15 we
have
xσ̂0 = x3 , xσ̂1 = x1 , xσ̂2 = x2 ,
and hence B = hx1 , x2 , x3 i as expected. The only primitive collection is C = Σ(1).



Exercise 6.6. With F as in Example 5.18, show that for X = P1 × P1 we have B =
hx1 x2 , x1 x4 , x3 x2 , x3 x4 i. Identify the primitive collections and verify Proposition 6.4.
The morphism π is an extension of a map of tori π|(C∗ )k : (C∗ )k → (C∗ )n , which has an
easy description based on the matrix F . It is given by the Laurent monomial map
π|(C∗ )k = F ⊗Z C∗ : (C∗ )k → (C∗ )n

where (t1 , . . . , tk ) 7→ (tF1,: , . . . , tFn,: ).

(6.4)

This uses the short notation z a = z1ai · · · zkak and Fi,: for the i-th row of F . The kernel of
π|(C∗ )k (as a group homomorphism) is given by
G = {g ∈ (C∗ )k | g F1,: = · · · = g Fn,: = 1}.

(6.5)

This is a subgroup G ⊂ (C∗ )k which acts on Ck by
(g1 , . . . , gk ) · (x1 , . . . , xk ) 7→ (g1 x1 , . . . , gk xk )
(this is the restriction of the action of (C∗ )k on Ck to G).
Example 6.7. For X = P2 , G = {(g1 , g2 , g3 ) ∈ (C∗ )3 | g1 g3−1 = g2 g3−1 = 1} = {(λ, λ, λ) | λ ∈
C∗ } ≃ C∗ , and the action is the usual coordinate-wise scaling.

The morphism π is constant on G-orbits in Ck \ Z. Indeed, by equivariance (Proposition
4.33), π(g·x) = π(g)·π(x) = π(x) for all g ∈ G. The following theorem uses some terminology
for geometric invariant theory (GIT) quotients from [12, Sec. 5.0].
68

Theorem 6.8. The morphism π : Ck \ Z → XΣ coming from F = [u1 · · · uk ] is an almost
geometric quotient for the action of G on Ck \Z. The open subset U ⊂ XΣ for which π|π−1 (U )
is a geometric quotient is such that (XΣ \ U ) has codimension at least 3 in XΣ .
Proof. See [7, Thm. 2.1] or [12, Thm. 5.1.11].
Here is a longer, equivalent formulation of Theorem 6.8 which uses less terminology.
Theorem 6.9. Consider the action of the group G in (6.5) on Ck \ Z. There is a one-to-one
correspondence
{ closed G-orbits in Ck \ Z } ←→ { points in XΣ }.
Moreover, there is an open subset U ⊂ XΣ which is such that codimXΣ (XΣ \ U ) ≥ 3 for
which there is a one-to-one correspondence
{ G-orbits in π −1 (U ) } ←→ { points in U }.
These correspondences are realized by the toric morphism π : Ck \ Z → XΣ coming from F .
Remark 6.10. The open subset U ⊂ XΣ in Theorems 6.8 and 6.9 is the toric variety of the
largest simplicial subfan of Σ, see for instance the proof of Theorem 5.1.11 in [12]. That is,
[
O(σ)
XΣ \ U =
σ non-simplicial

It follows immediately that XΣ \ U has codimension at least 3 in XΣ : all cones of dimension
≤ 2 are simplicial. If Σ is a simplicial fan, then π : Ck \ Z → XΣ is a geometric quotient,
meaning that the nicest possible correspondence holds: G-orbits in Ck \ Z are points in XΣ .
Example 6.11. The toric variety X = P2 is simplicial, so U = X. The matrix F , the variety
Z and the ideal B for XΣ = P2 were computed in previous examples. The (real part of the)
closure of three G-orbits in C3 are shown in Figure 26. This corresponds to the familiar fact
that points in P2 are lines through the origin in C3 . We now consider the complete fan Σ in
R2 whose rays are given by


1 0 −1
F =
.
0 1 −2
One checks that Z = {0} and G = {(λ, λ2 , λ) | λ ∈ C∗ } ≃ C∗ . Some orbits are shown in the
right part of Figure 26. The toric variety XΣ is the weighted projective space P(1,2,1) . The
figure suggests that we can think of points in P(1,2,1) as ‘curves through the origin in C3 ’. 
Exercise 6.12 (A non-simplicial example). Example 3.1 in [13] considers the toric threefold
X = XΣ corresponding to a pyramid in R3 whose normal fan Σ has rays with generators


0 1
0 −1 0


1
0 −1 = u1 u2 u3 u4 u5 .
F = 0 0
1 −1 −1 −1 −1
Find B, Z and identify the subset U using Remark 6.10 by describing its fan.
69

Figure 26: Real G-orbits (closures in R3 ) of three points (orange dots) in the
quotient construction of P2 (left) and P(1,2,1) (right).

6.2

The Cox ring of a toric variety

In order to associate the ring S (with its distinguished ideal B) to our toric variety XΣ , we
will equip it with a grading such that homogeneous elements in S define varieties in Ck which
are stable under the action of G. The grading will be by the (divisor) class group Cl(XΣ )
of XΣ , which is the group of Weil divisors modulo linear equivalence [12, Ch. 4]. For toric
varieties, the class group is easy to describe explicitly. We start by recalling the procedure
in the notation of this section and give an alternative description of the group G.
Let D1 , . . . , Dk be the torus invariant prime divisors on XΣ corresponding to ρ1 , . . . , ρk ∈
Σ(1) respectively. These are the closures of the codimension 1 torus orbits of XΣ , see
Theorem 4.24. The divisors D1 , . . . , Dk generate the free group DivT (XΣ ). Identifying
DivT (XΣ ) ≃ Zk , Theorem 5.16 gives a short exact sequence
F>

0 −→ M −→ Zk −→ Cl(XΣ ) −→ 0

(6.6)

where the first map is F > = div and the second map takes a torus invariant divisor to its class
in Cl(XΣ ). This gives Cl(XΣ ) ≃ Zk / im F > . Note that taking HomZ (−, C∗ ) of (6.6) gives
us back the map of tori π|(C∗ )k : (C∗ )k → (C∗ )n from the geometric construction discussed
above. We conclude thatPthe group G is isomorphic to HomZ (Cl(XΣ ), C∗ ) ⊂ (C∗ )k .
For an element α = [ ki=1 ai Di ] ∈ Cl(XΣ ), we define the C-vector subspace
M
>
Sα =
C · xF m+a ⊂ S,
(6.7)
F > m+a≥0

where the sum ranges over all m ∈ M satisfying hui , mi + ai ≥ 0, for i = 1, . . . , k. One
can check that this definition is independent of the chosen representative for α: setting
a0 = a + F > m0 for some m0 ∈ M gives the same vector subspace Sα . We consider the grading
M
S=
Sα
(6.8)
α∈Cl(XΣ )

70

Definition 6.13 (Cox ring). The ring S with its irrelevant ideal (6.3) and the grading (6.8)
is called the homogeneous coordinate ring, total coordinate ring or Cox ring of XΣ .
P
>
If f = F > m+a≥0 cm xF m+a ∈ Sα is homogeneous of degree α, then for g ∈ G ⊂ (C∗ )k ,
X

f (g · x) =

>

cm (g · x)F m+a = g a f (x),

F > m+a≥0
>

where we use that g F m = 1 by definition of G. Hence VCk (f ) is stable under the action of
G. We define the variety defined by f in X as
VXΣ (f ) = π(VCk (f ) ∩ (Ck \ Z)) = {p ∈ XΣ | f (x) = 0 for some x ∈ π −1 (p)}.

(6.9)

The generalized definition for homogeneous ideals I ⊂ S is
VXΣ (I) = {p ∈ XΣ | f (x) = 0 for some x ∈ π −1 (p) for all f ∈ I}.

(6.10)

When X is simplicial, Theorem 6.9 and the observation that VCk (I) is stable under G imply
π −1 (VX (I)) = VCk (I) ∩ (Ck \ Z). In the non-simplicial case, the inclusion ⊃ might be strict.
Example 6.14. For the toric variety from Exercise 6.12, the ideal I = hx2 , x3 , x4 , x5 i ⊂ S =
C[x1 , x2 , x3 , x4 , x5 ] is homogeneous, and VX (I) = {p} = X \ U is a point. The fiber π −1 (p)
contains a unique closed G-orbit, equal to VX (I) ∩ (Ck \ Z). However, it contains many more
non-closed G-orbits, see [13, Example 3.1].

We generalize the table in Example 6.1 for toric varieties XΣ and add some terminology:
Algebra
Cox ring
irrelevant ideal
class group

S
B
Cl(XΣ )

Geometry
Specm(·)

−→

VCk (·)

−→

HomZ (·,C∗ )

−→

Ck

total coordinate space

Z

base locus

G

reductive group

We point out that under our assumption that Σ is complete, all of the graded pieces Sα , α ∈
Cl(XΣ ) are finite dimensional C-vector spaces [12, Prop. 4.3.8].
Remark 6.15. In this construction, there is a one-to-one correspondence between
1. the variables x1 , . . . , xk of S,
2. the rays ρ1 , . . . , ρk of Σ(1),
3. the columns u1 , . . . , uk of F ,
4. the torus invariant prime divisors D1 , . . . , Dk ,
5. (if Σ = ΣP ) the facets of P .
We have that Di = VXΣ (xi ) and π(x) ∈ Di ⇔ xi = 0.

71

Example 6.16. Let XΣ = P2 . The class group is Cl(P2 ) ≃ Z3 / im F > ≃ Z, see Example
5.17. Using, for instance, the identification Z3 / im F > → Z given by (a1 , a2 , a3 ) + im F > =
(0, 0, a1 + a2 + a3 ) + im F > 7→ a1 + a2 + a3 ∈ Z (the divisors a1 D1 + a2 D2 + a3 D3 and
(a1 + a2 + a3 )D3 are linearly equivalent), we see that the Z-grading on S is the usual grading
of the homogeneous coordinate ring of P2 : deg(xa11 xa22 xa33 ) = a1 + a2 + a3 and
M
1 m2 d−m1 −m2
S[dD3 ] =
C · xm
1 x2 x3
m1 ≥0
m2 ≥0
d−m1 −m2 ≥0



is spanned by monomials of ‘degree’ d, in the classical sense.

Example 6.17. The Hirzebruch surface H2 is the toric variety of the fan from Figure 21.
The matrix F is


1 0 −1 0
.
F =
0 1 2 −1
The Cox ring S = C[x1 , x2 , x3 , x4 ] is graded by Cl(H2 ) ≃ Z4 / im F > ≃ Z2 , with deg(xa ) =
deg(xa11 xa22 xa33 xa44 ) = (a1 − 2a2 + a3 , a2 + a4 ). The reductive group and base locus are given
by G = {(λ, µ, λ, λ2 µ) | (λ, µ) ∈ (C∗ )2 } ⊂ (C∗ )4 and Z = VC4 (x1 , x3 ) ∪ VC4 (x2 , x4 ) ⊂ C4
respectively. Since H2 is smooth, it is simplicial (in the notation from above, U = H2 ). 
Exercise 6.18. Show that the Cox ring of P1 ×P1 is C[x0 , x1 , y0 , y1 ], where deg(xi ) = (1, 0) ∈
Z2 and deg(yi ) = (0, 1) ∈ Z2 .
Remark 6.19. Some limited functionality regarding Cox rings is available in Oscar.jl
(v0.8.1), see for instance the command cox ring. It would be interesting to extend this
text with more examples in a next version, when this has been further developed.

6.3

Homogenization

Homogeneous ideals in the Cox ring S of a toric variety X give closed subvarieties via (6.10).
In fact, all closed subvarieties in this way [7]. Here, we focus on codimension 1 subvarieties
obtained in the following way. Let fˆ ∈ C[M ] be a non-zero Laurent polynomial. This defines
a hypersurface VT (fˆ) in the torus T ≃ (C∗ )n . Its closure in X ⊃ T is denoted VT (fˆ) ⊂ X.
We are interested in finding the defining equation of VT (fˆ) ⊂ X. More precisely, we will
determine a homogeneous polynomial f ∈ S such that VT (fˆ) = VX (f ), see (6.9). The
construction mirrors the usual homogenization when X = Pn .
±1
∗ 2
Example 6.20. Let M = Z2 , C[M ] = C[t±1
1 , t2 ], T = (C ) and consider

fˆ = a0 + a1 t1 + a2 t2 + a3 t1 t2 + a4 t21 + a5 t22

∈ C[M ].

(6.11)

The coefficients ai are complex numbers, not all equal to zero. This defines a curve VT (fˆ) ⊂
T . Its closure in P2 ⊃ T is the zero locus VP2 (f ) of the homogeneous polynomial
f = a0 x23 + a1 x1 x3 + a2 x2 x3 + a3 x1 x2 + a4 x21 + a5 x22
72

∈ S2 .

Here S2 = S[2D3 ] , see Example 6.16. Homogenization is passing from fˆ to f .
Consider the affine open covering P2 = Uσ1 ∪ Uσ2 ∪ Uσ3 from Example 4.11. The affine
variety VP2 (f ) ∩ Uσ3 ⊂ Uσ3 is obtained via de-homogenization:
f
fˆ3 = 2 = a0 + a1
x3



x1
x3




+ a2

x2
x3




+ a3

x1
x3



x2
x3




+ a4

x1
x3

2


+ a5

x2
x3

2
.

The polynomial fˆ3 is to be interpreted as an element of C[Uσ3 ] = C[t1 , t2 ] where t1 =
x1 /x3 , t2 = x2 /x3 , and VP2 (f ) ∩ Uσ3 = VUσ3 (fˆ3 ). Repeating this for the chart Uσ1 , we define
f
fˆ1 = 2 = a0
x1



x3
x1

2


+ a1

x3
x1




+ a2

x2
x1



x3
x1




+ a3

x2
x1




+ a4 + a5

x2
x1

2
,

−1
−1
−1
which is an element of C[Uσ1 ] = C[t−1
1 , t1 t2 ], as t1 = x3 /x1 , t1 t2 = x2 /x1 . The dehomoge−1
nization fˆ2 is interpreted analogously as an element of C[Uσ2 ] = C[t1 t−1
2 , t2 ]. An important
observation is that, when restricted to Uσ1 ∩σ3 = Uσ1 ∩ Uσ3 , we have the equality

1
fˆ1 |Uσ1 ∩σ3 = 2 fˆ3 |Uσ1 ∩σ3 .
t1

(6.12)

Here dividing by t21 makes sense because C[Uσ1 ∩σ3 ] = C[Uσ3 ]t1 . This means that, although fˆ1
and fˆ3 do not glue to a function on Uσ1 ∪ Uσ3 (note the factor t−2
1 ), they do agree on where
they vanish in the overlap Uσ1 ∩ Uσ3 . Indeed, Equation (6.12) shows that for p ∈ Uσ1 ∩ Uσ3 ,
fˆ1 (p) = 0 if and only if fˆ3 (p) = 0. This means that the set
VP2 (fˆ) = { p ∈ P2 | fˆi (p) = 0 for any i such that p ∈ Uσi }
is well-defined. Moreover, it is not hard to check that VP2 (fˆ) = VP2 (f ) = VT (fˆ). For the
reader familiar with vector bundles, we point out that this describes VT (fˆ) as the zero locus
of a global section of a line bundle. Locally, the section is given by fˆi : Uσi → C, and the
transition functions are Laurent monomials, such as t−2

1 in (6.12).
We generalize Example 6.20 to the following setting.
±1
C[t1 , . . . , t±1
n ] be a Laurent polynomial, given by
X
fˆ =
cm tm , cm ∈ C∗ .

Let fˆ ∈ C[M ] = C[Zn ] =

m∈A

Its Newton polytope P is defined as the convex hull of A . That is, P = Conv(A ) ⊂ Rn .
We assume P to be full-dimensional. We consider the toric variety XP associated to P , and
determine VT (fˆ), where the closure is in XP ⊃ T . Moreover, we determine a homogeneous
element f ∈ S in the Cox ring S of XP such that VT (fˆ) = VXP (f ).
Choose ` ∈ Z>0 such that ` · P is very ample, see Definition 3.34. For each vertex
v ∈ P ∩ M , define the affine semigroup Sv = N · {(` · P ∩ M ) − `v} and fˆv = t−v · fˆ ∈ C[Sv ].

73

Exercise 6.21. Show that Sv is saturated in M and C[Sv ] = C[Uσv ], where σv ∈ ΣP is the
cone in the normal fan ΣP corresponding to v. Check that fˆv ∈ C[Sv ], and that fˆi , i = 1, 2, 3
from Example 6.20 correspond to the vertices v of the Newton polytope of (6.11).
Let v, v 0 ∈ P ∩ M be two vertices of P and let τ = σv ∩ σv0 be the intersection of the
corresponding cones in the normal fan of P . Restricting fv and fv0 to Uτ , we find that
0
(fˆv0 )|Uτ = tv−v · (fˆv )|Uτ ,

fˆv0 (p) = 0 ⇐⇒ fˆv (p) = 0 for p ∈ Uτ .

so that

0

Dividing by tv −v is justified by C[Uτ ] = C[Uσv ]tv0 −v , see Proposition 3.47. We set
VXP (fˆ) = { p ∈ XP | fv (p) = 0 for some v such that p ∈ Uσv }.
Proposition 6.22. With the notation introduced above, we have VXP (fˆ) = VT (fˆ).
Proof. The set VXP (fˆ) is closed in XP . Its intersection with Uσv is VUσv (fˆv ). The statement
follows from the fact that VUσv (fˆv ) is the closure of VT (fˆ) in Uσ . To see this, let m ∈ M be
a lattice point in the interior of σv∨ . We have C[M ] = C[Uσv ]tm , and hfˆv i ⊂ C[Uσv ] is the
contraction of hfˆi ⊂ C[M ] in C[Uσv ] (i.e., the largest ideal that localizes to hfˆi).
Now comes homogenization. Our task is to find f ∈ Sα for some α ∈ Cl(XP ) such that
VXP (f ) = VXP (fˆ). We
Pfirst determine α. Recall that the torus invariant divisor on XP associated to P is DP = ρ∈ΣP (1) aρ Dρ , where aρ comes from the minimal facet representation
P = {m ∈ Rn | huρ , mi + aρ ≥ 0} = {m ∈ Rn | F > m + a ≥ 0}.
Here F ∈ Zn×k is an integer matrix with the primitive ray generators uρ for its columns.
This was described in Example 5.30. We have also seen that
M
Γ(XP , OXP (DP )) =
C · tm ,
m∈P ∩M

so that fˆ ∈ Γ(XP , OXP (DP )). The sum in this description of the global sections of OXP (DP )
is similar to the sum in (6.7), where we defined the graded pieces of S. In particular, for
α = [DP ] ∈ Cl(XP ) we have
M
>
Sα =
C · xF m+a .
m∈P ∩M
>

The natural linear map Γ(XP , OXP (DP )) → Sα given by tm 7→ xF m+a is homogenization.
P
>
In particular, the image of our Laurent polynomial fˆ is f = m∈A cm xF m+a ∈ Sα .
Exercise 6.23. Check that homogenization is invariant under translations of P . That is,
the homogenization of fˆ is equal to that of tm · fˆ, for any Laurent monomial tm .
One can define homogenization for torus invariant divisors on a normal toric variety XΣ .

74

Definition 6.24 (Homogenization). Let XΣ be a normal toric variety with no torus factor
and let D ∈ DivT (XΣ ) be a torus invariant divisor. Homogenization with respect to D is
ηD : Γ(XΣ , OXΣ (D)) −→ S[D] ,

>

tm 7−→ xF m+a .

In the rest of this section, we keep using the homogenization f = ηDP (fˆ). It remains
to show that VXP (f ) = VXP (fˆ). We will check this locally, on the affine charts Uσv , where
v ∈ P ∩ M is a vertex. Let xσ̂v be as in (6.2). By the orbit-cone correspondence (Theorem
4.24), the toric variety Ck \ V (xσ̂v ) ⊂ Ck \ Z corresponds to the fan Σ0v consisting of the
cone Cone(ei | ρi ∈ σv (1)) and all its faces. The map F : Rk → Rn is compatible with Σ0v
and the fan of Uσv . The corresponding toric morphism is the restriction πσv = π|Ck \V (xσ̂v ) :
Ck \ V (xσ̂v ) → Uσv . At the level of C-algebras, this map is
πσ∗v : C[Uσv ] −→ Sxσ̂v ,

>

tm 7→ xF m .
>

Here m ∈ Sv ensures that only the variables of xσ̂v appear in the denominator of xF m .
Proposition 6.25. With the notation introduced above, we have VXP (f ) = VXP (fˆ) = VT (fˆ).
Proof. We have VXP (fˆ) ∩ Uσv = VUσv (fˆv ). The pullback of fˆv under πσv is
!
X
X
f
>
πσ∗v (fˆv ) = πσ∗v
cm tm−v =
cm xF (m−v) = F > v+a .
x
m∈A
m∈A

(6.13)

>
This means that, when π(x) ∈ Uσv , fˆv (π(x)) = f (x)/xF v+a . If p ∈ VXP (f ), then there is
x ∈ π −1 (p) such that f (x) = 0. Let v be any vertex of P such that such that p ∈ Uσv . By
Lemma 4.41, π −1 (Uσv ) = Ck \V (xσ̂v ), so that xi 6= 0 for all i such that ρi ∈
/ σ(1). This means
F > v+a
ˆ
ˆ
that we have x
6= 0, and hence fv (π(x)) = fv (p) = 0 by (6.13), so that p ∈ VXP (fˆ).
This shows VXP (f ) ⊂ VXP (fˆ). The proof of the reverse inclusion is analogous.

±1
Example 6.26. Let fˆ = 1 + t1 + t2 + t1 t2 + t21 t2 + t31 t2 ∈ C[t±1
1 , t2 ]. The toric variety XP
is the Hirzebruch surface from Example 6.17. In the notation used there, fˆ homogenizes to

f = x3 x4 + x1 x4 + x2 x33 + x1 x2 x23 + x21 x2 x3 + x31 x2 .
Its degree is [D3 + D4 ] ∈ Cl(H2 ).

6.4



Complete intersections on toric varieties

±1
Let M = Zn and let fˆ1 , . . . , fˆn ∈ C[M ] = C[t±1
1 , . . . , tn ] be Laurent polynomials. In this
section, we consider the system of equations

fˆ1 = · · · = fˆn = 0

75

(6.14)

with solutions VT (fˆ1 , . . . , fˆn ) = {p ∈ T | fˆi (p) = 0, i = 1, . . . , n}. Under suitable assumptions, VT (fˆ1 , . . . , fˆn ) consists of finitely many points. We let Ai ⊂ Zn be such that
X
fˆi =
ci,m tm , i = 1, . . . , n.
(6.15)
m∈Ai

We are particularly interested in the number δ of solutions to (6.14), when the exponents
Ai are fixed. Bézouts theorem gives a full answer when Ai = (di · ∆n ) ∩ Zn is a dilate of the
standard simplex. The case A1 = · · · = An was dealt with in Section 3.4: it is covered by
Kushnirenko’s theorem. Both results rely on the fact that if the question is reformulated over
a different, compact solution space X ⊃ T , the number δ is the same for all systems with
finitely many solutions (if we count multiplicities). Indeed, in Bézout’s theorem X = Pn ,
and in Section 3.4, X is the projective toric variety XA . Having a compact solution space is
desirable, for instance, to apply results from intersection theory. Here, we will discuss what
X is for (6.14) where the Ai are arbitrary. We will also state the Bernstein-KhovanskiiKushnirenko (BKK) theorem, which generalizes Bézout and Kushnirenko to this setting.
Defining X involves the binary operation of Minkowski addition on polytopes.
Definition 6.27 (Minkowski sum). Let P and Q be polytopes in MR . The Minkowski sum
of P and Q is
P + Q = {p + q | p ∈ P, q ∈ Q} ⊂ MR .
One easily checks commutativity and associativity. Minkowski sums appear in the definition of an important integer associated to a tuple of n lattice polytopes.
Definition 6.28 (Mixed volume). Let P1 , . . . , Pn be polytopes in Rn . The function
(λ1 , . . . , λn ) 7→ Vol(λ1 · P1 + · · · + λn · Pn ) is a homogeneous polynomial function of degree n on Rn≥0 , see [10, Ch. 7, Sec. 4, Prop. 4.9]. Its coefficient standing with the mixed
monomial λ1 λ2 · · · λn is an integer, called the mixed volume MV(P1 , . . . , Pn ).
A useful formula for the mixed volume in the case where n = 2 is
MV(P1 , P2 ) = Vol(P1 + P2 ) − Vol(P1 ) − Vol(P2 ).

(6.16)

Let Pi = Conv(Ai ) ⊂ Rn and P = P1 + · · · + Pn . We assume that P is full-dimensional.
Our space of solutions X is the toric variety XP , with Cox ring S. To each fˆi we will
associate a divisor Ei ∈ DivT (XP ) and a homogeneous element fi = ηEi (fˆi ) ∈ S[Ei ] such that
VXP (fi ) = VT (fˆi ). Here the closure is in XP , ηEi is the homogenization map from Definition
6.24 and VXP (fi ) is as in (6.9). The BKK theorem counts the number δ of points in
VXP (f1 , . . . , fn ) = VXP (f1 ) ∩ · · · ∩ VXP (fn ).
If δ is finite, we say that fˆ1 , . . . , fˆn define a complete intersection on XP .
Before stating the theorem, we define the divisors Ei . When P and Pi have the same
normal fan, it is natural to set Ei = DPi . In general Pi is only a Minkowski summand of P .

76

P1

+

P2

=

P

Figure 27: Polytopes from Example 6.31.
This entails that the normal fan of P refines that of Pi , see e.g. Proposition 6.2.5 in [12].
Let F ∈ Zn×k = [u1 · · · uk ] be the matrix of primitive ray generators of ΣP (1). We have
Pi = {m ∈ Rn | F > m + ai ≥ 0},
where ai = (ai,1 , . . . , ai,k ) with ai,j = − minm∈Ai huj , mi. We point out that this is in general
P
not a minimal facet representation. We set Ei = kj=1 ai,j Dj .
Theorem 6.29 (Toric BKK theorem). Let fˆ1 , . . . , fˆn ∈ C[M ] be as in (6.15) and let XP be
the toric variety of the polytope P = P1 + · · · + Pn , where Pi = Conv(Ai ). If VXP (f1 , . . . , fn )
consists of δ < ∞ points on XP , counting multiplicities, then δ is given by MV(P1 , . . . , Pn ).
For generic choices of the coefficients ci,m , the number of solutions in the torus TXP ≃ TN =
(C∗ )n is exactly equal to MV(P1 , . . . , Pn ) and all solutions have multiplicity one.
Proof. See [16, Sec. 5.5]. For the final statement, see [4] for the original proof, [18] for a
proof based on homotopy continuation, and [10, Ch. 7, Sec. 5] for a sketch.
Example 6.30. When P1 = · · · = Pn = P , we have MV(P, . . . , P ) = n! Vol(P ), so that
Theorem 6.29 implies Theorem 3.16. When Pi = di · ∆n is the di -dilation of the standard
simplex, the mixed volume MV(P1 , . . . , Pn ) evaluates to the Bézout number d1 · · · dn .

Example 6.31. Consider the system of Laurent polynomial equations fˆ1 = fˆ2 = 0 given by
fˆ1 = 1 + t1 + t2 + t1 t2 + t21 t2 + t31 t2 ,
fˆ2 = 1 + t2 + t1 t2 + t2 t2 .
1

±1
These are elements of C[M ] = C[t±1
1 , t2 ] and give the polygons P1 , P2 , P shown in Figure
27. The toric variety XP is the Hirzebruch surface H2 from Example 6.17. Note that
XP2 6= XP1 = XP , since P2 has a different normal fan. However, P2 is a Minkowski summand
of P , so it can be written as P = {m ∈ R2 | F > m + a2 ≥ 0}. Here F is from Example 6.17,
and a2 = (0, 0, 0, 1)> gives E2 = D4 . We established in Example 6.26 that E1 = D3 + D4
(note that fˆ = fˆ1 ). The system has only one solution in the torus, namely (t1 , t2 ) = (−1, −1).
We encourage the reader to check this. However, the formula (6.16) gives MV(P1 , P2 ) = 3.
We will show that VXP (fˆ1 , fˆ2 ) consists of 3 points. Homogenization gives

f1 = x3 x4 + x1 x4 + x2 x33 + x1 x2 x23 + x21 x2 x3 + x31 x2 ∈ S[D3 +D4 ] ,
f2 = x4 + x2 x23 + x1 x2 x3 + x21 x3 ∈ S[D4 ] .
77

We now see that the vanishing locus VXP (f1 , f2 ) on XP consists of three points π(zi ), i =
1, . . . , 3, with homogeneous coordinates
z1 = (−1, −1, 1, 1), z2 = (0, −1, 1, 1), z3 = (1, −1, 0, 1).
Note that π(z1 ) is the toric solution (−1, −1) and the other solutions are on the boundary
of the torus: π(z2 ) ∈ D1 , π(z3 ) ∈ D3 .

The original BKK theorem considers solutions in T = (C∗ )n . It has inspired efficient
symbolic-numeric methods for solving polynomial equations, such as polyhedral homotopies
[18] and sparse resultants [6, 15]. The toric interpretation of the BKK theorem given in
Theorem 6.29 is important for designing stable numerical algorithms [3, 13, 29].

References
[1] M. Audin. The topology of torus actions on symplectic manifolds, volume 93. Birkhäuser,
2012.
[2] V. V. Batyrev. Dual polyhedra and mirror symmetry for Calabi–Yau hypersurfaces in toric
varieties. J. Alg. Geom, pages 493–535, 1994.
[3] M. R. Bender and S. Telen. Toric eigenvalue methods for solving sparse polynomial systems.
arXiv preprint arXiv:2006.10654, 2020.
[4] D. N. Bernstein. The number of roots of a system of equations. Functional Analysis and its
applications, 9(3):183–185, 1975.
[5] P. Breiding and S. Timme. HomotopyContinuation. jl: A package for homotopy continuation
in Julia. In International Congress on Mathematical Software, pages 458–465. Springer, 2018.
[6] J. F. Canny and I. Z. Emiris. A subdivision-based algorithm for the sparse resultant. Journal
of the ACM (JACM), 47(3):417–451, 2000.
[7] D. A. Cox. The homogeneous coordinate ring of a toric variety. Journal of Algebraic Geometry,
4:17–50, 1995.
[8] D. A. Cox. What is a toric variety? In Contemporary Mathematics. Citeseer, 2003.
[9] D. A. Cox. Applications of polynomial systems, volume 134. American Mathematical Soc.,
2020.
[10] D. A. Cox, J. B. Little, and D. O’Shea. Using algebraic geometry, volume 185 of Graduate
Texts in Mathematics. Springer Science & Business Media, 2006.
[11] D. A. Cox, J. B. Little, and D. O’Shea. Ideals, varieties, and algorithms: an introduction
to computational algebraic geometry and commutative algebra. Springer Science & Business
Media, corrected fourth edition edition, 2018.
[12] D. A. Cox, J. B. Little, and H. K. Schenck. Toric varieties. American Mathematical Soc.,
2011.

78

[13] T. Duff, S. Telen, E. Walker, and T. Yahl. Polyhedral homotopies in Cox coordinates. arXiv
preprint arXiv:2012.04255, 2020.
[14] E. Ehrhart. Sur un problème de géométrie diophantienne linéaire ii. Journal für die reine und
angewandte Mathematik, 227:25–49, 1967.
[15] I. Z. Emiris and B. Mourrain. Matrices in elimination theory. Journal of Symbolic Computation,
28(1-2):3–44, 1999.
[16] W. Fulton. Introduction to toric varieties. Number 131. Princeton University Press, 1993.
[17] E. Gawrilow and M. Joswig. Polymake: a framework for analyzing convex polytopes. In
Polytopes—combinatorics and computation, pages 43–73. Springer, 2000.
[18] B. Huber and B. Sturmfels. A polyhedral method for solving sparse polynomial systems.
Mathematics of computation, 64(212):1541–1555, 1995.
[19] J. E. Humphreys. Linear algebraic groups, volume 21. Springer Science & Business Media,
2012.
[20] A. G. Kushnirenko. Polyèdres de Newton et nombres de Milnor. Inventiones mathematicae,
32(1):1–31, 1976.
[21] D. Maclagan and B. Sturmfels. Introduction to tropical geometry. Graduate Studies in Mathematics, 161:75–91, 2009.
[22] M. Michalek. Selected topics on toric varieties. In The 50th anniversary of Gröbner bases,
pages 207–252. Mathematical Society of Japan, 2018.
[23] M. Michalek and B. Sturmfels. Invitation to nonlinear algebra, volume 211. American Mathematical Soc., 2021.
[24] Oscar – open source computer algebra research system, version 0.8.1, 2022.
[25] A. Postnikov. Permutohedra, associahedra, and beyond. International Mathematics Research
Notices, 2009(6):1026–1106, 2009.
[26] F. Sottile. Ibadan lectures on toric varieties. arXiv preprint arXiv:1708.01842, 2017.
[27] B. Sturmfels. Gröbner bases and convex polytopes, volume 8. American Mathematical Soc.,
1996.
[28] B. Sturmfels, S. Telen, F.-X. Vialard, and M. von Renesse. Toric geometry of entropic regularization. arXiv preprint arXiv:2202.01571, 2022.
[29] S. Telen. Numerical root finding via Cox rings. Journal of Pure and Applied Algebra, 224(9),
2020.
[30] S. Telen. Solving systems of polynomial equations (doctoral dissertation, KU Leuven, Leuven,
Belgium). available at https: // simontelen. webnode. com/ publications/ , 2020.

Author’s address:
Simon Telen, MPI-MiS Leipzig

simon.telen@mis.mpg.de
79

